%
% This is file `elsarticle-template-num.tex',
% generated with the docstrip utility.
%
% The original source files were:
%
% elsarticle.dtx  (with options: `numtemplate')
% 
% Copyright 2007, 2008 Elsevier Ltd.
% 
% This file is part of the 'Elsarticle Bundle'.
% -------------------------------------------
% 
% It may be distributed under the conditions of the LaTeX Project Public
% License, either version 1.2 of this license or (at your option) any
% later version.  The latest version of this license is in
%    http://www.latex-project.org/lppl.txt
% and version 1.2 or later is part of all distributions of LaTeX
% version 1999/12/01 or later.
% 
% The list of all files belonging to the 'Elsarticle Bundle' is
% given in the file `manifest.txt'.

\documentclass[preprint,10pt]{elsarticle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{inputs/def.tex}
\input{inputs/packages.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   BEGIN DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%\title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}
%-------------------------
%-------------------------
\title{Viscous regularization of the seven-equation two-phase flow model with numerical applications.\\
\tcr{An artificial viscosity technique for the compressible seven-equation model.}\\
}
%-------------------------
%-------------------------
\author{Marc O. Delchini\fnref{label1} \tcr{is that email correct for you?} \tcb{done}}
\ead{delchinimg@ornl.gov}

\author{Jean C. Ragusa\corref{cor1}\fnref{label1}}
\ead{jean.ragusa@tamu.edu}

\author{Ray A. Berry\fnref{label2}}
\ead{ray.berry@inl.gov}

\address[label1]{Department of Nuclear Engineering, Texas A\&M University, College Station, TX 77843, USA \fnref{label1}}

\address[label2]{Idaho National Laboratory, Idaho Falls, ID 83415, USA \fnref{label2}}

\cortext[cor1]{Corresponding author}
%-------------------------
%-------------------------
%-------------------------
\begin{abstract}
We extend the Entropy Viscosity Method, a viscous regularization technique for hyperbolic 
conservation laws, to the compressible Seven-Equation two-phase flow Model with variable area. Using a viscous regularization derived in \cite{Marco_paper_sem} \tcb{We should have the full paper not only the reference number in the abstract} and a low-Mach asymptotic study, expressions for the entropy viscosity coefficients are derived that are valid for a wide range of Mach numbers, from subsonic flows (with very low Mach numbers) to 
supersonic flows and allow to solve for variable area flow problems as well.
%
The effectiveness of the method is demonstrated with a first set of 1-D benchmark tests obtained with an in-house Moose-based applications: volume fraction shock tube, various independent and fully coupled two-phase flow shock tubes and two-phase flow in a converging-diverging nozzle. Convergence rates of the $L_1$ and $L_2$ norms are computed to demonstrate convergence of the numerical solution to the exact solution when available. A second set of $1$-D test was also obtained with the nuclear reactor analysis system code RELAP-7 including hydrostatic pressure, water-hammer and Boiling-Water Reactor (BWR).
\end{abstract}
%-------------------------
%-------------------------
\begin{keyword}
        compressible two-phase flow model \sep 
	seven-equation model \sep
	artificial viscosity method \sep 
	entropy-based viscosity stabilization\sep 
	low-Mach regime \sep 
	shock-capturing scheme
\end{keyword}
%-------------------------
\end{frontmatter}
\linenumbers

\tcr{make sure you hit return and go to the next line often enough. Word wrapping is nice and you think we do not need to hit 
return but when I look for differences on github, it is a pain to have very long lines. thanks.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{sec:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compressible two-phase fluid flows are found in numerous natural, scientific, and industrial applications (astrophysical plasmas, 
combustion devices, heat transfer for boilers --including coolant flow in nuclear reactors, etc.). 
% Their numerical solution is an ongoing area of research in modeling and simulation. 
A variety of two-phase flow models, with different levels of mechanical and thermodynamical non-equilibrium, exists. 
Traditionally, a six-equation model with equal pressure between the two phases is employed to describe the conservation of mass, 
momentum, and energy for two phases \cite{Stadtke}; this model is typically obtained by an averaging process (be it in time, space,
or statistical \cite{BruceStewart1984363}). However, it is well-known that the six-equation model 
suffers from some mathematical difficulty in the sense that the system of partial differential equations is ill-posed in the sense of Hadamard 
(the Jacobian matrix of linearized equations presents a pair of complex eigenvalues). 
Other multiphase flow models that are unconditionally hyperbolic have been derived alike the five- and seven-equation models; see, for instance, Stewart and Wendroff \cite{BruceStewart1984363}, 
Baer and Nunziato \cite{BaerNunziato}, Kapila \cite{Kapila_2001,Berry_NED2010}, Berry et al. \cite{Berry_1985}, Saurel et al. \cite{Saurel_2001a,Saurel_2001b}, 
among others. Hyperbolicity is a highly desirable property to devise robust numerical solvers and to treat a wide range of flow conditions.
These hyperbolic models employ an additional partial differential equation for the volume fraction, allowing for the rate at 
which pressure equilibrium is reached.  They can be obtained by integrating the one-phase flow balance equations weighted by a characteristic 
or indicator function for each phase \cite{DrewPassman}. The resulting system of equations also contains non-conservative terms and relaxation terms that 
describe the interaction between phases. In this paper, we employ the full non-equilibrium Seven-Equation two-phase flow Model 
(SEM) that was obtained by applying the Discrete Equation Method (DEM) as described by Abgrall et al. in \cite{AbgrallandSaurel2003}. A version of the SEM with variable area was also derived in \cite{Berry_NED2010}.

The numerical approximation of these unconditionally hyperbolic models is an ongoing area of research.
In the SEM model, seven waves are present: two acoustic waves and one contact discontinuity per fluid and one volume fraction wave that propagates 
at an interfacial speed. This generates intricate wave patterns and leads to complex flux computations, ruling out the use of a Riemann solver. 
An alternative is to use an approximate Riemann solver, a well-established approach for single-phase flows, while deriving a consistent discretization 
scheme for the non-conservative terms \cite{Li_2004,Abgrall_2002}. 
% approximation for the treatment of the non-conservative terms can lead to failure in computing the numerical solution \cite{Abgrall_2002}.
\tcr{I do not know what to think about this sentence. Abgrall2002 is not even cited in that paper from Berry, so I am lost a bit. I thought the NED2010 paper
was about DEM applied to SEM. DEM is not mentioned anywhere but I think it must be discussed)} 
% 
%Because each phase in the SEM model obeys a single-phase Euler equation, various numerical techniques employed so far to discretize the SEM equations have been 
%based on spatially discontinuous schemes. 
Because each phase is assumed to obey the Euler equations, most of the numerical solvers are adapted from the single-phase approximate Riemann solvers. For example, Saurel et al. \cite{Saurel_2001a, Saurel_2001b} employed a HLL-type scheme to solve for the SEM but noted that excessive dissipation was added in the contact discontinuity. A more advanced HLLC-type scheme was developed in \cite{Li_2004} but only for the subsonic case; this was later extended to supersonic flows in \cite{Zein_2010}. More recently, Ambroso et al. \cite{Ambroso_2012} proposed an approximate Riemann solver accounting for source terms such as gravity and drag forces, but with no mass transfer \tcr{between phases}. \tcr{(second option is better. check if this is what you meant, and not interfacial)} (\tcr{also, the last sentence implies that the previous work Saurel2001, Li2004, Zein2010, discretized the SEM with no source term and
no mass transfer. whichever it is, we should find a way of adding the relevant information for clarity. Finally, would this be a better place to talk about DEM, that is, after the approximate Riemann solvers?}). 
Berry et al. in \cite{Berry_NED2010} employed HLLC-type schemes to solve for the Seven-Equation Model (SEM) with variable area but did not discuss the low-Mach asymptotic limit aspect.


In this paper, we propose an alternative to approximate Riemann solvers in order to derive a robust discretization for the SEM. Our approach is 
based on the well-known notion of artificial viscosity.  
When adding viscosity in the vicinity of a shockwave, one replaces the physical effect of the entropy production in the shockwave with the equivalent entropy increase of a viscous layer (transformation of kinetic energy into internal energy).  
If the viscosity is not large enough, the resulting entropy production will not be equivalent to that of the true shock and a numerical scheme 
may create a train of oscillations in the solution, radiating away from the shock/viscous layer, and whose gradients will indeed attempt to produce 
an entropy production equivalent to that of the shock jump (i.e., fluctuating kinetic energy in place of fluctuating molecular energy). 
On the other hand, too much viscosity will dilute and smooth out the shock region. \tcr{I had to delete a lot of the text you copy-pasted from the other article;
we cannot just have the same text. Even if the reviewers are different, once published, we look like lazy fools!} \tcb{ok}
 % One needs to properly set the viscosity coefficient along with the jump conditions for the 
% given mesh size in order to produce a monotonic solution increase through the viscous layer with as little smearing as possible, but with entropy production 
% matching that of the true shock.
%It is well established that, even with smooth initial data, the existence of a globally smooth solution may not occur for hyperbolic systems.
%To guarantee the existence of a global solution, the concept of weak solution is then introduced. However, the uniqueness of the solution is lost 
%because the problem may allow infinitely many weak solutions and an additional condition, the``entropy condition,'' 
%is usually imposed to select a unique solution, the ``entropy solution.'' 
%
%
%The minimum entropy principle states that the entropy of a fluid parcel is constant 
%along its pathline and only increases upon crossing a shock wave, viscous layer, or thermal conduction region.  Numerically computing 
%shockwave solutions without proper stabilization leads to non physical spurious oscillations. 
%Tadmor \cite{tadmor_minimum_entropy_principle} gives an alternative statement (more useful for constructing numerical methods and proofs) of the minimum 
%entropy principle by transforming the Lagrangian statement above into that of an Eulerian reference frame. Further discussion may be found in Guermond and Popov \cite{GuermondSIAM2014}.
%Although there are several different ways of defining the entropy condition, it is generally hoped that they are all equivalent in the sense 
%that they select the same entropy solution (this can be demonstrated for Burgers equations, see \cite{Evans1998,Lellis_minimalentropy}).
%For numerical schemes, the entropy condition and solution are sought through the utilization of so-called conservative formulations of the 
%governing laws, along with the addition of an appropriately specified physical or artificial viscosity, either added directly to the governing 
%equations or implied by the discretization employed (truncation error).  That is, a regularization is selected, or built, which is consistent with the 
%entropy condition, thereby guaranteeing that the numerical computation captures the physically relevant solution.  %
Employing an artificial viscosity requires the addition of viscous fluxes in the governing laws; this can be achieved, for example, by analogy with 
the viscous terms in Navier-Stokes equations \cite{Pasquetti_NS2006, GuermondJCP2011} or by employing a parabolic regularization \cite{PertheneNumMath1996-parabolic}. 
However, these approaches are far from optimal:
the Navier-Stokes regularization was shown to violate the minimum-entropy principle while the parabolic regularization is a special case of a more general
minimum-entropy-satisfying viscous regularization \cite{GuermondSIAM2014}; furthermore, Delchini et al. \cite{DelchiniCompFluid2014-euler} 
showed, in the case of single-phase flows, that a parabolic regularization was not appropriate for an all-speed solver (i.e., across a wide range of Mach numbers).
%
Following the single-phase work by Guermond et al. 
\cite{GuermondSIAM2014, GuermondCSE2011,  GuermondJCP2011, GuermondCRA2008, GuermondSIAM2014}, 
Delchini et al. \cite{Marco_paper_sem} recently proposed a viscous regularization for the Seven-Equation Model that is consistent with the minimum entropy principle and Harten's generalized entropies. In their numerical application, the viscosity coefficients were chosen proportional to the local maximum eigenvalues (akin to a local Lax-Friedrichs, LLF, scheme), which is well-known to be over-dissipative and first-order in space. In addition, the LLF viscosity coefficients are known to
lead to ill-scaled viscous terms in the low-Mach regime and an ad-hoc low-Mach fix had to be employed to obtain the correct solution for low-Mach flows (this 
behavior is well documented in the literature; see \cite{LowMach1, LowMach2, LowMach3}). By means of a low-Mach asymptotic analysis, the correct
viscosity scaling for the seven-equation two-phase flows for all speeds were derived in \cite{Marco_paper_sem}.

Here, we present an all-Mach flow numerical method for the non-equilibrium seven-equation two-phase flow model where we derive and define high-order viscosity coefficients that will enable shock capture (without the excessive dissipation of the LLF viscosity) while ensuring a correct low-Mach asymptotic limit. The 
proposed definitions of the viscosity coefficients are based on the local entropy production as developed previously in the entropy viscosity Method for
single-phase flows \cite{GuermondSIAM2014, GuermondCSE2011}. 
The method relies on two key ingredients: 
\ben
\item  an adequate viscous regularization that ensures that the entropy production remains positive, thus that the minimum entropy principle holds 
(see \cite{tadmor_minimum_entropy_principle} for additional discussions regarding the minimum entropy principle, \cite{GuermondSIAM2014}
for such a viscous regularization for single-phase flows, and \cite{Marco_paper_sem} for the two-phase flow version applicable to the SEM)
\item a definition of viscosity coefficients that is well-behaved over a wide range of Mach numbers and does not excessively dissipate sharp solution profiles. 
\een
This latter point is the crux of this paper.
%The theoretical foundation for this work can be traced back to viscous regularization for single-phase Euler and Navier-Stokes equations, notably \cite{GuermondSIAM2014} and the references therein. 
%
%Delchini et al. \cite{Marco_paper_sem} proposed a viscous regularization for the Seven-Equation Model that is consistent with the minimum entropy principle and Harten's generalized entropies and was shown to efficiently stabilize the numerical solution when defining the viscosity coefficients proportional to the local maximum eigenvalues as in the local Lax-Friedrichs (LLF) scheme. It was also shown that the numerical method would fail to yield the correct solution in the case of low-Mach flows: the numerical dissipative terms become 
%ill-scaled in the low-Mach regime and lead to the wrong numerical solution by changing the nature of the equations solved. This 
%behavior is well documented in the literature \cite{LowMach1, LowMach2, LowMach3, Marco_paper_sem}. Still in \cite{Marco_paper_sem}, conditions for yielding the correct asymptotic behavior were also proposed by mean of a low-mach asymptotic study. We now propose to define high-order viscosity coefficients for the SEM that will allow to solve for shocks but also ensure the correct low-Mach asymptotic limit, on the same model of what was previously achieved for the single-phase Euler equations \cite{DelchiniCompFluid2014-euler}.
%
%
The remainder of the paper is as follows. In \sct{sec:7-equ-model}, the Seven-Equation two-phase flow Model (SEM) is recalled along with its main 
physical and mathematical properties, and the viscous regularization derived in \cite{Marco_paper_sem}. Then, all-Mach flow viscosity coefficients are derived 
in \sct{sec:visc-def} by following the same methodology as in \cite{DelchiniCompFluid2014-euler} which is the novelty presented in this paper. In \sct{sec:disc}, the temporal and spatial discretization methods are presented. 
Our theoretical approach is first illustrated in \sct{sec:results} with one-dimensional numerical results obtained with a Moose-based in-house code. The technique has also been implemented in the nuclear 
reactor safety system code RELAP-7 \cite{Berry_2014} and some of the numerical illustrations were generated with it.
Finally, we conclude in \sct{sec:conclusion}.
%

%\tcr{\\ again, I would like to keep this mini introduction very short. Some of the info here is good but should it go here?\\
 %The viscous regularization was derived in \cite{Marco_paper_sem} by 
%using an entropy condition called ``the minimum entropy principle'' which ensures both uniqueness of the numerical solution and convergence to the physical solution. This section 
%ends with the derivation of the phasic viscosity coefficients based on the study of the non-dimensional form of the regularized Seven-Equation two-phase flow Model that was 
%performed in \cite{Marco_paper_sem}.\\}
%\tcr{\\here you have important info: closure relations used to compute the relaxation terms and interfacial variables (REF). I am not sure this goes in this small introduction. Here, we should just advertize the two upcoming subsections. However, that information should be written somewhere, either in the introduction if appropriate or in the subsection about the inviscid 7eq model\\}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Seven-Equation Two-Phase Flow Model with an All-Mach Flow Viscous Regularization}\label{sec:7-equ-model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
In this Section, we review the Seven-Equation two-phase flow Model \cite{Berry_NED2010} and recall the minimum-entropy-satisfying viscous 
regularization derived  in \cite{Marco_paper_sem}.  
First, the inviscid (i.e., unregularized) Seven-Equation Model (SEM) is provided, along with its closure relations and the necessary 
notational definitions. 
Then, the viscous regularization of the SEM derived in \cite{Marco_paper_sem} is recalled along with the definitions for the artificial dissipative fluxes. \tcb{I modified here}
In the remaining of the paper, each dependent variable is assumed to a function of both space and time, unless otherwise noted. 
These dependencies are implicit and omitted for conciseness. 
%
%----------------------------------------------------------------------------------------------------------------------------------
\subsection{The inviscid Seven-Equation two-phase flow Model}
%----------------------------------------------------------------------------------------------------------------------------------
%
The Seven-Equation two-phase flow Model employed in this paper is obtained by assuming that each phase satisfies the single-phase Euler 
equations (with phase-exchange terms) and by integrating the latter over a control volume after multiplication by a phasic characteristic 
function. The detailed derivation of the governing equations for a phase $k$ in interaction with a phase $j$ can be found in \cite{Berry_NED2010}. 
In the SEM, each phase obeys a mass, a momentum and an energy balance equation, supplemented by an equation for the volume fraction as shown in 
\eqt{eq:7-eqn} (the equations below are written for a phase $k$ in interaction with a phase $j$): \tcb{I modified here}
%
\begin{subequations}\label{eq:7-eqn}
\begin{align}
  % liquid mass conservation
  \label{multi-d-7-equ-mass}
  \frac{\partial \left( \alpha \rho \right)_{k} A}{\partial t}
  + \div \left[ (\alpha \rho \mbold u)_k A\right]
  &= 0 \,,
\end{align}
\begin{multline}
  % liquid momentum
  \frac{\partial \left( \alpha \rho \mbold u \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} A \left( \rho \mbold u \otimes \mbold u + P \mathbb{I} \right)_{k} \right]
  = P_{int} A \grad \alpha_{k} + P_{k} \alpha_{k} \grad A
  \\
  + A \lambda_u (\mbold u_{j} - \mbold u_{k}) \,,
\end{multline}
\begin{multline}
  % liquid total energy
  \frac{\partial \left( \alpha \rho E \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} \mbold u_{k} A \left( \rho E + P \right)_{k} \right]
  = P_{int} A \mbold u_{int} \cdot \grad \alpha_{k} - \bar{P}_{int} A \mu_P (P_{k} - P_{j})
  \\
  + A \lambda_u \bar{\mbold u}_{int} \cdot (\mbold u_{j} - \mbold u_{k}) \,,
\end{multline}
\begin{align}
  % liquid volume fraction
  \label{eqn:multi-d-7-eqn-vf}
  \frac{\partial \alpha_{k} A}{\partial t} + A\mbold u_{int} \cdot \grad \alpha_{k}
  &= A \mu_P (P_{k} - P_{j}) \,,
\end{align}
\end{subequations}
%
where $\alpha_k$, $\rho_k$, $\mbold u_k$ and $E_k$ denote the volume fraction, density,  velocity vector, and total specific 
energy of phase $k$, respectively. We adopt the standard convention for vectors: consider vector $\mbold{a}$ with entries $(a_i)_{i=1,\ldots,\texttt{dim}}$; $
(\mbold{a} \otimes \mbold{b})_{ij}=a_i b_j$;
$\div \mbold{a}= \partial_{x_j} a_j$; $(\grad \mbold{a})_{ij} = \partial_{x_i} a_j$; for order-2 tensors $\mathbb{g}$, 
we have $(\div \mathbb{g})_j = \partial_{x_i} g_{ij}$, $(\mathbb{g}\cdot \mbold{a})_i = g_{ij}a_j$, 
$\mathbb{g}:\mathbb{h} = g_{ij} h_{ij}$; summation is implied whenever an index is repeated. 
The phasic pressure $P_k$ is computed from an equation of state that is assumed given as a function of the density $\rho_k$ and 
the phasic specific internal energy $e_k = E_k - \tfrac{1}{2} u^2_k$. The cross section of the geometry is denoted by $A$ and is only 
spatially dependent. $A$ is included here for completeness of the presentation and is usually set to a constant value in most applications; however, 
nozzle flow problems can be solved using the one-dimensional version of the equations by letting $A$ be the cross-sectional area 
of the nozzle. 

Following \cite{Berry_NED2010}, the pressure and the velocity relaxation coefficients, $\mu_P$  and $\lambda_u$ respectively, are function of the acoustic 
impedance $Z_k = \rho_k c_k$ and the specific interfacial area $A_{int}$. The specific interfacial area (i.e., the interfacial surface area per unit
volume of a two-phase mixture), is typically dependent upon flow regime conditions and is usually provided as a correlation. For example,
in \cite{Berry_NED2010} the specific interfacial area, $A_{int}$, is chosen to be the same for the velocity and the pressure relaxation coefficients and its
expression is:
%
\begin{equation}\label{eq:Aint-def}
A_{int} = A_{int}^{max} \left[ \left(1-\alpha_{liq} \right)^2 \alpha_{liq} \right] \ .
\end{equation}
% 
$A_{int}^{max}$ is a constant referred to as the maximum special interfacial area ($A_{int}^{max}$ is set to $5100$ $m^2 / m^3$ in \cite{Berry_NED2010}). 
With such an expression, the interfacial area is zero in the single-phase flow limits $\alpha_{k} = 0$ and $\alpha_{k} = 1$.
In this paper for generality purpose, we assume that the maximum specific interfacial area can take different values between the velocity and the pressure relaxation 
coefficients as shown in \eqt{eq:relaxation_coeff}:
%
\begin{subequations}
\label{eq:relaxation_coeff}
\begin{align}
  \label{E-R:86}
  \mu_P = \frac{A_{int}^\mu}{Z_{k}+Z_{j}} 
  \text{ and }
%  \label{E-R:85}
  \lambda_u = \frac{A_{int}^\lambda}{2}  \frac{Z_{k} Z_{j}}{Z_{k}+Z_{j}} \, ,
\end{align}
\end{subequations}
%
where $A_{int}^i$ is assumed to be a function of the volume fraction $\alpha_i$. \tcb{Note that I changed it here. I think we do not have to be more specific than that}
%
%\begin{equation}\label{eq:Aint-sect4}
%A_{int}^i = A_{int}^{max,i} \left[ \left(1-\alpha_{k} \right)^2 \alpha_{k} \right] , \ i \in \{ \mu, \ \lambda \} \ .
%\end{equation}
%
Such a choice for the specific interfacial area remains consistent with the entropy inequality given in \eqt{eq:ent-eqn-7-eqn}: the entropy inequality holds 
as long as the relaxation coefficients $\mu_P$ and $\lambda_u$ remain positive. Thus, this also allows for more 
flexibility in the mechanical coupling between the two phases $k$ and $j$ and will be employed for some of the tests presented in \sct{sec:results}.

The interfacial pressure and velocity and their corresponding average values are denoted by $P_{int}$, $\mbold u_{int}$, 
$\bar{P}_{int}$ and $\bar{\mbold u}_{int}$, respectively; they are defined in \eqt{eq:int_variables_def}.
%
\begin{subequations}
\label{eq:int_variables_def}
\begin{align}
  \label{E-R:83}
  P_{int} &= \bar{P}_{int} + \frac{Z_{k}Z_{j}}{Z_{k}+Z_{j}} \frac{\grad \alpha_{k}}{|| \grad \alpha_{k} ||} \cdot (\mbold u_{j}-\mbold u_{k}) \,,
  \\
  \bar{P}_{int} &= \frac{Z_{j}P_{k}+Z_{k}P_{j}}{Z_{k}+Z_{j}} \,,
 \\
  \label{E-R:84}
  \mbold u_{int} &= \bar{\mbold u}_{int} +  \frac{\grad \alpha_{k}}{|| \grad \alpha_{k} ||} \frac{P_{j}-P_{k}}{Z_{k}+Z_{j}} \,,
  \\
  \bar{\mbold u}_{int} &= \frac{Z_{k} \mbold u_{k}+Z_{j}\mbold u_{j}}{Z_{k}+Z_{j}} \,.
\end{align}
\end{subequations}
%
Using the definitions of the interfacial variables given in \eqt{eq:int_variables_def} and assuming a smooth solution, i.e without shock or dicontinuity, an entropy equation can be 
derived for each phase $k$ of system \eqt{eq:7-eqn}. % and used to prove positivity of the entropy material derivative. 
The entropy function for a phase $k$ is denoted by $s_k$ and is a function of 
density $\rho_k$ and internal energy $e_k$. The full derivation is given in \cite{Marco_paper_sem} and only the final result is recalled here. 
The entropy of phase $k$ satisfies the following equation:
%
\begin{align} \label{eq:ent-eqn-7-eqn}
(s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} &= \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2 + \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j -\mbold  u_k)^2 
\nonumber
\\
& \| \grad \alpha_k \| \frac{Z_k}{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)+\frac{\grad \alpha_k}{\| \grad \alpha_k \|}(P_k-P_j)\right]^2 \ ,
\end{align}
%
where $\frac{D(\cdot) }{Dt} = \partial_t (\cdot) + \mbold u_k \cdot \grad (\cdot)$ is the material derivative.
The right-hand side of \eqt{eq:ent-eqn-7-eqn} is unconditionally positive since all terms are squared. Note that the sign of the right-hand side is independent of 
the definition of the 
relaxation coefficients $\mu_P$ and $\lambda_u$ as long as they are positive, but is dependent on the definitions of the interfacial variables given in \eqt{eq:int_variables_def}. In other words, all of 
theoretical results presented therein implicitly require the definitions of the interfacial variables to be consistent with the entropy inequality given in \eqt{eq:ent-eqn-7-eqn}. Furthermore, 
the partial derivative of $s_k$ with respect to the internal energy $e_k$, denoted by $(s_e)_k$ in the righthand-side of \eqt{eq:ent-eqn-7-eqn}, is shown to be equal to the inverse of the temperature 
of phase $k$, as in the case of the single phase Euler equations \cite{GuermondSIAM2014, DelchiniCompFluid2014-euler, Marco_dissertation}. 

For completeness, we also recall that the system of equations, 
\eqt{eq:7-eqn}, 
admits a set of $5+2\texttt{dim}$ waves (with \texttt{dim} the geometry's dimension): 
two acoustic waves per phase, one contact wave per phase per domain dimension, and one volume fraction wave propagating 
at the interfacial velocity $\mbold u_{int}$. These waves (eigenvalues of the Jacobian for the inviscid SEM with $\lambda_u = \mu_P=0$) are as follows for each phase $k$: \tcb{I modified here}
% 
\begin{align}\label{eq:eigenvalues}
&\lambda_{1,k} = \mbold u_k \cdot \bar{\mbold n} - c_k \nonumber\\
&\lambda_{2,k} = \mbold u_k \cdot \bar{\mbold n} + c_k \nonumber\\
&\lambda_{2+d,k} = \mbold u_k \cdot \bar{\mbold n} \text{ for } d = 1 \dots \texttt{dim} \\
&\lambda_{3+\texttt{dim}} = \mbold u_{int} \cdot \bar{\mbold n} \nonumber \,,
\end{align}
%
where $\bar{\mbold n}$ is an unit vector pointing to a given direction. 
The eigenvalues given in \eqt{eq:eigenvalues} are unconditionally 
real (as long as the equation of state yields a real-valued sound speed) but not necessarily distinct: the Seven-Equation Model admits 
a set of linearly independent eigenvectors under the \emph{non-resonance condition} $(u_k-u_{int})^2 \neq c_k^2$ for each phase $k$ 
(see proposition 2.1 in \cite{coquel_herard}), thus ensuring hyperbolicity of the model. \tcb{I modified this part of the text}

The set of equations satisfied by phase $j$ are simply obtained by substituting $k$ by $j$ and $j$ by $k$ in \eqt{eq:7-eqn}, keeping 
the same definition of the interfacial variables and relaxation coefficients given in \eqt{eq:int_variables_def} and \eqt{eq:relaxation_coeff}, respectively. The 
equation for the volume fraction of phase $j$ 
is simply replaced by the algebraic relation
%
\begin{align}
 \alpha_{j}= 1 - \alpha_{k}, \nonumber
\end{align}
%
which reduces the number of partial differential equations from eight to seven. % and yields the Seven-Equation two-phase flow Model (SEM).
%
%----------------------------------------------------------------------------------------------------------------------------------
\subsection{The Regularized Seven-Equation two-phase flow Model}\label{sec:ref-sem}
%----------------------------------------------------------------------------------------------------------------------------------
%
The Seven-Equation Model is a non-conservative hyperbolic system of equations that can admit non-smooth solutions even with smooth initial data. This 
behavior is due to the nonlinear nature of the flux functions. In the case of non-conservative system of equations, the concept of weak solution is introduced by the DLM theory \cite{dlm}
which guarantees the existence of global solutions. To ensure convergence of the numerical solution to an unique physical solution also referred to as entropy solution, an additional condition, 
the``entropy condition'', is imposed \cite{lefloch_1988}. \tcb{I modified the text here} This entropy condition was used 
in \cite{Marco_paper_sem} to derive a numerical method under the form of a viscous regularization that is consistent with a minimum entropy principle \tcb{Make sure that we have it defined somewhere above}. 
The inviscid Seven-Equation two-phase flow Model along with the viscous 
regularization yields the regularized Seven-Equation two-phase flow Model that is recalled below in \eqt{eq:reg-7-eqn} 
(the viscous regularization terms are placed on the right-hand side for clarity of presentation). The reader 
is referred to \cite{Marco_paper_sem} for the detailed derivation of these dissipative terms.
%
\begin{subequations}\label{eq:reg-7-eqn}
\begin{align}
  % liquid mass conservation
  \label{multi-d-7-equ-liq}
  \frac{\partial \left( \alpha \rho \right)_{k} A}{\partial t}
  + \div \left[ (\alpha \rho \mbold u)_k A\right]
  &= \div \mbold f_k\,,
\end{align}
\begin{multline}\label{eq:multi-7-eqn-mom}
  % liquid momentum
  \frac{\partial \left( \alpha \rho \mbold u \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} A \left( \rho \mbold u \otimes \mbold u + P \mathbb{I} \right)_{k} \right]
  - P_{int} A \grad \alpha_{k} 
  \\
  + P_{k} \alpha_{k} \grad A
  - A \lambda_u (\mbold u_{j} - \mbold u_{k})
  =  \div \mathbb{g}_k \,,
\end{multline}
\begin{multline}\label{eq:multi-7-eqn-energy}
  % liquid total energy
  \frac{\partial \left( \alpha \rho E \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} \mbold u_{k} A \left( \rho E + P \right)_{k} \right]
  - P_{int} A \mbold u_{int} \cdot \grad \alpha_{k} + 
  \\
  \bar{P}_{int} A \mu_P (P_{k} - P_{j})
  - A \lambda_u \bar{\mbold u}_{int} \cdot (\mbold u_{j} - \mbold u_{k})
  = \div \left( \mbold h_k + \mbold u_k \cdot \mathbb{g}_k \right) \, ,
\end{multline}
\begin{align}
  % liquid volume fraction
  \label{eqn:multi-d-7-eqn-liq-vol}
  \frac{\partial \alpha_{k} A}{\partial t} + A\mbold u_{int} \cdot \grad \alpha_{k}
  &- A \mu_P (P_{k} - P_{j}) = \div \mbold l_k\, .
\end{align}
\end{subequations}
%
The dissipative terms $\mbold l_k$, $\mbold f_k$, $\mathbb{g}_k$ and $\mbold h_k$ are as follows (\cite{Marco_paper_sem}):
%
\begin{subequations}\label{eq:visc-reg-7-equ}
\begin{align}
  \mbold l_k &= \beta_k A \grad \alpha_k 
\end{align}
\begin{align}
  \mbold f_k &= \alpha_k A \kappa_k \grad \rho_k + \rho_k  \mbold l_k 
\end{align}
\begin{align}
\mathbb{g}_k &= \alpha_k A \mu_k \rho_k \grad^s \mbold u_k + \mbold f_k \otimes \mbold u_k 
\end{align}
\begin{align}
  \mbold h_k &=  \alpha_k A \kappa_k \grad \left( \rho e \right)_k  - \frac{\| \mbold u_k \|^2}{2} \mbold f_k + (\rho e)_k \mbold l_k 
\end{align}
\end{subequations}
%
where $\beta_k$, $\kappa_k$ and $\mu_k$ are positive phasic viscosity coefficients. The final form of the entropy residual equation including the physical source terms (in the lefthand side) and the artificial dissipative terms (in the righthand side) is recalled in \eqt{eq:full-ent-equ-7-eq-model} for consistency.
%
\begin{align} \label{eq:full-ent-equ-7-eq-model}
\alpha_k \rho_k A \frac{Ds_k}{Dt} &- (s_{e})_k \left[\mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2 + \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j -\mbold  u_k)^2 \right. \nonumber
\\
&\left. \| \grad \alpha_k \| \frac{Z_k}{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)+\frac{\grad \alpha_k}{\| \grad \alpha_k \|}(P_k-P_j)\right]^2 \right] = \nonumber \\
&\mbold f_k \cdot \grad s_k + \div \left( \alpha_k A \rho_k \kappa_k  \grad s_k \right) 
- \alpha_k \rho_k A \kappa_k Q_k \nonumber \\
&+ (s_e)_k \alpha_k A \rho_k \mu_k \grad^s \mbold u_k : \grad \mbold u_k \ ,
\end{align}
%
where $Q_k$ is 
%
\begin{eqnarray}
Q_k &=& \mathbf{X}^T_k \mathbb{\Sigma}_k \mathbf{X}_k \nonumber \\
\text{with } \mathbf{X}_k &=& \begin{bmatrix}
\grad \rho_k \\
\grad e_k 
\end{bmatrix}
\text{ and } \mathbb{\Sigma}_k = \begin{bmatrix}
       \rho_k^{-2} \partial_{\rho_k} (\rho^2_k \partial_{\rho_k} s_k) & \partial_{\rho_k,e_k} s_k  \\[0.3em]
       \partial_{\rho_k,e_k} s_k & \partial_{e_k,e_k} s_k           \\[0.3em]
     \end{bmatrix}. \nonumber 
\end{eqnarray}
%
We refer once again the reader to \cite{Marco_paper_sem} for details regarding the derivations of the artificial dissipative terms, the sign of the terms in \eqt{eq:full-ent-equ-7-eq-model} and proof of the minimum entropy
principle (see Theorem 1 of \cite{Marco_paper_sem}).
%\tcr{here, I feel like I would like to add that is the entropy equation that we obtain when the dissipative terms are present. I think
%this could complete the review of the previous work. Do you think so too? If so, just add a couple of sentence to that effect and show the entropy equation. Then we can
%start talking about the viscosities themselves....} \tcb{done}

To employ the above viscous regularization, definitions for the phasic viscosity coefficients $\beta_k$, $\mu_k$ and $\kappa_k$ need to be supplied. 
In \cite{Marco_paper_sem}, we showed that the viscous regularization given in \eqt{eq:visc-reg-7-equ} when used with a local Lax-Friedrichs (LLF) 
viscosity, was capable of efficiently stabilizing a numerical solution that develops shock and discontinuity waves, thought with excessive dissipation. 
We also pointed out the well known ill-scaled behavior of the LLF scheme in the low-Mach limit. Excessive dissipation and undesirable behavior in the low-Mach limit can be avoided 
by devising a high-order viscosity that adds sufficient dissipation in the vicinity of a shock while ensuring a correct behavior in the low-Mach limit. 
This is discussed next, in \sct{sec:visc-def}, which constitutes the novelty of this paper.
%  
%----------------------------------------------------------------------------------------------------------------------------------
\section{All-Mach definition of the phasic viscosity coefficients}\label{sec:visc-def}
%----------------------------------------------------------------------------------------------------------------------------------
%
%\tcr{I wonder if this shouldn't be a new section to emphasize it is new, while the previous section would be everything that was already known....} \tcb{done}
%
The remainder of this paper presents new theoretical aspects regarding the application of the Entropy Viscosity Method to the Seven-Equation two-phase flow Model.
%that are emphasized in \sct{sec:visc-def} and \sct{sec:results}. 
This Section (\sct{sec:visc-def}) aims at presenting the steps leading to the derivation of the all-Mach flow definitions for the phasic viscosity coefficients $\beta_k$, $\mu_k$ and $\kappa_k$ used in the viscous regularization of the SEM (see \eqt{eq:reg-7-eqn} and \eqt{eq:visc-reg-7-equ}). Then, 1-D numerical results are presented in \sct{sec:results} to validate our approach, after detailing the discretization method in \sct{sec:disc}. 

In the following, the reader is guided through the derivation of the all-Mach phasic viscosity coefficients $\beta_k$, $\mu_k$ and $\kappa_k$. Note that since each phase can experience different flow regimes, 
e.g., supersonic gas and subsonic liquid, it is elected to keep distinct the three viscosity coefficients for each phase.
In the Entropy Viscosity Method, each viscosity coefficient is function of a first-order 
viscosity coefficient and an entropy viscosity coefficient (high-order coefficient) 
and are denoted by the subscript $max$ and $e$, respectively. The first-order viscosity coefficient is the local maximum amount of dissipation allowed that ensures smoothness of the numerical solution even in the vicinity of the shock. The objective is to know the amount of dissipation required in order to locally prevent the formation of spurious oscillations and have the correct entropy jump as discussed (see \sct{sec:visc-coeff-fo}). However, the first-order viscosity coefficient does not allow to recover the low-Mach asymptotic limit \cite{Marco_paper_sem}. On the other hand, the high-order viscosity coefficient is designed (i) to be peaked in shock waves and other discontinuities and thus, is used as a discontinuity tracker (see \sct{sec:visc-coeff-ho}), and (ii) to ensure well-scaled dissipative terms in the low-Mach asymptotic limit. Then, by combining the first- and high-order viscosity coefficients, appropriate amount of dissipation is added to the numerical solution in shocks and other discontinuities while ensuring high-order accuracy anywhere else and appropriate behavior in the low-Mach limit (see \sct{sec:visc-coeff}).
\\ \tcr{that's just about notation. maybe a reader would like to know why there is an upper bound.
also, we never talked in terms of lower bound. where is this coming from???} \tcb{done}
%Derivation of the definitions for the all-Mach flow viscosity coefficients relies on 
%the low-Mach asymptotic study of the regularized SEM performed in \cite{Marco_paper_sem}. 
%
\begin{remark}
The link to Flux Corrected Transport (FCT) (REF) is strong since the first- and high-order viscosity coefficients can be seen as low- and high-order methods, respectively. The difference with FCT mainly lies in the way the two viscosity coefficients methods are combined as it is discussed in \sct{sec:visc-coeff}.
\end{remark}
%
%-------------------------------------------------------------------------------------------------------------------
\subsection{Definition of the first-order viscosity coefficients}\label{sec:visc-coeff-fo}
%-------------------------------------------------------------------------------------------------------------------
%
The first-order viscosity coefficient is chosen to be equivalent to a local Lax-Friedrichs scheme that is known to be over-
dissipative and thus, will prevent spurious oscillation from forming. In \cite{Marco_paper_sem}, we chose to set the phasic viscosity 
coefficients proportional to the local maximum eigenvalue of each phase as shown in \eqt{eq:visc-coeff-fo-def-1} as follows:
%
\begin{equation}\label{eq:visc-coeff-fo-def-1}
\beta_{k,max}(\mbold{r},t) = \mu_{k,max}(\mbold{r},t) = \kappa_{k,max}(\mbold{r},t) = \frac{h}{2} \left( || \mbold{u}_k || + c_k \right)
\end{equation}
%
where $h$ is a cell characteristic size and $|| \cdot ||$ denotes the Euclidean norm. Note that an example of definition for $h$ when considering a 
cell $K$ of volume $|K|$ belonging to a mesh of dimension 
$\texttt{dim}$ is $h = |K|^\frac{1}{\texttt{dim}}$. 
%With the above definition of the first-order viscosity coefficients, the numerical solution was shown to be stable 
%in \cite{Marco_paper_sem} for the case of a 1-D Sod shock test. 
%
\begin{remark}
Because the eigenvalue corresponding to the volume fraction equation (\eqt{eqn:multi-d-7-eqn-liq-vol}) is the local interfacial velocity $\mbold u_{int}$,
the first-order viscosity coefficient $\beta_{k,max}$ could also be defined proportional to $\mbold u_{int}$ as follows:
%
\begin{equation}\label{eq:visc-coeff-fo-def-2}
\beta_{k,max}(\mbold{r},t) = \frac{h}{2} || \mbold{u}_{int} ||
\end{equation}
%
while keeping the definitions of the first-order viscosity coefficients $\mu_{k,max}$ and $\kappa_{k,max}$ unchanged.
The impact of the two possible definitions for $\beta_{k,max}$ given in \eqt{eq:visc-coeff-fo-def-1} and \eqt{eq:visc-coeff-fo-def-2} onto the numerical 
profile for the volume fraction will be illustrated in \sct{sec:results}.
\end{remark}
%
%-------------------------------------------------------------------------------------------------------------------
\subsection{Definition of the high-order viscosity coefficients}\label{sec:visc-coeff-ho}
%-------------------------------------------------------------------------------------------------------------------
%
\tcg{I have review until here}
In this paragraph, we derive the high-order viscosity coefficients denoted by the subscript $e$: $\beta_{k,e}$, $\mu_{k,e}$ and $\kappa_{k,e}$ and relies on the low-Mach asymptotic study of the regularized SEM 
performed in \cite{Marco_paper_sem}. In the Entropy Viscosity Method (EVM), the high-order viscosity coefficients are set proportional to the local entropy 
residual that measures the local entropy production. This entropy residual is known to be peaked in the vicinity of the shock wave \cite{Leveque}. 
This approach has been successfully used to resolve shock waves for single-phase flows (see \cite{GuermondJCP2011, GuermondCSE2011, GuermondCRA2008,ZinganJCP2013,DelchiniCompFluid2014-euler}). 

We first derive expressions for the high-order phasic viscosity coefficients $\mu_{e,k}$ and $\kappa_{e,k}$ by following the same 
approach used in \cite{DelchiniCompFluid2014-euler} for the single-phase Euler equations. Such an approach is justified because the regularized SEM of \eqt{eq:7-eqn} 
degenerates to the regularized Euler equations studied in \cite{DelchiniCompFluid2014-euler} when one phase disappears.
By setting the high-order viscosity propoertional to the local entropy residual (as well as the inter-element jumps in the entropy flux as described later),
one is able to track spatially and temporally any shock and discontinuity forming in the computational domain. 
In \cite{DelchiniCompFluid2014-euler}, we showed that recasting the entropy residual ($\resi(\mbold r,t)  := \matder{s}$) 
as a function of pressure, velocity, density, and speed of 
sound, allowed for an alternative expression of the entropy residual ($\resinew(\mbold r,t)$)
that no longer required an analytical expression of the entropy $s_k$ and while still experiencing the same variations (in absolute value) 
as the original entropy residual as shown in \eqt{eq:ent-res-sem},
%
\begin{equation}\label{eq:ent-res-sem}
\resi(\mbold r,t)  := \matder{s} = \frac{s_e}{P_e} \left( \underbrace{\matder{P} - c^2 \matder{\rho} }_{\resinew(\mbold r,t)} \right) ,
\end{equation} 
%
% where $\matder{(\cdot)}=\partial_t (\cdot)+\mbold u \cdot \grad (\cdot)$ denotes the material or total derivative. 
We adopt the same approach to derive the phasic viscosity coefficients in the case of Seven-Equation Model, emphasizing only the 
peculiarities related to the two-fluid system. We refer the reader to \cite{DelchiniCompFluid2014-euler} for the detailed derivations presented in the case of
single-phase flows.
\begin{enumerate}
%
\item Using the new expression of the entropy residual $\resinew_k = \matder{P_k} - c_k^2 \matder{\rho_k}$, we now propose definitions, 
for the phasic entropy viscosity coefficients $\mu_{k,e}$ and $\kappa_{k,e}$ 
\be
\mu_{k,e}    \propto \max\left( | \resinew_k(\mbold r_q,t) |\,,  J_k  \right) \quad \text{and} \quad
\kappa_{k,e} \propto \max\left( | \resinew_k(\mbold r_q,t) |\,,  J_k  \right) 
\ee
where we also accounted for the jumps $J_k$ in the normal derivatives of pressure and density (multiplied by $c^2$): 
\begin{equation}\label{eq:jump-p-rho}
J_k = \| \mbold{u}_k \| \max \left( J[P_k] \, ,  c^2_k  J[\rho_k] \right)\,.
\end{equation}
The operator $J[\cdot]$ will be defined in \sct{sec:spatial-disc} as its definition is discretization-dependent.
%
\item A distinct normalization parameter is introduced for each phasic viscosity coefficient. This normalization parameter enables an all-speed
solver by changing its definition based on the local Mach number as seen below:
%
\begin{subequations}\label{eq:visc-coeff-ho-1}
\begin{equation}
\mu_{k,e}(\mbold r,t)    = h^2 \frac{\max\left( | \resinew_k(\mbold r_q,t) |\,,  J_k  \right)}{\norm_{P,k}^\mu},
\end{equation} 
\text{and} 
\begin{equation}
\kappa_{k,e}(\mbold r,t) = h^2 \frac{\max\left( | \resinew_k(\mbold r_q,t) |\,,  J_k  \right)}{\norm_{P,k}^\kappa} \, .
\end{equation}
\end{subequations}
%
A dimensional study of the 
dissipative terms shows that the viscosity coefficients are kinematic viscosity ($m^2 \cdot s^{-1}$) and thus requires the normalization parameters to have units of
pressure, which leads to the following normalization values such as $P_k$, $\rho_k c_k^2$, or $\rho_k \| \mbold{u}_k \|^2$, 
%
\item The choice of normalization parameters $\norm_{P,k}^\mu$ and $\norm_{P,k}^\kappa$ are determined by performing a low-Mach asymptotic study of the 
non-dimensional regularized SEM (\eqt{eq:reg-7-eqn}) by considering two cases: (a) the isentropic low-Mach limit where the 
Seven-Equation Model devolves to an incompressible system of 
equations and (b) the non-isentropic limit where shocks can occur \tcb{briefly recall the steps of other paper}. The non-dimensional regularized 
equations of the SEM were derived in \cite{Marco_paper_sem} using the phasic non-dimensionalized variables defined in \eqt{eq:norm_param}:
%
\begin{multline}
\label{eq:norm_param}
\rho_k^*   = \frac{\rho_k}{\rho_{k,\infty}}           ,\
u_k^*      = \frac{\mbold u_k}{u_{k,\infty}}                 ,\
P_k^*      = \frac{P_k}{\rho_{k,\infty} c^2_{k,\infty}}   ,\
e_k^*      = \frac{e_k}{c^2_{k,\infty} }              , \
E_k^*      = \frac{E_k}{c^2_{k,\infty} }              , \\
\alpha_k^*      = \frac{\alpha_k}{\alpha_{k,\infty} }              , \
x^* = \frac{x}{L_\infty}                      ,\
t_k^* = \frac{t_k}{L_\infty / u_{k,\infty}}           ,\
\mu_k^*    = \frac{\mu_k}{\mu_{k,\infty}}             ,\
\kappa_k^* = \frac{\kappa_k}{\kappa_{k,\infty}}       ,
\end{multline}
%
where  the subscript $\infty$ denotes the far-field or stagnation quantities and the superscript $*$ stands for the non-dimensional variables.
The far-field reference quantities are chosen such that the dimensionless flow quantities are of order 1. The stagnation quantities for 
the pressure and velocity interfacial variables will be specified for each case and the reference phasic Mach number is given by
%
\begin{equation}
M_{k,\infty} = \frac{u_{k,\infty}}{c_{k,\infty}} \,.
\end{equation}
%
The non-dimensionalized equations of the SEM are now recalled in \eqt{eq:sev_equ_case_one_scaled} for the purpose of our study:
% 
\begin{subequations}\label{eq:sev_equ_case_one_scaled}
%
\begin{multline}\label{eq:sev_equ-with-diss-terms-cont_case_one_scaled}
\partial_{t^*} \left( \alpha_k \rho_k A \right)^* + \grad^* \cdot \left( \alpha_k \rho_k \mbold u_k A \right)^* = \\ \frac{1}{\Pe^\kappa_{k,\infty}}\grad^* \cdot \left(A 
\kappa_k \alpha_k \grad \rho_k \right)^* +
\frac{1}{\Pe_{k,\infty}^\beta} \grad^* \cdot \left( A \beta_k \rho_k \grad \alpha_k \right)^*
\end{multline}
%
\begin{multline}\label{eq:sev_equ-with-diss-terms-mom_case_one_scaled}
\partial_{t^*} \left( \alpha_k \rho_k u_k A \right)^* + \grad^* \cdot \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k\right)\right]^* + \frac{1}{M^2_{k,
\infty}}\grad^* \left( \alpha_k A P_k^* \right) = \\
  \frac{1}{M^2_{k,\infty}} \alpha_k^* P^*_k \grad^* A^*  
+ \frac{1}{\Re_{k,\infty}}\grad^* \cdot \left( \alpha_k A \mu_k \rho_k \grad^s \mbold u_k \right)^* \\ 
+ \frac{1}{\Pe_{k,\infty}^\kappa} \grad^* \cdot\left( \alpha_k A \kappa_k \grad \rho_k \otimes \mbold u_k \right)^* 
+ \frac{1}{\Pe_{k,\infty}^\beta} \grad \cdot \left( A \beta_k \rho_k \grad \alpha_k \otimes \mbold u_k \right)^*
\end{multline}
%
\begin{multline}\label{eq:sev_equ-with-diss-terms-ener_case_one_scaled}
\partial_{t^*} \left( \alpha_k^* A \rho_k E_k \right)^* + \grad^* \cdot \left[ \alpha_k^* A \mbold u_k^*  \left( \rho_k E_k \right)^* \right] +  \grad^* \cdot 
\left(\alpha_k^* A \mbold u_k P_k \right)^*  \\ =
\frac{1}{\Pe_{k,\infty}^\kappa} \grad^* \cdot \left( \alpha_k A \kappa_k \grad \left( \rho_k e_k \right) \right)^* 
+ \frac{M^2_{k,\infty}}{\Pe_{k,\infty}^\kappa} \grad^* \cdot \left( A\alpha_k \kappa_k \frac{||\mbold u_k||^2}{2} \grad \rho \right)^*  \\
+ \frac{M^2_{k,\infty}}{\Re_{k,\infty}} \grad^* \cdot \left( \alpha_k A \mu_k \rho_k \mbold u_k : \grad^s \mbold u_k\right)^* 
+ \frac{1}{\Pe_{k,\infty}^\beta } \grad^*\cdot \left( \rho_k e_k A \beta_k \grad \alpha_k \right)^*
\end{multline}
%
\end{subequations}
%
where (\tcr{this is a bit short and you never explain what $\infty$ is either} \tcb{done})
the phasic numerical Reynolds number ($\Re_{k,\infty})$ represents the ratio of fluid inertia 
force to (numerical) viscous forces and 
the P\'eclet numbers ($\Pe_{k,\infty}^\kappa$ and $\Pe_{k,\infty}^\beta$) represent the ratio of advection rate to (numerical) diffusion rate. These numbers are defined as:
%
\begin{equation}
\label{eq:ref_numb}
\Re_{k,\infty} = \frac{u_{k,\infty} L_\infty}{\mu_{k,\infty}} \ ,
\Pe_{k,\infty}^\kappa = \frac{u_{k,\infty} L_\infty}{\kappa_{k,\infty}} \text{ and }
\Pe_{k,\infty}^\beta = \frac{u_{k,\infty} L_\infty}{\beta_{k,\infty}} \ .
\end{equation}
%
The numerical Reynolds and P\'eclet numbers are obviously related to the 
viscosity coefficients $\mu_{k,\infty}$, $\kappa_{k,\infty}$ and $\beta_{k,\infty}$. Thus, once a scaling (in terms of powers of $M_{k,\infty}$) 
is obtained for $\Re_{k,\infty}$, $\Pe_{k,\infty}^\kappa$, and $\Pe_{k,\infty}^\beta$ in the two limit cases (a) and (b) \tcr{where???} \tcb{done}, it will 
impose a condition for the definition of the phasic viscosity coefficients $\mu_k$, $\kappa_k$, and $\beta_k$. 
\end{enumerate} 
The study of the non-dimensional regularized SEM in the cases (a) and (b) was performed in \cite{Marco_paper_sem}. We only recall here the scaling of the numerical numbers previously defined in \eqt{eq:ref_numb}, for the tow cases (a) and (b). For further details regarding the logic and the steps that lead to such scaling, the reader is referred to \cite{Marco_paper_sem}. \tcr{too late. it is conceivable that this section will need more work. we need this fix 
the logic quickly ... time is running out before the semester ....} \tcb{done}. 
In case (a), that corresponds to the isentropic low-Mach limit, the regularized SEM was found to yield the correct 
low-Mach asymptotic limit with well-scaled dissipative terms when the numerical numbers have the following scaling:
%
\begin{equation}\label{eq:isent-flow-num-nb}
\Re_{k,\infty} = \Pe_{k,\infty}^\kappa = \Pe_{k,\infty}^\beta =1 \ .
\end{equation}
%
In case (b), for non-isentropic flows i.e. with shock waves, the scaling of the numerical numbers is given in \eqt{eq:non-isent-flow-num-nb} and is expected to efficiently 
stabilize shock waves and discontinuities for any Mach numbers:
%
\begin{align}\label{eq:non-isent-flow-num-nb}
&\Re_{k,\infty} = M_{k,\infty}^2 \,, \nonumber \\ 
& \Pe_{k,\infty}^\kappa = 
%\begin{cases} 
1 \\ %             & \text{ in the contact region} \\
%M^2_{k,\infty} & \text{ in the shock region } 
%\end{cases} \,, \\ 
&\Pe_{k,\infty}^\beta = 1 \ . \nonumber
\end{align}
\tcr{don't you want to stick with $ \Pe_{k,\infty}^\kappa = M^2_{k,\infty}$. it's easier. how can you differentiate between the 2 types. and do you do it in the 
code? a reviewer may ask.
is it worth it?} \tcb{it is actually fairly simple. We can talk about it.}
Following the methodology employed in \cite{DelchiniCompFluid2014-euler} and the conditions given in \eqt{eq:isent-flow-num-nb} and \eqt{eq:non-isent-flow-num-nb}, the definition of the 
phasic normalization parameters $\norm_{k,P}^\mu$ and $\norm_{k,P}^\kappa$ can be devised in the two limit cases, to yield:
%
\begin{equation}
\label{eq:norm_relation_bis}
\norm_{k,P,\infty}^{\kappa} = \Pe_\infty \rho_{k,\infty} c_{k,\infty}^2 = \rho_{k,\infty} c_{k,\infty}^2 \, .
\end{equation}
%
and
%
\begin{equation}
\label{eq:norm_ent2}
\norm_{P,k}^\mu = \Re_{k,\infty} \rho_{k,\infty} c_{k,\infty}^2 =  \left\{
\begin{array}{ll}
 \rho_k \|\vec{u}_k \|^2       & \text{ for non-isentropic flows} \\
 \rho c_k^2 = \norm_{k,P}^\kappa & \text{ for low-Mach flows}
\end{array}
\right. \,.
\end{equation}
%
In order to have a stabilization method 
valid for a wide range of Mach numbers, from very low-Mach to supersonic flows, the two scalings derived in \eqt{eq:norm_ent2} for the two cases (a) and (b), should 
be combined in a unique definition. 
%
In \cite{DelchiniCompFluid2014-euler}, it was proposed a function to transition between these two states by employing a smoothed shifted Heaviside function
defined as follows: % the shifted sigmoid function
\begin{equation}
\sigma(M_k) =
\left\{
\begin{array}{ll}
0 & \text{if } M_k \le M_k^\text{thresh} - a_k, \\
1 & \text{if } M_k \ge M_k^\text{thresh} + a_k, \\
\sigma(M_k)   & \text{otherwise,}
\end{array}
\right.
\end{equation}
where $M_k$ is the local phasic Mach number, , $M_k^\text{thresh}$ is a threshold Mach number value beyond which the flow is no longer 
considered to be low-Mach (we use $M_k^\text{thresh}=0.05$), and the scalar $a_k$ determines how rapidly the function $\sigma(M_k)$ 
changes in the vicinity of $M_k^\text{thresh}$ (e.g., $a = 0.005$). We have chosen
\be\label{eq:fct-sigma}
\sigma(M_k) = \tfrac{1}{2} \left( 1 + \tfrac{M_k-M_k^\text{thresh}}{a_k} + \tfrac{1}{\pi} \sin \left(\tfrac{\pi(M_k-M_k^\text{thresh})}{a_k}\right) \right) 
\ee
It is easy to verify that the construction
\begin{equation}
\label{eq:norm_ent3}
\norm_{k,P}^\mu = (1-\sigma(M_k)) \rho_k c_k^2  + \sigma(M_k)  \rho_k \|\vec{u}_k \|^2  
\end{equation}
satisfies the conditions given in \eqt{eq:non-isent-flow-num-nb}.
%

It remains now to define the entropy viscosity coefficient $\beta_{e,k}$. Note that the viscosity coefficient $\beta_k$ will mainly affect the stability of the volume fraction equation in shock waves and other discontinuities which leads us, for the purpose of this paragraph, to consider the volume fraction equation 
by itself without relaxation term, and assume the interface velocity $\mbold u_{int}$ given. Also, the study of the non-dimensional regularized SEM for the two cases (a) and (b) requires the numerical P\'eclet number $\Pe_k^\alpha$ to scale as one: this condition will be used to define the scaling of the normalization parameter.
Because the volume fraction equation is a scalar hyperbolic equation, we propose to define the entropy viscosity coefficients on the same model as 
what is typically done for Burger's equation \cite{GuermondJCP2011, GuermondCSE2011}. Hence, we take $\beta_e$ to be proportional to the entropy residual, $R_{k}^\alpha$, derived from the 
volume fraction equation alone in \eqt{eq:vf-sem2-sct4}:
%
\begin{align}\label{eq:def-beta-sen-sect4}
\beta_{e,k}( \mbold r, t) = h^2 \frac{\max\left( | R_{k}^\alpha(\mbold r_q,t) |\,,  J_k^\alpha \right)}{\norm_{\alpha, k}^\beta} \, .
\end{align}
%
In \eqt{eq:def-beta-sen-sect4}, we also added, as before, the jump of a function of the volume fraction, $J_k^\alpha$, and
introduced a separate normalization parameter, $\norm_{\alpha,k}^\beta$, whose expression will be given later in this section. To derive the 
entropy residual, $ R_{k}^\alpha$, 
we consider the volume fraction equation with its viscous regularization and assume the existence of an entropy function denoted by $\eta_k(\alpha_k)$:
%
\begin{equation}\label{eq:vf-sem-sct4}
\partial_t \left(A \alpha_k \right) + A \mbold u_{int} \cdot \grad \alpha_k = \div \left( \beta_k A \grad \alpha_k \right) \, .
\end{equation}
% 
After multiplying by $\frac{\text{d} \eta (\alpha_k)}{\text{d} \alpha_k}$ and using the chain rule formula, an expression for the entropy equation is obtained:
%
\begin{equation}\label{eq:vf-sem2-sct4}
\underbrace{\partial_t \left(A \eta(\alpha_k) \right) + A \mbold u_{int} \cdot \grad \eta(\alpha_k)}_{R_{k}^\alpha} = \frac{\text{d} \eta (\alpha_k)}{\text{d} \alpha_k} 
\div \left( \beta_k A \grad \alpha_k \right)
\end{equation}
% 
The entropy residual, $R_{k}^\alpha$, is defined as the left hand side of \eqt{eq:vf-sem2-sct4} and is known to be peaked in the shock region and negative 
when assuming convexity of the 
entropy $\eta_k$ with respect to $\alpha_k$ \cite{Leveque}. Such a behavior is identical to the entropy residual $\resinew_k$ defined in \eqt{eq:ent-res-sem}, 
and will allow detection of the 
shock wave in the volume fraction profile when used in the definition of the entropy viscosity coefficient $\beta_{e,k}$. The jump $J_k^\alpha$ is also defined 
on the same model as \eqt{eq:jump-p-rho} as shown in \eqt{eq:jump-alpha}:
\begin{equation}\label{eq:jump-alpha}
J_k^\alpha = \| \vec{u}_{int} \| J[\alpha_k] \,.
\end{equation}
%Using the new expression of the entropy residual $\resinew_k$, we now propose a definition \tcr{why this eq number?} for the phasic entropy 
%viscosity coefficients $\mu_{k,e}$ and $\kappa_{k,e}$. % that also accounts for the jumps, $J_k$, of some function of the pressure and density for generality purpose. 
The jumps helps tracking contact waves or discontinuities other than shocks since contact wave are not picked up by the entropy residual itself. 

Using the scaling of the numerical P\'eclet number $\Pe_k^\alpha$ and by following the same logic as previously highlighted, the normalization parameter $\norm_{\alpha,k}^\beta$ is found to scale as the reference value of the entropy function $\eta_{k,\infty}$. Thus, we propose to use the same definition as in \cite{GuermondJCP2011, GuermondCSE2011} for the normalization parameter of the viscosity coefficient $\beta_{e,k}$:
%
\begin{equation}
\norm_{k,\alpha}^\beta=|| \eta_k - \bar{\eta}_k ||_\infty \, ,
\end{equation}
%
where $|| \cdot ||_\infty$ and $\bar{\dot}$ denote the average operator over the whole computational domain and the infinite norm operator, respectively. \\

For clarity, we now recall the definition of the phasic entropy viscosity coefficients derived in this Section:
%
\begin{subequations}\label{eq:def-ent-visc-coeff-final}
%
\begin{equation}
\mu_{k,e}(\mbold r,t)    = h^2 \frac{\max\left( | \resinew_k(\mbold r,t) |\,,  J_k  \right)}{(1-\sigma(M_k)) \rho_k c_k^2  + \sigma(M_k)  \rho_k \|\vec{u}_k \|^2},
\end{equation} 
\begin{equation}
\kappa_{k,e}(\mbold r,t) = h^2 \frac{\max\left( | \resinew_k(\mbold r,t) |\,,  J_k  \right)}{\rho_k c_k^2} \, ,
\end{equation}
%
\begin{equation}
\beta_{e,k}( \mbold r, t) = h^2 \frac{\max\left( | R_{k}^\alpha(\mbold r,t) |\,,  J_k^\alpha \right)}{|| \eta_k - \bar{\eta}_k ||_\infty} \, ,
\end{equation}
%
\end{subequations}
%
where the entropy residuals $\tilde{R}_{k}$ and $R_{k}^\alpha$ are computed from \eqt{eq:ent-res-sem} and \eqt{eq:vf-sem2-sct4}, respectively. The function $\sigma(M_k)$ is computed using \eqt{eq:fct-sigma}.
%
%-------------------------------------------------------------------------------------------------------------------
\subsection{Final definitions of the viscosity coefficients}\label{sec:visc-coeff}
%-------------------------------------------------------------------------------------------------------------------
%
So far, we have defined a first-order and a high-order viscosity coefficients in \sct{sec:visc-coeff-ho} and in \sct{sec:visc-coeff-fo}, respectively. We can now define the phasic viscosity coefficients $\mu_k$, $\kappa_k$ and $\beta_k$: in the Entropy 
Viscosity Method, the 
viscosity coefficients are defined by taking the minimum between the first and high-order viscosity coefficients as shown in \eqt{eq:def-visc-sem}:
%
\begin{subequations}\label{eq:def-visc-sem}
\begin{equation}
\beta_k( \mbold r, t)  = \min \left( \beta_{k,e}( \mbold r, t) , \beta_{k,max} ( \mbold r, t)  \right), 
\end{equation}
\begin{equation}
\mu_k( \mbold r, t)    = \min \left( \mu_{k,e}( \mbold r, t)   , \mu_{k,max} ( \mbold r, t)    \right), 
\end{equation}
\begin{equation}
\kappa_k( \mbold r, t) = \min \left( \kappa_{k,e}( \mbold r, t), \kappa_{k,max} ( \mbold r, t) \right),
\end{equation}
\end{subequations}
%
where definitions of the entropy viscosity (with subscript  $e$) and the first-order (with subscript $max$) viscosity coefficients are found in \eqt{eq:def-ent-visc-coeff-final} and \eqt{eq:visc-coeff-fo-def-1}, respectively.
The above definition of the phasic viscosity coefficients take advantage of the properties of the entropy residual that is peaked in the vicinity of the shock: in 
the shock region the 
high-order viscosity coefficient will saturate to the first-order viscosity coefficient that is known to be over-dissipative. In another hand, in region where the 
numerical solution is smooth, 
the phasic viscosity coefficient will be equal to the high-order viscosity coefficient that will ensure high-order accuracy and also the correct low-Mach 
asymptotic limit.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Spatial and Temporal Discretizations} \label{sec:disc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
In this section, we briefly describe the spatial and temporal discretizations and the solution techniques 
used to solve the system of equations \eqt{eq:7-eqn}. For conciseness, we re-write the system of 
equations by considering two phases denoted by the subscript $k$ and $j$ in the following form:
\begin{equation}
\label{eq:form}
\partial_t \mathbf{U} + \div \mathbf{F} \left( \mathbf{U} \right) = \mathbf{R} \left( \mathbf{U} \right) + \mathbf{N} \left( \mathbf{U} \right) + \div 
\mathbf{D}(\mathbf{U}) \grad \mathbf{U}
\end{equation}
%\tcr{this is confusing. a reader may not understand where U has 4 or 8 unknowns and they may be looking for a vector with 7 components. you need to change this.
%i wouldn't mind keeping $(\alpha A )_k, \, (\alpha \rho A)_k,\, (\alpha \rho \mbold{u} A)_k,\, (\alpha \rho E A)_k$ 
%and adding $(\alpha \rho A)_j,\, (\alpha \rho \mbold{u} A)_j,\, (\alpha \rho E A)_j$. you should do the same for F, N, R .... then the next section, 3.1.1, one understands that you tackled all 7 equations at the same and everything is clear...}\tcb{done}\\
where $\mathbf{U}=[(\alpha A )_k, \, (\alpha \rho A)_k,\, (\alpha \rho \mbold{u} A)_k,\, (\alpha \rho E A)_k, (\alpha \rho A)_j,\, (\alpha \rho \mbold{u} A)_j,\, (\alpha \rho E A)_j]^T$ is the solution vector, $\mathbf{F} 
\left( \mathbf{U} \right)$ denotes 
the inviscid flux, $\div D (\mathbf{U}) \grad \mathbf{U}$ is the dissipative flux and $\mathbf{N} \left( \mathbf{U} \right)$ and $\mathbf{R} 
\left( \mathbf{U} \right)$ contain the non-conservative and relaxation terms, respectively. 
\begin{equation}
  \mathbf{F} \equiv
  \begin{bmatrix}
      0     \\
    ( \alpha \rho u A )_k     \\
    \left[ \alpha \left(\rho u^2 + P \right) A \right ]_k  \\
    \left[ \alpha u (\rho E + P) A \right]_k \\
    ( \alpha \rho u A )_j     \\
    \left[ \alpha \left(\rho u^2 + P \right) A \right ]_j  \\
    \left[ \alpha u (\rho E + P) A \right]_j    
  \end{bmatrix},
%\end{equation}
%\begin{equation}
  \mathbf{N} \equiv
  \begin{bmatrix}
      - A \mbold{u}_{int} \cdot \grad \alpha_k     \\
    0     \\
    \alpha_k P_k \grad A + P_{int} A \grad \alpha_k  \\
    P_{int} A \mbold{u}_{int} \cdot \grad \alpha_k \\
    0     \\
    \alpha_j P_j \grad A + P_{int} A \grad \alpha_j  \\
    P_{int} A \mbold{u}_{int} \cdot \grad \alpha_j    
  \end{bmatrix} \nonumber
\end{equation}
\begin{equation}
\text{and }
  \mathbf{R} \equiv
  \begin{bmatrix}
      A \mu_P \left( P_k - P_j \right)     \\
    0     \\
    A \lambda_u \left( \mbold u_j - \mbold u_k \right) \\
    - \bar{P}_{int} A \mu_P \left( P_k - P_j \right) + \bar{u}_{int} A \lambda_u \left( \mbold u_j - \mbold u_k \right) \\
    0     \\
    A \lambda_u \left( \mbold u_k - \mbold u_j \right) \\
    - \bar{P}_{int} A \mu_P \left( P_j - P_k \right) + \bar{u}_{int} A \lambda_u \left( \mbold u_k - \mbold u_j \right)    
  \end{bmatrix}. \nonumber
\end{equation}
%
%===================================================================================================
\subsection{Spatial and Temporal Discretizations} \label{sec:spatial-disc}
%===================================================================================================
%
The system of equations given in \eqt{eq:form} is discretized using a continuous Galerkin finite element 
method and temporal integrators available through the MOOSE multiphysics framework \cite{Moose2009}.
%
%---------------------------------------------------------------------------------------------------
\subsubsection{Continuous Finite Elements} 
%---------------------------------------------------------------------------------------------------
%
In order to apply the continuous finite element method, \eqt{eq:form} is multiplied by a test function 
$\mathbf W(\mbold{r})$, integrated by parts and each integral is decomposed into a sum of integrals over 
each element $K$ of the discrete mesh $\Omega$. The following weak form is obtained:
%
\begin{multline}\label{eq:cfem}
\sum_K \int_{K} \partial_t \mathbf U \, \mathbf W - \sum_K \int_{K} \mathbf F (\mathbf U) \cdot \grad \mathbf W + \int_{\partial \Omega} \mathbf F (\mathbf U) 
\cdot \mbold{n} \mathbf W - \sum_K \int_{K} \left( \mathbf N (\mathbf U) + \mathbf R (\mathbf U) \right) \mathbf W  \\
+ \sum_K \int_{K} D(\mathbf U) \grad \mathbf U \cdot \grad \mathbf W 
- \int_{\partial \Omega} D(\mathbf U) \grad \mathbf U \cdot \mbold{n} \, \mathbf W = 0 \,.
\end{multline}
%
The integrals over the elements $K$ are evaluated using a numerical quadrature. The MOOSE framework 
provides a wide range of test functions and quadrature rules. Linear Lagrange polynomials are employed 
as test functions in the results section. Second-order spatial convergence will be demonstrated for smooth solutions. 
%
%---------------------------------------------------------------------------------------------------
\subsubsection{Temporal integration} 
%---------------------------------------------------------------------------------------------------
%
In all of the numerical examples presented in \sct{sec:results}, the temporal derivative  will be 
evaluated using the second-order, backward difference temporal integrator BDF2 \cite{bdf2}. By considering three 
consecutive solutions, $\mathbf U^{n-1}$, $\mathbf U^n$ and $\mathbf U^{n+1}$, at times $t^{n-1}$, $t^n$ and $t^{n+1}$, respectively, BDF2 can be 
expressed as:
\begin{equation}
\label{eq:BDF2}
\int_{K} \partial_t \mathbf U \, \mathbf  W = \int_{K} \left( \omega_0 \mathbf U^{n+1}  + \omega_1 \mathbf U^n + \omega_2 \mathbf U^{n-1} \right) \mathbf W \,,
\end{equation}
%
with
\begin{multline}
\omega_0 =\frac{2\Delta t^{n+1}+\Delta t^n}{\Delta t^{n+1} \left( \Delta t^{n+1}+\Delta t^n \right)} \, , \ 
\omega_1 = -\frac{\Delta t^{n+1}+\Delta t^n}{\Delta t^{n+1} \Delta t^n}  \, , \\
\text{ and } \omega_2 = \frac{\Delta t^{n+1}}{\Delta t^n \left( \Delta t^{n+1} + \Delta t^n \right)} \nonumber
\end{multline}
where $\Delta t^{n} = t^n-t^{n-1}$ and $\Delta t^{n+1} = t^{n+1}-t^{n}$.
%
%---------------------------------------------------------------------------------------------------
\subsection{Boundary conditions} \label{sec:bc}
%---------------------------------------------------------------------------------------------------
%
Boundary conditions for the seven-equation model are challenging because of the wave-dominated nature of the equations but also because of the 
non-conservative form of the volume fraction equation. 

The boundary condition for the volume fraction equation, \eqt{eqn:multi-d-7-eqn-liq-vol}, is treated independently of the other equations (continuity, momentum 
and energy for each phase) for two reasons: (i) it is a simple advection equation with the real eigenvalue $\mbold u_{int}$, and (ii), the hyperbolic flux, 
$\mbold u_{int} \cdot \grad \alpha_k$, is not integrated by part because it is not expressed in a conservative form. 
The sign of the dot product between the eigenvalue for the volume fraction equation and the outward normal to the boundary, $\mbold u_{int} \cdot \mbold n$, determines 
the nature of the boundary: the sign is negative for an inlet and positive for an outlet. In the later case, the physical information exits the computational domain and 
does not require any particular treatment. In the former case, physical information enters the computational domain and the inlet the volume fraction needs to be specified.
This value is strongly imposed as a Dirichlet boundary condition.

Our implementation of the boundary conditions for the continuity, momentum and energy equations, is inspired by the method described in \cite{Berry_NED2010} and was 
adapted for a time implicit solver \cite{Marco_dissertation}. The number of physical information to be supplied to each boundary is based on the study of the characteristics, the eigenvalues and the Mach number. \\
%The treatment of the boundary condition for the volume fraction equation is simpler as the volume fraction is simply advected at the interfacial velocity $\mbold{u}_{int}$: at an inlet boundary i.e. $\mbold{u}_{int} \cdot \mbold{n} \leq 0$, the boundary value of the volume fraction is supplied. At an outlet i.e. $\mbold{u}_{int} \cdot \mbold{n} \geq 0$, the physical information exits the computational domain and the boundary value of the volume fraction is not supplied but computed from the characteristic equation. \\
\tcr{do you mean the number of physical information to be supplied to  is based on a study of the characteristics? if so, say it plainly} \tcb{done} \\
The numerical results presented in \sct{sec:results} were all obtained by using boundary types from the following list: subsonic stagnation, static pressure and wall boundary conditions.
\\ \tcr{why is outlet always static?}.\tcb{done} \\
The boundary flux is computed from the supplied variables at the boundary and also by iterating on a given number of variables (depending on the sign of the eigenvalues) though the implicit 
solver to transmit information from inside the computational domain toward the boundary. 
The artificial diffusion coefficient $\mbold D(\mathbf  U)$ is set to zero at the boundary of the computational 
domain so that the boundary term 
$\int_{\partial \Omega} \mbold D(\mathbf  U) \grad \mathbf  U \cdot \mbold{n} \, \mathbf W$ stemming from the 
integration by parts of the artificial dissipative terms in \eqt{eq:cfem} is ignored.
%
%---------------------------------------------------------------------------------------------------
\subsection{Solver} \label{sec:solver}
%---------------------------------------------------------------------------------------------------
%
A Jacobian-free Newton-Krylov (JFNK) method is used to solve for the solution at the end of each time step. A preconditioner, 
obtained using a finite difference approximation of the nonlinear residual, is used to speed up iterative convergence.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{$1$-D numerical results}\label{sec:results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
In this section, we present 1-D numerical results of the Seven-Equation two-phase model solved with the viscous regularization given in \eqt{eq:reg-7-eqn} of \sct{sec:ref-sem}, 
and the all-Mach flow definitions of the phasic viscosity coefficients defined in \eqt{eq:def-visc-sem} of \sct{sec:visc-def}.
The following values are used for the all-speed normalization of the high-order viscosity cofficients for both phases: $M_k^{thresh}=0.05$ and $a_k=0.005$. 
This section aims at assessing the capabilities of the Entropy 
Viscosity Method when solving various two-phase flow tests taken from the literature. 

The first set \tcr{how many?}\tcb{done} of 1-D numerical results presented in \sct{sec:1d-results-sba} is obtained using an application written using the multiphysics object-oriented simulation environment, MOOSE
\cite{Moose2009}, and consists of various shock tube cases with both liquid and gas phases present. 
In the first shock tube study, we investigate the impact of the choice of first-order viscosity on the volume fraction solution. 
Next, a shock tube with two independent fluids is presented by setting the relaxation coefficients $\mu_p$ and $\lambda_u$ to zero (\tcr{say how you make fluids independent} \tcb{done}): 
such a setting is strictly identical to solving each phase independently with a single-phase code. 
Then, the same shock tube problem is considered but with infinite relaxation coefficients which degenerates the SEM to the five-equation model of Kapilla \cite{Kapila_2001}. The objective of this test is to compare our numerical solution against the numerical solution obtained by the solving the SEM with the DEM \cite{Berry_NED2010}. 
(\tcr{say why you do this? to compare with Saurel 20xx results from}) \tcb{done}. 
Finally, two-phase flow tests through a converging-diverging nozzle are considered in \sct{sec:1d-results-nozzle}. 

For the second set of numerical results presented in \sct{sec:1d-results-relap-7}, we implemented the entropy-viscosity method presented here in the system code RELAP-7 \cite{Berry_2014} that is the next generation nuclear system safety analysis code being developed at the Idaho National Laboratory. RELAP-7 is a Moose-based application and employs state-of-the-art numerical method to ensure high-order accuracy of the numerical solutions using continuous Finite Element Method. The entropy-viscosity method is therefore a good candidate to stabilize the Seven-Equation Model that is used to simulate two-phase flows in Light-Water Nuclear Reactors. 
\tcr{need to say a couple of nice things about relap7, what does it do, etc. I am sure you can grab a couple of introduction sentence from a note that ray wrote on relap7....} \tcb{done}
These tests are prototypical of situations found in accident scenarios for nuclear reactors: first, a two-phase flow water hammer problem is simulated; then a hydrostatic test 
where phases circulate in opposite directions is computed; finally, steady-state for a Boiling Water Reactor (BWR). 

For each test, data regarding the equations of state, the computational grid, the boundary conditions and the time step used are provided. When an exact solution is available, a convergence study 
is performed and the errors are reported in the L$_1$ and L$_2$ norms. 
The convergence rates are computed using the exact solution and two numerical solutions obtained on successively refined grids according the following relation 
\begin{equation}
\label{eq:conv_rates}
\text{rate}_h = \ln \left( \frac{\| U_{2h}-U_{\text{exact}} \|}{\| U_{h}-U_{\text{exact}}\| } \right) / \ln 2
\end{equation}
where $\| \cdot \|$ denotes either the L$_1$ or L$_2$ norms and $h$ is the characteristic grid size.

All numerical results presented in this section are run with the second-order 
temporal integrator BDF2 \cite{bdf2} and linear test functions. The phases are described either by the Ideal gas equation of state (IGEOS) or the Stiffened Gas equation 
of state (SGEOS). A generic form for both equation of states is as follows:
%
\begin{equation}\label{eq:generic-form}
P_k = (\gamma_k-1) \rho_k (e_k - q_k) - \gamma_k P_{k,\infty} \, ,
\end{equation}
%
where the parameters $q_k$ and $P_{k,\infty}$ are phase-dependent. The IGEOS is retrieved from \eqt{eq:generic-form} by setting $q_k$ and $P_{k,\infty}$ to 
zero. Numerical results are presented for each test along with the profiles of the phasic viscosity coefficients.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Shock tube tests}\label{sec:1d-results-sba}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
The numerical results presented in this section were obtained with a Moose-based application with the objective of demonstrating the basic features of the EVM.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{A volume fraction shock tube}\label{sec:vf-advection-test}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
We consider a 1-D straight pipe of length L $=1 \ m$ filled with two independent phases (the relaxation coefficients are set to zero), initially in mechanical 
equilibrium (same pressure and same velocity) and described by the IGEOS with $\gamma_1 = 3$ and $\gamma_2 = 1.4$. The volume 
fraction variable is initialized with a step located in the middle of the pipe: $\alpha_{1,right}=0.9$ and $\alpha_{1,left}=0.1$. The density of the phase $1$ and $2$ are set to $10$ and $1 \ kg/
m^3$, respectively. \tcr{you use subscripts left/right and then 1/2. just use 1 and 2 all the time} \tcb{done}
The initial phasic pressure and velocity values are uniform and set to $0.1$ {\it MPa} and $100 \ m/s$, respectively. We use Dirichlet boundary 
conditions to impose the boundary values: the pipe is long enough to prevent the waves from reaching the boundaries. With such settings and using the definitions of 
the interfacial variables given in \eqt{E-R:86}, the interfacial pressure and 
interfacial velocity remains constant and equal to their respective average interfacial values. This test has a trivial solution which corresponds to 
the pure advection of the volume fraction 
profile. By performing such a test, we want to make sure that the artificial stabilization method is not responsible for the apparition of an artificial 
mixture zone in the pressure, velocity and density profiles. Because an exact solution is available, a convergence study is performed. 
Note that with such initial conditions and such settings, each equation of the SEM devolves into the volume fraction equation with proper artificial viscosity term. The 
numerical solution is run with a CFL of one until a final time of $t=1703 \ \mu s$; the domain is meshed uniformely with 200 cells. The pressure, velocity, density and volume 
fraction are presented in \fig{fig:adv-vf-variables}. The corresponding viscosity coefficients are given in \fig{adv-vf-visc}.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/vf-shock_two_phases_velocity.eps}
                \caption{Velocity}
                \label{fig:adv-vf-vel}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/vf-shock_two_phases_temperature.eps}
                \caption{Density}
                \label{fig:adv-vf-density}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/vf-shock_two_phases_pressure.eps}
                \caption{Pressure}
                \label{fig:adv-vf-press}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/advection-vol-fraction.eps}
                \caption{Volume fraction}
                \label{fig:adv-vf-vf}
        \end{subfigure}
        \caption{Numerical solution of a 1-D advection of the volume fraction at $t=1703 \ \mu s$.}\label{fig:adv-vf-variables}
\end{figure}
%
As seen in \fig{fig:adv-vf-variables}, the stabilization numerical method preserves the uniform velocity (\fig{fig:adv-vf-vel}), density (\fig{fig:adv-vf-density}),
and pressure (\fig{fig:adv-vf-press}) flow conditions. The discontinuity in the volume fraction profile shown in \fig{fig:adv-vf-vf} is well resolved and does not 
display any oscillations.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/liquid_viscosity.eps}
                \caption{Viscosity coefficients for phase 1.}
                \label{fig:adv-vf-1}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/liquid_viscosity.eps}
                \caption{Viscosity coefficients for phase 2}
                \label{fig:adv-vf-2}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/liquid_beta.eps}
                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
                \label{fig:adv-vf-beta}
        \end{subfigure}        
        \caption{Viscosity coefficients profiles for a 1-D advection of the volume fraction at $t=1703 \ \mu s$.}\label{adv-vf-visc}
\end{figure}
%
The phasic viscosity coefficients $\mu_k$ and $\kappa_k$ are equal to zero for both phases as shown in \fig{fig:adv-vf-1} and \fig{fig:adv-vf-2}, since the phasic 
flow conditions (pressure, density and velocity) are uniform. However, the viscosity coefficient $\beta_k$ is peaked in the discontinuity region as expected 
(\fig{fig:adv-vf-beta}). This test clearly shows that the stabilization method does not induce any artificial waves in the pressure, velocity, or density 
profiles due to the smearing of the discontinuity in the volume fraction profile. 

We also performed a convergence study by computing the L$_1$ and L$_2$ norms of the error between the numerical and the exact solutions for the volume 
fraction variable only. The exact solution was obtained from a Riemann solver. Following \cite{convergence_book}, the theoretical convergence rate for the L$_1$ and
L$_2$ norms are known to be $\frac{p+1/2}{p+1}$ and $\frac{1}{2}\frac{p+1/2}{p+1}$, respectively, where $p$ is the polynomial order of the test functions used. 
Because we are using linear polynomial test functions, i.e., $p=1$, the corresponding theoretical convergence rates for the L$_1$ and L$_2$ norms are 
$3/4$ and $3/8$, respectively. 
%
\begin{table}[H]
\begin{center}
 \caption{\label{tbl:conv_rate_norm} L$_1$ and L$_2$ norms of the error for the liquid volume fraction.}
 \begin{tabular}{|c|c|c|c|c|}
 \hline
cells  & L$_1$ norm  & L$_1$ rate   & L$_2$ norm & L$_2$ rate  \\ \hline
25     & 5.3721017 $10^{-2}$ & $-$    & 1.0624715 $10^{-1}$ & \\ \hline
50     & 3.4607761 $10^{-2}$ & 0.634 & 8.7183697 $10^{-2}$  & 0.285 \\ \hline
100   & 2.1396498 $10^{-2}$ & 0.694 & 6.6006650 $10^{-2}$  & 0.401 \\ \hline
200   & 1.2915332 $10^{-2}$ & 0.728 & 5.2105365 $10^{-2}$  & 0.341 \\ \hline
400   & 7.6834125 $10^{-3}$ & 0.749 & 4.0365699 $10^{-2}$  & 0.368 \\ \hline
800   & 4.5825174 $10^{-3}$ & 0.745 & 3.1465921 $10^{-2}$  & 0.359 \\ \hline
1600 & 2.7153206 $10^{-3}$ & 0.755 & 2.4413174 $10^{-2}$ & 0.366 \\ \hline
\end{tabular}
\end{center}
\end{table}
%
The theoretical convergence rates match the convergence rates computed from the numerical solutions as shown in \tbl{tbl:conv_rate_norm}, which denotes a  
correct behavior of the EVM in this test.

\tcr{so, where do you test for the 2 options for beta max???? as stated in a remark in the theory section???} \tcb{I think I will just add a remark}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Shock tube with two independent fluids}\label{sec:shock-tube-two-indep-fluids}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
We now consider a 1-D straight pipe of length L $=1$ $m$ filled with the same fluids as in \sct{sec:vf-advection-test}. The objective of this test is to show that 
the viscous regularization can efficiently stabilize two \emph{independent} fluids without creating artificial waves in the volume fraction solution that should remain 
constant (this test is complementary to the previous test presented in \sct{sec:vf-advection-test}). 
By setting the velocity and pressure relaxation coefficients $\mu_P$ and $\lambda_u$ to zero, the two fluids will behave independently of each other and the volume 
fraction is expected to remain uniform during the simulation.
%
A membrane, located at $x=0.5 \ m$, separates the pipe in two 
chambers with a high pressure ($P_{left} = 1$ {\it MPa}) on the left side and a low pressure ($P_{left} = 0.1$ {\it MPa}) in the right side. Both fluids are initially at rest. The volume fraction is set to $0.5$ which means each side of the chamber contains a mixture of two 
fluids. Dirichlet boundary conditions are used.  An exact solution is available for 
each fluid which simply corresponds to the single-phase exact solution obtained from a Riemann solver. Note that the same numerical results could be obtained by 
solving the $1$-D Euler equations for each phase separately. The geometry is discretized with an uniform mesh of 
500 cells and is run with a CFL of one until the final time $t = 305$ $\mu s$. The numerical solutions of the phasic density, velocity, pressure and volume fraction 
are given in \fig{fig:indp-phase-variables}. Profiles of the phasic viscosity coefficients $\mu_k$, $\kappa_k$ and $\beta_k$ are given in \fig{fig:indp-phase-visc-coeff}.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_velocity.eps}
                \caption{Velocity}
                \label{fig:indp-phase-vel}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_density.eps}
                \caption{Density}
                \label{fig:indp-phase-density}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_pressure.eps}
                \caption{Pressure}
                \label{fig:indp-phase-press}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_volume_fraction.eps}
                \caption{Volume fraction}
                \label{fig:indp-phase-vf}
        \end{subfigure}
        \caption{Numerical solution of a two-phase flow with large relaxation coefficients at $t=305 \ \mu s$.}\label{fig:indp-phase-variables}
\end{figure}
%
The velocity, density, and pressure profiles given in \fig{fig:indp-phase-vel}, \fig{fig:indp-phase-density} and \fig{fig:indp-phase-press}, respectively, 
show good agreement with the exact solutions for both phases and also do not display any oscillations in the vicinity of the shock. Fluid $2$ is 
lighter and thus experiences stronger spatial variations: its velocity is larger and thus the shock moves faster. The volume fraction remains constant during 
the transient and its profile is not altered by any mixture wave as shown in \fig{fig:indp-phase-vf}.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_vapor_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 1.}
                \label{fig:indp-phase-1}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_vapor_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 2}
                \label{fig:indp-phase-2}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/two_phases_liquid_beta.eps}
                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
                \label{fig:indp-phase-beta}
        \end{subfigure}        
        \caption{Viscosity coefficients profiles for a two-phase flow with large relaxation coefficients at $t=305 \ \mu s$.}\label{fig:indp-phase-visc-coeff}
\end{figure}
%
The viscosity coefficients shown in \fig{fig:indp-phase-1} and \fig{fig:indp-phase-2} for both phases have similar profiles: they are peaked in the 
shock regions and also display a bump in the contact wave; the contribution to the viscosity coefficient of the jump in the density gradient dominates 
in the contact wave (see \eqt{eq:jump-p-rho}). Note 
that the phasic viscosity coefficients $\mu_k$ and $\kappa_k$ are not equal since they do not have the same normalization parameter. The viscosity 
coefficient $\beta_k$ computed from \eqt{eq:def-visc-sem} and used in the volume fraction equation is zero (\fig{fig:indp-phase-beta}) as expected 
since the volume fraction profile remains uniform. 
To demonstrate convergence of the numerical solution to the exact solution, a sequence of finer spatial meshes is employed. Because 
of the presence of a shock, second-order accuracy is not expected and the convergence rate of a numerical solution 
should be 1 and $1/2$ when measured in the L$_1$ and L$_2$ norms, respectively \cite{banks-jeffrey, majda-andrew}. 
\tcr{I am confused and have been working many hours on this but how do we go from 3/4 and 3/8 to 1 and 1/2??? I am lost}
Results are reported from \tbl{tbl:l1-norm-indp-phase-1} to \tbl{tbl:l2-norm-indp-phase-2} for the conservative variables (density, 
momentum and total energy) of the two phases. The convergence rates for the L$_1$ and L$_2$ norms of the error computed using \eqt{eq:conv_rates} 
are in good agreement with the theoretical values.
%Alike in \sct{sec:vf-advection-test}, we performed a convergence test by computing the L$_1$ and L$_2$ norms of the error between the numerical and exact solutions. Once again, the exact solution was obtained from a Riemann solver (REF). The L$_1$ and L$_2$ norms of the error between the numerical and exact solution, and the convergence rate are given from \tbl{tbl:l1-norm-indp-phase-1} to \tbl{tbl:l2-norm-indp-phase-2} for the conservative variables of phases 1 and 2: density, momentum and total energy.
%
\begin{table}[H]
\begin{center}
 \caption{\label{tbl:l1-norm-indp-phase-1} L$_1$ norm of the error for phase 1.}
 \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
 \hline
cells & density         & rate   & momentum        & rate    & total energy         & rate     \\ \hline
25      & 4.2753735 $10^{-1}$ & $-$    & 8.4705 $10^{5}$ & $-$     & 7.2737           & $-$      \\ \hline
50      & 1.5115549 $10^{-1}$ & 0.698 & 4.7893 $10^{5}$ & 0.737 & 6.1493           & 0.24 \\ \hline
100    & 2.9373 $10^{-2}$ & 0.874 & 1.0613 $10^{5}$ & 0.896  & 1.2275           & 2.32   \\ \hline
200    & 5.1120 $10^{-3}$ & 0.814 & 1.8446 $10^{4}$ & 0.863  & 1.8943 $10^{-1}$ & 2.69   \\ \hline
400    & 1.0558 $10^{-3}$ & 0.815 & 3.7938 $10^{3}$ & 0.884  & 3.7919 $10^{-2}$ & 2.32   \\ \hline
800    & 2.3712 $10^{-4}$ & 0.896 & 8.4471 $10^{2}$ & 0.960  & 8.5517 $10^{-3}$ & 2.15   \\ \hline
1600  & 5.6058 $10^{-5}$ & 0.705 & 1.9839 $10^{2}$ & 0.694  & 2.0475 $10^{-3}$ & 2.06   \\ \hline
%3200  & 1.3278 $10^{-5}$ & $2.08$ & 4.6622 $10^{1}$ & 2.09  & 4.9516 $10^{-4}$ & $2.04$   \\ \hline
\end{tabular}
\end{center}
\end{table}
%
\begin{table}[H]
\begin{center}
 \caption{\label{tbl:l2-norm-indp-phase-1} L$_2$ norm of the error for phase 1.}
 \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
 \hline
cells& density            & rate & momentum          & rate & total energy           & rate \\ \hline
25      & 2.8037 $10^{-1}$ & $-$    & 8.4705 $10^{5}$ & $-$     & 7.2737           & $-$      \\ \hline
50      & 1.3343 $10^{-1}$ & 0.442 & 4.7893 $10^{5}$ & 0.434 & 6.1493           & 0.24 \\ \hline
100    & 2.9373 $10^{-2}$ & 0.522 & 1.0613 $10^{5}$ & 0.521  & 1.2275           & 2.32   \\ \hline
200    & 5.1120 $10^{-3}$ & 0.398 & 1.8446 $10^{4}$ & 0.489  & 1.8943 $10^{-1}$ & 2.69   \\ \hline
400    & 1.0558 $10^{-3}$ & 0.383 & 3.7938 $10^{3}$ & 0.500  & 3.7919 $10^{-2}$ & 2.32   \\ \hline
800    & 2.3712 $10^{-4}$ & 0.513 & 8.4471 $10^{2}$ & 0.644 & 8.5517 $10^{-3}$ & 2.15   \\ \hline
1600  & 5.6058 $10^{-5}$ & 0.378 & 1.9839 $10^{2}$ & 0.602  & 2.0475 $10^{-3}$ & 2.06   \\ \hline
%3200  & 1.3278 $10^{-5}$ & $2.08$ & 4.6622 $10^{1}$ & 2.09  & 4.9516 $10^{-4}$ & $2.04$   \\ \hline
\end{tabular}
\end{center}
\end{table}
%
\begin{table}[H]
\begin{center}
 \caption{\label{tbl:l1-norm-indp-phase-2} L$_1$ norm of the error for phase 2.}
 \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
 \hline
cells & density         & rate   & momentum        & rate    & total energy         & rate     \\ \hline
25      & 2.8037 $10^{-1}$ & $-$    & 8.4705 $10^{5}$ & $-$     & 7.2737           & $-$      \\ \hline
50      & 1.3343 $10^{-1}$ & 0.698 & 4.7893 $10^{5}$ & 0.82 & 6.1493           & 0.24 \\ \hline
100    & 2.9373 $10^{-2}$ & 0.874 & 1.0613 $10^{5}$ & 2.17  & 1.2275           & 2.32   \\ \hline
200    & 5.1120 $10^{-3}$ & 0.814 & 1.8446 $10^{4}$ & 2.52  & 1.8943 $10^{-1}$ & 2.69   \\ \hline
400    & 1.0558 $10^{-3}$ & 0.815 & 3.7938 $10^{3}$ & 2.28  & 3.7919 $10^{-2}$ & 2.32   \\ \hline
800    & 2.3712 $10^{-4}$ & 0.896 & 8.4471 $10^{2}$ & 2.17  & 8.5517 $10^{-3}$ & 2.15   \\ \hline
1600  & 5.6058 $10^{-5}$ & 0.705 & 1.9839 $10^{2}$ & 2.09  & 2.0475 $10^{-3}$ & 2.06   \\ \hline
%3200  & 1.3278 $10^{-5}$ & $2.08$ & 4.6622 $10^{1}$ & 2.09  & 4.9516 $10^{-4}$ & $2.04$   \\ \hline
\end{tabular}
\end{center}
\end{table}
%
\begin{table}[H]
\begin{center}
 \caption{\label{tbl:l2-norm-indp-phase-2} L$_2$ norm of the error for phase 2.}
 \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
 \hline
cells& density            & rate & momentum          & rate & total energy           & rate \\ \hline
25      & 2.8037 $10^{-1}$ & $-$    & 8.4705 $10^{5}$ & $-$     & 7.2737           & $-$      \\ \hline
50      & 1.3343 $10^{-1}$ & 0.619 & 4.7893 $10^{5}$ & 0.82 & 6.1493           & 0.24 \\ \hline
100    & 2.9373 $10^{-2}$ & 0.862 & 1.0613 $10^{5}$ & 2.17  & 1.2275           & 2.32   \\ \hline
200    & 5.1120 $10^{-3}$ & 0.745 & 1.8446 $10^{4}$ & 2.52  & 1.8943 $10^{-1}$ & 2.69   \\ \hline
400    & 1.0558 $10^{-3}$ & 0.749 & 3.7938 $10^{3}$ & 2.28  & 3.7919 $10^{-2}$ & 2.32   \\ \hline
800    & 2.3712 $10^{-4}$ & 0.749 & 8.4471 $10^{2}$ & 2.17  & 8.5517 $10^{-3}$ & 2.15   \\ \hline
1600  & 5.6058 $10^{-5}$ & 0.252 & 1.9839 $10^{2}$ & 2.09  & 2.0475 $10^{-3}$ & 2.06   \\ \hline
%3200  & 1.3278 $10^{-5}$ & $2.08$ & 4.6622 $10^{1}$ & 2.09  & 4.9516 $10^{-4}$ & $2.04$   \\ \hline
\end{tabular}
\end{center}
\end{table}
\tcb{The convergence rates have not been updated yet. I have a convergence rate of 0.45 for the L2 norm and 0.95 for the L1 norm. 
This does not match the theoritical convergence rates but does match what we had before}
%
%momentum
%
%L1_rate_gas =
%
%   0.678746095870472
%   0.885526625333708
%   0.762829013690574
%   0.769256729869945
%   0.676020388766989
%   0.211853870320983
%
%
%L2_rate_gas =
%
%   0.397859595661207
%   0.544224820073587
%   0.363005135237459
%   0.390095105196733
%   0.422498425942370
%   0.109587979500658
%
%energy
%L1_rate_liq =
%
%   0.836791451455638
%   0.914134005898690
%   0.899000357593017
%   0.921534650880842
%   0.978451199178983
%   0.591917552011068
%
%
%L2_rate_liq =
%
%   0.516467635119108
%   0.544927040186610
%   0.538068453112055
%   0.565187263949209
%   0.745617472277509
%   0.532064999635494
%
%
%L1_rate_gas =
%
%   0.803181250184597
%   0.984434154440203
%   0.856575051766479
%   0.852291371065551
%   0.557934272979114
%   0.186438681447322
%
%
%L2_rate_gas =
%
%   0.463694707907407
%   0.789666576586823
%   0.509273596388979
%   0.546572510988959
%   0.281892382344974
%   0.012598650453265
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Shock tube for two fluids in mechanical equilibrium (infinite relaxation coefficients)}\label{sec:shock-tube-infinite-rel-coeff}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
Once again, we consider a 1-D shock tube with the same initial conditions and the same fluids as in \sct{sec:vf-advection-test} and \sct{sec:shock-tube-two-indep-fluids}. 
The pressure and velocity relaxation coefficients are no longer set to zero but computed from \eqt{eq:Aint-def} and \eqt{E-R:86} with $A_{int}^{max} =  
6.75 \times 10^4$ $m^{-1}$: $\mu_P \sim 4$ and $\lambda_u \sim 5 \times 10^5$ $s^{-1}$. The values of the relaxation coefficients are large enough to make the 
relaxation terms dominant in the momentum and energy equations of each phase (see \eqt{eq:multi-7-eqn-mom} and \eqt{eq:multi-7-eqn-energy}). Thus, the two fluids will achieve mechanical equilibrium: they will exhibit the 
same pressure and velocity. The volume fraction will not remain uniform but is expected to vary due to the pressure relaxation source term (\eqt{eqn:multi-d-7-eqn-liq-vol}). For 
this test, an exact solution is not available but the reader can refer to \cite{Saurel_2007} for a comparison. \tcb{I will change the plot to include the solution fro, ray's code} An uniform mesh of 500 cells is used. The code is 
run until the final time $t = 305$ $\mu s$ with a CFL of one. The numerical solutions (pressure, velocity, density and volume fraction) of the phases $1$ and $2$ are presented in \fig{fig:inf-rel-variables} along with the viscosity coefficient profiles in \fig{fig:inf-rel-visc-coeff} for each phase. Dirichlet boundary conditions are once again used.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_two_phases_density.eps}
                \caption{Velocity}
                \label{fig:inf-rel-vel}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_two_phases_pressure.eps}
                \caption{Density}
                \label{fig:inf-rel-density}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_two_phases_velocity.eps}
                \caption{Pressure}
                \label{fig:inf-rel-press}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_two_phases_volume_fraction.eps}
                \caption{Volume fraction}
                \label{fig:inf-rel-vf}
        \end{subfigure}
        \caption{Numerical solution of a two-phase flow with large relaxation coefficients at $t=305 \ \mu s$.}\label{fig:inf-rel-variables}
\end{figure}
%
\tcr{the captions are messed up for the large relaxation test case}
As expected, the two fluids have the same pressure and velocity profiles as shown in \fig{fig:inf-rel-press} and \fig{fig:inf-rel-vel}, respectively. The shock is well resolved and does not display any instability. The main difference with the numerical results obtained in \sct{sec:shock-tube-two-indep-fluids} lies in the volume fraction profiles that are no longer uniform but display a shock wave around $x=0.7$ $m$ as shown in \fig{fig:inf-rel-vf}. Note also that the phasic density profiles given in \fig{fig:inf-rel-density} are not equal but experience the same variations : a shock and a contact discontinuity around $x=0.7 \ m$ and $x = 0.6 \ m$, respectively. 
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_phase_1_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 1.}
                \label{fig:inf-rel-visc-coeff-phase-1}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_phase_2_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 2}
                \label{fig:inf-rel-visc-coeff-phase-2}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/relaxation_phase_1_beta.eps}
                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
                \label{fig:inf-rel-beta}
        \end{subfigure}        
        \caption{Viscosity coefficients profiles for a two-phase flow with large relaxation coefficients at $t=305 \ \mu s$.}\label{fig:inf-rel-visc-coeff}
\end{figure}
%
The variations of the phasic viscosity coefficients are consistent with the position of the shock and contact discontinuity previously observed in \fig{fig:inf-rel-variables}. They are peaked in the vicinity of the shock and saturate to the first-order viscosity coefficients. A small peak is also observed in the contact discontinuity.\\
\tcb{I want to add an exact solution of the plots obtained from Ray's code. I think if Ray's solution is fine enough, we can probably do a convergence test.}
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Nozzle test cases}\label{sec:1d-results-nozzle}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Two independent fluids in a 1-D converging-diverging nozzle}\label{sec:nozzle-two-indep-fluids}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
A simulation for a two-phase flow through a 1-D converging-diverging nozzle is performed. The variable area function is given by 
$A(x) = 1 + \tfrac{1}{2} \cos(2 \pi x / L)$ with length L $=1 \ m$.  At the inlet, the stagnation pressure and temperature are set 
to $P_0 = 1 \ MPa$ and $T_0 = 453 \ K$, respectively \tcr{how should the reader understand how the temperature is used. some details could help a bit}. 
At the outlet, only the static pressure is specified: $P_s = 0.5$ {\it MPa}: in this test, 
the flow remains subsonic at the inlet. 
Initially, the liquid is at rest, the temperature is uniform and equal to the stagnation temperature and the pressure 
linearly decreases from the stagnation pressure inlet value to the static pressure outlet value. 
The stiffened gas equation of state is used to model the liquid water and vapor phases with the parameters provided in \tbl{tbl:stff_gas_eos-sect4}.
Because of the low pressure difference between the inlet and the outlet, the smooth initial conditions, 
and the large value of $P_\infty$ in \eqt{eq:generic-form}, the flow of the liquid water remains subsonic and thus displays no shock. The vapor phase, however, experiences a shock at steady state as the compressive effects are dominant (the liquid to gas density ratio is about $1,000$ and $P_{\infty,vapor}=0$). A detailed 
derivation of the exact steady-state solution when considering each phase independently can be found in \cite{nozzle_exact}. An uniform mesh of 
200 cells was used to obtain the numerical solution and the time step size was computed using an initial CFL number of one (the CFL is increased as the numerical solution approaches steady state).
This test was first introduced by Saurel et al. in \cite{Berry_NED2010} and enables us to assess the behavior of the numerical method in the low-Mach asymptotic limit.
The initial conditions are computed from the boundary conditions by assuming the two fluids at rest and linearly interpolating the pressure and temperature between the boundary values.
%
\begin{table}[H]
\begin{center}
\caption{ Stiffened Gas Equation of State (SGEOS) parameters for steam and liquid water.}
\label{tbl:stff_gas_eos-sect4}
\begin{tabular}{|c|c|c|c|c|}
 \hline
\text{fluid}                           & $\gamma$ & $C_v$ $(J.kg^{-1}.K^{-1})$ & $P_\infty$ ({\it Pa}) & $q$ $(J.kg^{-1})$ \\  \hline \hline
liquid water & 2.35     & 1816                       & $10^9$            & $-1167\ 10^3$     \\  \hline
steam          & 1.43     & 1040                       & 0                 & $ 2030\ 10^3$     \\  \hline
\end{tabular}
\end{center}
\end{table}
%
Because each phase is independent of each other, the same numerical solution could be obtained by solving the $1$-D Euler equations with variable area. Steady-state numerical solutions are presented in \fig{fig:nozzle-indep-variables} and plotted along the exact solution. The phasic viscosity coefficient profiles are given in \fig{fig:nozzle-indep-visc-coeff} for both phases.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_two_phases_pressure.eps}
                \caption{Pressure}
                \label{fig:nozzle-indep-press}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_two_phases_velocity.eps}
                \caption{Velocity}
                \label{fig:nozzle-indep-vel}
        \end{subfigure}%

        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_two_phases_temperature.eps}
                \caption{Temperature}
                \label{fig:nozzle-indep-density}
        \end{subfigure}
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_two_phases_volume_fraction.eps}
                \caption{Volume fraction}
                \label{fig:nozzle-indep-vf}
        \end{subfigure}
        \caption{Numerical steady-state solution of two independent flows in a $1$-D converging-diverging nozzle at steady state.}\label{fig:nozzle-indep-variables}
\end{figure}
%
As seen in \fig{fig:nozzle-indep-variables}, the numerical solutions perfectly match the exact solution at steady-state. The steady-state solution of the vapor phase exhibits a shock around $x=0.8 \ m$ and matches the exact solution. Once again, the volume fraction remains constant as expected since the relaxation terms are set to zero. 
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_liquid_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 1.}
                \label{fig:nozzle-indep-visc-coeff-phase-1}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_vapor_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 2}
                \label{fig:nozzle-indep-visc-coeff-phase-2}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-indep-phase_liquid_beta.eps}
                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
                \label{fig:nozzle-indep-beta}
        \end{subfigure}        
        \caption{Viscosity coefficients profiles of two independent flows in a $1$-D converging-diverging nozzle at steady state.}\label{fig:nozzle-indep-visc-coeff}
\end{figure}
%
The viscosity coefficients of the liquid phase are shown in \fig{fig:nozzle-indep-visc-coeff-phase-1} on a log-scale plot: note that the entropy viscosity coefficient is very small compared to the first-order one because 
(i) the numerical solution is smooth as shown in \fig{fig:nozzle-indep-visc-coeff-phase-1} and (ii) the flow is in a isentropic low-Mach regime (subsonic flow). 
In \fig{fig:nozzle-indep-visc-coeff-phase-2}, 
the first-order and entropy viscosity coefficients are plotted at steady state (on a log scale): the entropy viscosity 
coefficient is peaked in the shock region around $x=0.8 \ m$ where it saturates to the first-order viscosity 
coefficient denoted by the subscript $max$. Elsewhere, the entropy  viscosity coefficient is small. The viscosity coefficient profile of $\beta_e$ is given in \fig{fig:nozzle-indep-beta} and is zero as the volume fraction profile is constant. A convergence study was performed in \cite{DelchiniCompFluid2014-euler} for this particular test and showed the expected convergence rate for the L$_1$ and L$_2$ norms. \tcb{Should we add the solution obtained with FOV or just refer the reader to the other SEM paper?} \tcr{let me think of that}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Fluids in a 1-D converging-diverging nozzle with infinite relaxation terms}\label{sec:nozzle-infinite-rel-coeff}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
We still consider a two-phase flow in a $1$-D converging-diverging nozzle with the same initial conditions as in \sct{sec:nozzle-two-indep-fluids} but with large relaxation terms:  
the pressure and velocity relaxation coefficients are computed from \eqt{eq:Aint-def} and \eqt{E-R:86} with $A_{int,max} =  
10^4$ $m^{-1}$: $\mu_P \sim 4$ and $\lambda_u \sim 5 \times 10^5$ $s^{-1}$. A stagnation pressure boundary condition is set at the inlet with $P_0 = 1 \ MPa$ and $T_0 = 453 \ K$ for both phases. At the outlet, a static pressure boundary condition is used with $P_s = 0.5 \ MPa$ for both phases also. The numerical results are given in \fig{fig:nozzle-aint-1e4-variables} along with the corresponding viscosity coefficients in \fig{fig:nozzle-aint-1e4-visc-coeff}. The initial conditions are computed from the boundary conditions by assuming the two fluids at rest and linearly interpolating the pressure and temperature between the boundary values.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_two_phases_velocity.eps}
                \caption{Velocity}
                \label{fig:nozzle-aint-1e4-vel}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_two_phases_temperature.eps}
                \caption{Temperature}
                \label{fig:nozzle-aint-1e4-density}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_two_phases_pressure.eps}
                \caption{Pressure}
                \label{fig:nozzle-aint-1e4-press}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_two_phases_volume_fraction.eps}
                \caption{Volume fraction}
                \label{fig:nozzle-aint-1e4-vf}
        \end{subfigure}
        \caption{Numerical steady-state solution of a two-phase flow in a $1$-D converging-diverging nozzle with infinite relaxation coefficients.}\label{fig:nozzle-aint-1e4-variables}
\end{figure}
%
Because of the large relaxation coefficients, mechanical equilibrium is achieved between the liquid and vapor phases: the two phases have the same pressure and velocity profiles as shown in \fig{fig:nozzle-aint-1e4-variables}. 
The pressure profile is given in \fig{fig:nozzle-aint-1e4-press}. The static pressure outlet boundary holds for both phases. At the inlet, the liquid and vapor pressures are not equal since the implementation of the boundary condition does not account for the relaxation terms: the static pressure is computed from the stagnation pressure using entropy and enthalpy conservation relations. The volume fraction of both phases varies throughout the nozzle as a consequence of the pressure equilibrium. Even if the liquid and vapor phases have the same pressure and velocity profiles, the Mach numbers are still very different as shown in FIGURES: the liquid and vapor phases experience a low-Mach and transonic flows, respectively. Consequently, the scaling of the phasic viscosity coefficients and more particularly the normalization parameters will be affected as shown in \fig{fig:nozzle-aint-1e4-visc-coeff}.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_liquid_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 1.}
                \label{fig:nozzle-aint-1e4-visc-coeff-phase-1}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_vapor_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 2}
                \label{fig:nozzle-aint-1e4-visc-coeff-phase-2}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/nozzle-aint-1e4_liquid_beta.eps}
                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
                \label{fig:nozzle-aint-1e4-beta}
        \end{subfigure}        
        \caption{Viscosity coefficients profiles for a two-phase flow with large relaxation coefficients at $t=305 \ \mu s$.}\label{fig:nozzle-aint-1e4-visc-coeff}
\end{figure}
%
The phasic viscosity coefficients $\mu_k$ and $\kappa_k$ are peaked in the vicinity of the sharp variation around $x=0.8 \ m$. Lastly, the viscosity coefficient $\beta_k$ follows the variations of the volume fraction for both phases. Overall, the viscosity coefficients are large enough to prevent the formation of any numerical instability without altering the physical solution.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{1-D numerical results obtained with Relap-7}\label{sec:1d-results-relap-7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
We now present results of typical engineering problems obtained with the system code RELAP-7 \cite{Berry_2014} with the objective of testing capabilities of the Entropy Viscosity Method when computing typical reactor flows: a hydrostatic test, a two-phase flow water-hammer and a Boiling Water Reactor (BWR).
\tcb{Shoudl we add a few lines about R-7?} \tcr{earlier, see my other remark} \tcb{done}
%The numerical results were obtained with the system code RELAP-7 that implements the single- and two-phase flow models described in \sct{sct:model} using the spatial and temporal discretization techniques \sct{sec:spatial-disc} (BDF2 and linear test functions).
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{A two-phase flow water hammer test}\label{sec:water-hammer}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
A water-hammer situation is encountered in light water reactors whenever a valve closes rapidly and obstructs the flow in a pipe. In the numerical results presented in this section, each fluid is described by the Stiffened Gas equation of state with parameters taken from \tbl{tbl:stff_gas_eos-sect4} for the liquid and gas phases. 
A water hammer consists of a liquid phase flowing in a straight 1-D pipe of length $L=10 \ m$ with initial uniform pressure ($P = 7$ {\it MPa}), velocity ($u = -12$ $m/s$) and temperature ($T = 453 \ K$). At $t=0$ s, the two extremities of the 1-D pipe are closed by solid walls which causes shock and rarefaction waves to appear at the left and right extremities, respectively. The two waves initially propagate towards the middle of the pipe and are reflected on the opposite wall after crossing each other near the middle of the pipe.
The liquid and vapor phases have the same initial conditions and the liquid volume fraction is initially set to $0.5$. The two phases are in interaction through the pressure and velocity relaxation terms that are functions of the relaxation coefficients, $\mu_P$ and $\lambda_u$, computed with $A_{int} = 300$ $m^{-1}$ so that the two phases achieve pressure and velocity equilibrium at all times.
The computational domain is discretized with an uniform mesh of $200$ cells and the numerical solution is run until $t = 0.5$ s with a CFL number of $1.$ for both tests. For each test case, the phasic velocity, density and pressure profiles are provided at different times of the simulation. Plots of the velocity, the density, the pressure are given in \fig{fig:water-hammer-var}. The corresponding phasic viscosity coefficients are shown in \fig{fig:water-hammer-visc}.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/water-hammer-density-liquid.eps}
                \caption{Liquid density}
                \label{fig:water-hammer-density-liq}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/water-hammer-density-vapor.eps}
                \caption{Vapor density}
                \label{fig:water-hammer-density-vap}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/water-hammer-pressure-liquid.eps}
                \caption{Liquid pressure}
                \label{fig:water-hammer-press-liq}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/water-hammer-pressure-vapor.eps}
                \caption{Vapor pressure}
                \label{fig:water-hammer-press-vap}
        \end{subfigure}
        \caption{Numerical solution of a two-phase flow water-hammer test at $t=0.00793$, $0.03$ and $0.1$ s.}\label{fig:water-hammer-var}
\end{figure}
%
\fig{fig:water-hammer-var} show that the numerical solution of the liquid and gas phases do not display any oscillations or instabilities. 
As expected, the two fluids have the same pressure and velocity profiles as shown in \fig{fig:water-hammer-var}. The shocks coming from the left and right walls are initially well resolved and do not display any instability. In \fig{fig:water-hammer-density-liq} and \fig{fig:water-hammer-density-vap}, the density of the liquid and gas phases have different values but experience similar variations. It is also noted that the accuracy of the shock wave decreases over time: the numerical dissipation comes from the temporal integrator (time step size) and the spatial discretize element size. The accuracy of the numerical solution could be improved over time by using a finer grid with smaller time steps or a higher-order temporal integrator.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/water-hammer-viscosity-liquid.eps}
                \caption{Viscosity coefficients for liquid phase.}
                \label{fig:water-hammer-visc-liq}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/water-hammer-viscosity-vapor.eps}
                \caption{Viscosity coefficients for vapor phase}
                \label{fig:water-hammer-visc-vap}
        \end{subfigure}
        
%        \begin{subfigure}[b]{0.495\textwidth}
%                \centering
%                \includegraphics[width=\textwidth]{figures/hydrostatic-_liquid_beta.eps}
%                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
%                \label{fig:hydrostatic--beta}
%        \end{subfigure}        
        \caption{Viscosity coefficients profiles for a two-phase flow water-hammer test at $t=0.00793$ s.}\label{fig:water-hammer-visc}
\end{figure}
%
The viscosity coefficients are plotted at time $t = 8.7 \times 10^{-3}$ s and display two peaks that match the shock positions.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{A hydrostatic sedimentation test}\label{sec:}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
We now consider a sedimentation test that consists in a $1$-D vertical straight pipe of length $L=1 \ m$ (the top of the pipe is located at $x=0 \ m$) filled with a mixture of liquid water and steam. As the liquid to steam density ratio is about $1000$, the downward gravity force drives the liquid phase to the bottom of the pipe, and the steam phase to the top of the pipe. A steady-state solution is reached when all of the liquid and the steam phases are located at the bottom and the top of the pipe, respectively. The fluids are initially at rest and the phasic pressures and temperatures are uniform and equal to $P=7$ {\it MPa} and $T=517 \ K$, respectively. The volume fraction is initially set to $0.5$. The $1$-D straight pipe is discretized with an uniform mesh of $100$ cells. At $t=0 \ s$, the gravity force is turned on and the code is run until steady state is reached with an adaptive time stepping. Note that for the purpose of this test, the phasic gravity force ($F_k = \alpha_k \rho_k g$) and the gravity work ($W_{g,k}=F_k \cdot u_k$) are added to the phasic momentum (\eqt{eq:multi-7-eqn-mom}) and the energy equations (\eqt{eq:multi-7-eqn-energy}), respectively, where $g=-9.8 \ m / s^{-2}$. Numerical steady-state solutions are presented in \fig{fig:hydrostatic--variables} along with the viscosity coefficients profiles in \fig{fig:hydrostatic--visc-coeff}. Note that the exact steady-state solution consists of two fluids at rest with a volume fraction step going from one to zero: the phasic steady-state pressure profiles are solution of the non-linear equation $\grad P_k = F_k$. 
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_two_phases_velocity.eps}
                \caption{Velocity}
                \label{fig:hydrostatic--vel}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_two_phases_temperature.eps}
                \caption{Temperature}
                \label{fig:hydrostatic--density}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_two_phases_pressure.eps}
                \caption{Pressure}
                \label{fig:hydrostatic--press}
        \end{subfigure}        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_two_phases_volume_fraction.eps}
                \caption{Volume fraction}
                \label{fig:hydrostatic--vf}
        \end{subfigure}
        \caption{Numerical steady-state solution of the sedimentation test.}\label{fig:hydrostatic--variables}
\end{figure}
%
The numerical steady-state solutions presented in \fig{fig:hydrostatic--variables} do not display any instability. The phasic volume fraction experiences a steady-state discontinuity at $x=0.5 \ m$ that corresponds to the phase separation between the liquid (in the top) and the steam (in the bottom). The phasic pressure variations shown in \fig{fig:hydrostatic--press} are consistent with the gravity force: the pressure decreases through the pipe in an almost linearly fashion as the phasic density variations are weak (the phasic temperature profiles are very small as shown in \fig{fig:hydrostatic--density}). The phasic velocity profiles display a peak around $x=0.5 \ m$ and is very small anywhere else : it was observed that the peak amplitudes decrease as approaching steady-state solution.
%
\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_liquid_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 1.}
                \label{fig:hydrostatic--visc-coeff-phase-1}
        \end{subfigure}%
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_vapor_viscosity_kappa_mu.eps}
                \caption{Viscosity coefficients for phase 2}
                \label{fig:hydrostatic--visc-coeff-phase-2}
        \end{subfigure}
        
        \begin{subfigure}[b]{0.495\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figures/hydrostatic-_liquid_beta.eps}
                \caption{Viscosity coefficients for the volume fraction equation of phase 1.}
                \label{fig:hydrostatic--beta}
        \end{subfigure}        
        \caption{Steady-state viscosity coefficients profiles for the hydrostatic pressure test.}\label{fig:hydrostatic--visc-coeff}
\end{figure}
%
The phasic viscosity coefficients $\mu_k$ and $\kappa_k$ are very small compare to the first-order viscosity coefficients denoted by the subscript $max$: the entropy production is very small as the phasic pressure, velocity and temperature profiles are smooth as observed in \fig{fig:hydrostatic--variables}. The phasic viscosity coefficient for the volume fraction equation are shown in \fig{fig:hydrostatic--beta} and are peaked around $x=0.5 \ m$ at the location of the discontinuity seen in the volume fraction profile in \fig{fig:hydrostatic--vf}.
\tcb{Do we need to add plots of the transient solution?}  \tcr{do they look good????}\tcb{I think they look ok}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Steady-state numerical solution of a Water Boiling Reactor (BWR)}\label{sec:bwr}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\tcr{status???} \tcb{still working on it}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions and future work}\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\tcr{not read yet but looks too short} \tcb{done}

%We have derived a viscous regularization for the hyperbolic Seven-Equation two-phase flow Model. The regularization ensures positivity of the entropy residual, 
%uniqueness of the numerical solution for concave physical phasic entropy functions $s_k$, and is consistent with the viscous regularization derived for 
%Euler equations when one of the phases disappears. 
%We have also demonstrated that the proposed viscous regularization is compatible with the generalized Harten entropies that were initially derived for Euler equations. 
%
%The viscous regularization for the SEM equations involves a set of two positive viscosity coefficients for each phase, $\mu_k$ and $\kappa_k$, and one for the volume 
%fraction equation, $\beta_k$. The scaling of these viscosities is related to the numerical Reynolds and P\'eclet numbers, $\Re_k$, $\Pe_k^\mu$, and $\Pe_k^\kappa$. 
%Adequate scaling of these numbers has been devised for two important limit-cases: the low-Mach asymptotic limit and for non-isentropic flows. In the low-Mach regime, 
%we show that the incompressible equations are recovered when assuming that all of the non-dimensional numbers scale as one. The study of the non-isentropic case 
%shows that the scaling of the non-dimensionalized numbers is Mach-number dependent to ensure well-scaled dissipative terms in the vicinity of the shock.
%Based on these results, adequate scaling of the viscosities can be derived for all Mach numbers, as was the case for single-phase flows \cite{DelchiniCompFluid2014-euler}. 
%%
%We have also shown that the regularized SEM equations yields a regularized version of the five-equation flow model of Kapila by means of a Chapman-Enskog expansion.
%
%The ability of the proposed regularization to stabilize the SEM equations was numerically demonstrated using a shock tube problem, with the definitions of the 
%artificial viscosity coefficients borrowed from the local Lax-Friedrichs scheme. We have also analyzed the effect of removing stabilization from the volume fraction 
%and the continuity equations. The scaling effect of the viscous regularization on the numerical solution in the low-Mach asymptotic limit was numerically illustrated using a 1-D converging-diverging nozzle.
%
%As an extension of this work, the two-phase flow viscous regularization presented here should be utilized and tested with high-order, less dissipative, artificial viscosities, 
%such as the entropy viscosity (e.g., see \cite{GuermondJCP2011} for single-phase supersonic flows and \cite{DelchiniCompFluid2014-euler} for single-phase subsonic and transonic flows). 
%We also note that the proposed regularization can also be employed using definitions of viscosity coefficients traditionally used in single-phase flows, e.g., 
%the Lapidus viscosity \cite{Lapidus_paper,Lapidus_book} and pressure-based viscosity, for two-phase flows \cite{PBV_book}. We intend on reporting on these findings in 
%a subsequent publication.
%
The Entropy Viscosity Method was extended to the compressible Seven-Equation Model with variable area and was designed to be valid for a 
wide range of Mach numbers. The definition of the phasic viscosity coefficients were derived by considering the limit cases of low-Mach isentropic flows and non-isentropic flows that can develop shock waves. The numerical method is therefore applicable to a large variety of flow regime, from very low-Mach flows to supersonic flows. The definitions of the phasic viscosity coefficients are also consistent with the single-phase viscosity coefficients derived in \cite{DelchiniCompFluid2014-euler} when the Seven-Equation Model devolves to the single-phase Euler equations.

The effectiveness of the numerical method was demonstrated in 1-D with an in-house Moose based application and the system code RELAP-7 developed by the Idaho National Laboratory. Using the in-house Moose-based application, the method was first tested on various shock tubes for independent and fully coupled two-phase flows. For tests with shocks and when an exact solution was available, the rate of convergences of the $L_1$ and $L_2$ norms were computed and found equal to 1 and $1/2$, respectively, which demonstrates convergence of the numerical solution to the exact solution.

Using the Entropy Viscosity Method, more advanced tests were also performed with the system code RELAP-7 including sedimentation flow, two-phase water hammer and two-phase flow of a Boiling Water Reactor. In each test, the phasic viscosity coefficients behaved as expected and efficiently stabilized the numerical solution. 

In the future, we plan to test the Entropy Viscosity Method with the multi-dimensional compressible Seven-Equation Model. Note that the definitions of the phasic viscosity coefficients remain unchanged. It will, however, require a preconditioner to ensure quick convergence of the solver as an implicit temporal integrator is used. 
%does not require an analytical expression and is therefore applicable to a larger variety of flow regimes, from very 
%low-Mach flows to supersonic flows.
%It was demonstrated that the viscous regularization did not create any artificial waves when simulating independent two-phase flows.
%Convergence of the numerical solution to the exact solution was demonstrated by computing the convergence rates of the L$_1$ and L$_2$ norms 
%for $1$-D shock tube flows in straight pipes. The method was tested on various $1$-D tests obtained with Moose-based applications including a in-house code and the system code RELAP-7. The numerical method is capable of handling engineering tests such as seidmentation and water-hammer tests.
%For smooth solutions, second-order 
%convergence was verified; solutions with shocks converged with the expected theoretical rates of 1 (L$_1$-norm)
%and 1/2 (L$_2$-norm).

%The effectiveness of the method was also demonstrated in 2-D using a series of benchmark problems
%for both subsonic and supersonic flows in various geometries, with Mach numbers ranging from $10^{-7}$ to 
%2.5. For very low-Mach flows, we numerically verified that the steady-state pressure variations were proportional to 
%the square of the Mach number, as expected in the incompressible limit. A convergence study was carried out for a
%2D supersonic compression corner test case and rates of convergence of 1 (L$_1$-norm) and 1/2 (L$_2$-norm) were observed.

%In the future, we plan to further apply the Entropy Viscosity Method 
%to the multi-dimensional Seven-Equation two-phase flow Model \cite{Berry_NED2010}. 
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{mybibfile}
\end{document}