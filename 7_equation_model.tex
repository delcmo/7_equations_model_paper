%%
%% This is file `elsarticle-template-num.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% elsarticle.dtx  (with options: `numtemplate')
%% 
%% Copyright 2007, 2008 Elsevier Ltd.
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% -------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01

%\documentclass[preprint,12pt]{elsarticle}
\documentclass[preprint,10pt]{elsarticle}
%\documentclass[final,3p,times]{elsarticle} 

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
\usepackage{float}
\usepackage{color}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[titletoc,title]{appendix}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
%% \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols 
%% The amsthm package provides extended theorem environments
\usepackage{amssymb}
\usepackage{amsmath}
% more math
\usepackage{amsfonts}
\usepackage{amstext}
\usepackage{amsbsy}
\usepackage{mathbbol} 
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
\usepackage{lineno}

\journal{Journal of Comp. Phys.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% operators
\renewcommand{\div}{\mbold{\nabla}\! \cdot \!}
\newcommand{\grad}{\mbold{\nabla}}
\newcommand{\divv}[1]{\boldsymbol{\nabla}^{#1}\! \cdot \!}
\newcommand{\gradd}[1]{\mbold{\nabla}^{#1}}
\newcommand{\mbold}[1]{\boldsymbol#1}
% latex shortcuts
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bal}{\begin{align}}
\newcommand{\eali}{\end{align}}
\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\ben}{\begin{enumerate}}
\newcommand{\een}{\end{enumerate}}
\usepackage{amsthm}
\newtheorem*{remark}{Remark}
% DGFEM commands
\newcommand{\jmp}[1]{[\![#1]\!]}                     % jump
\newcommand{\mvl}[1]{\{\!\!\{#1\}\!\!\}}             % mean value
\newcommand{\keff}{\ensuremath{k_{\textit{eff}}}\xspace}
% shortcut for domain notation
\newcommand{\D}{\mathcal{D}}
% vector shortcuts
\newcommand{\vo}{\mbold{\Omega}}
\newcommand{\vr}{\mbold{r}}
\newcommand{\vn}{\mbold{n}}
\newcommand{\vnk}{\mbold{\mathbf{n}}}
\newcommand{\vj}{\mbold{J}}
\newcommand{\eig}[1]{\| #1 \|_2}
%
\newcommand{\EI}{\mathcal{E}_h^i}
\newcommand{\ED}{\mathcal{E}_h^{\partial \D^d}}
\newcommand{\EN}{\mathcal{E}_h^{\partial \D^n}}
\newcommand{\ER}{\mathcal{E}_h^{\partial \D^r}}
\newcommand{\reg}{\textit{reg}}
%
\newcommand{\norm}{\textrm{norm}}
\renewcommand{\Re}{\textrm{Re}}
\newcommand{\Pe}{\textrm{P\'e}}
\renewcommand{\Pr}{\textrm{Pr}}
%
\newcommand{\resi}{R}
%\newcommand{\resinew}{\tilde{D}_e}
\newcommand{\resinew}{\widetilde{\resi}}
\newcommand{\resisource}{\widetilde{\resi}^{source}}
\newcommand{\matder}[1]{\frac{\textrm{D} #1}{\textrm{D} t}}
%
% extra space
\newcommand{\qq}{\quad\quad}
% common reference commands
\newcommand{\eqt}[1]{Eq.~(\ref{#1})}                     % equation
\newcommand{\fig}[1]{Fig.~\ref{#1}}                      % figure
\newcommand{\tbl}[1]{Table~\ref{#1}}                     % table
\newcommand{\sct}[1]{Section~\ref{#1}}                   % section
\newcommand{\app}[1]{Appendix~\ref{#1}}                   % appendix
%
\newcommand{\ie}{i.e.,\@\xspace}
\newcommand{\eg}{e.g.,\@\xspace}
\newcommand{\psc}[1]{{\sc {#1}}}
\newcommand{\rs}{\psc{R7}\xspace}
%
\newcommand\br{\mathbf{r}}
%\newcommand{\tf}{\varphi}
\newcommand{\tf}{b}
%
\newcommand{\tcr}[1]{\textcolor{red}{#1}}
\newcommand{\tcb}[1]{\textcolor{blue}{#1}}
\newcommand{\mt}[1]{\marginpar{ {\tiny #1}}}
%
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   BEGIN DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%\title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}
%-------------------------
%-------------------------
\title{Extension of the entropy viscosity method to the multi-D 7-equation two-phase flow model.\\
\tcb{I do not know if we should have 'multi-D' in the title since we will only present $1$-D results}}
%-------------------------
%-------------------------
\author{Marc O. Delchini\fnref{label1}}
\ead{delchmo@tamu.edu}

\author{Jean C. Ragusa\corref{cor1}\fnref{label1}}
\ead{jean.ragusa@tamu.edu}

\author{Ray A. Berry\fnref{label2}}
\ead{ray.berry@inl.gov}

\address[label1]{Department of Nuclear Engineering, Texas A\&M University, College Station, TX 77843, USA \fnref{label1}}

\address[label2]{Idaho National Laboratory, Idaho Falls, ID 83415, USA \fnref{label2}}

\cortext[cor1]{Corresponding author}
%-------------------------
%-------------------------
%-------------------------
\begin{abstract}
blabla
\end{abstract}
%-------------------------
%-------------------------
\begin{keyword}
  two-phase flow model \sep with variable area \sep entropy viscosity method \sep stabilization method \sep low Mach regime \sep shocks.
\end{keyword}
%-------------------------
\end{frontmatter}
\linenumbers
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{sec:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{itemize}
\item a few lines about the need for accurately resolving two-phase flows
\item background on the different two-phase flow models: 5, 6 and 7-equation two-phase flow models
\item then, focus on the different types of 7-equation two-phase flow models: they mostly differ because of the closure relaxations used
\item discuss the different numerical solvers developed for the 7-equation two-phase flow model: HLL, HLLC, and approximated Riemann solvers accounting for the source terms
\item emphasize the fact that the above numerical solvers only works on discontinuous schemes
\item then, introduce the entropy viscosity method and details the organization of the paper 
\end{itemize}
%
Compressible two-phase flows are found in numerous industrial applications and are an ongoing area of research in modeling and simulation over many years. A variety of models with different levels of complexity has been developed such as: five-equation model \cite{Kapila_2001}, six-equation model \cite{Toumi_1996}, and more recently the seven-equation model \cite{SEM}. These models are all obtained by integrating the single-phase flow balance equations weighed by a characteristic or indicator function for each phase. The resulting system of equations contains non-conservative terms that describe the interaction between phases but also an equation for the volume fraction. Once a system of equations describing the physics is derived, the next challenging step is to develop a robust and accurate discretization to obtain a numerical solution. Assuming that the system of equations is hyperbolic under some conditions, a Riemann solver could be used but is often ruled out because of the complexity due to the number of equations involved. Furthermore, careless approximation for the treatment of the non-conservative terms can lead to failure in computing the numerical solution \cite{Abgrall_2002}. An alternative is to use an approximate Riemann solver, a well-established approach for single-phase flows, while deriving a consistent discretization scheme for the non-conservative terms. 

This methodology was applied to the seven-equation model (SEM) introduced by Berry et al. in \cite{SEM}. This model is known to be unconditionally hyperbolic which is highly desirable when working with approximate Riemann solvers and can treat a wide range of applications. Its particularity comes from the pressure and velocity relaxation terms in the volume fraction, momentum and energy equations that can bring the two phases in equilibrium when using large values of the relaxation parameters. In other words, the seven-equation model can degenerate into the six- and five-equation models. Alike for the other two-phase flow models, solving for the seven-equation model requires a numerical solver and significant effort was dedicated to this task for spatially discontinuous schemes. Because each phase is assumed to obey the Euler equations, most of the numerical solvers are adapted from the single-phase approximate Riemann solvers. For example, Saurel et al. \cite{Saurel_2001a, Saurel_2001b} employed a HLL-type scheme to solve for the SEM but noted that excessive dissipation was added to the contact discontinuity. A more advanced HLLC-type scheme was developed in \cite{Li_2004} but only for the subsonic case and then extended to supersonic flows in \cite{Zein_2010}. More recently, Ambroso et al. \cite{Ambroso_2012} proposed an approximate Riemann solver accounting for source terms such as gravity and drag forces, but with no interphase mass transfer.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The multi-D 7-equation two-phase flow model}\label{sec:7-equ-model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{itemize}
%\item give the equations and detail the different terms
%\item include the relaxation terms, the mass and heat exchange terms
%\item eigenvalues
%\item entropy equation WITHOUT the dissipative terms and five the details of the derivation in the appendix
%\end{itemize}
%
The multi-D seven-equation two-phase model presented in this paper is obtained by assuming that each phase obeys the single-phase Euler equations (with phase-exchange terms) and by integrating over a control volume after multiplying by a characteristic function. The detailed derivation can be found in \cite{SEM}. In this section, the governing multi-dimensional equations are recalled for a phase $k$ in interaction with a phase $j$. Each phase obeys the following mass, momentum and energy balance equations, supplemented by a non-conservative volume-fraction equation:
%
\begin{subequations}\label{eq:liq-7-eqn-sect5}
\begin{align}
  % liquid mass conservation
  \label{multi-d-7-equ-liq}
  \frac{\partial \left( \alpha \rho \right)_{k} A}{\partial t}
  + \div \left( \alpha \rho \mbold u A\right)_{k}
  &= - \Gamma A_{int} A
\end{align}
\begin{align}
  % liquid momentum
  \frac{\partial \left( \alpha \rho \mbold u \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} A \left( \rho \mbold u \otimes \mbold u + P \mathbb{I} \right)_{k} \right]
  &= P_{int} A \grad \alpha_{k} + P_{k} \alpha_{k} \grad A
    \nonumber
  \\
  &+ A \lambda_u (\mbold u_{j} - \mbold u_{k})
  - \Gamma A_{int} \mbold u_{int} A
\end{align}
\begin{align}
  % liquid total energy
  \frac{\partial \left( \alpha \rho E \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} \mbold u_{k} A \left( \rho E + P \right)_{k} \right]
  &= P_{int} \mbold u_{int} A \grad \alpha_{k} - \bar{P}_{int} A \mu_P (P_{k} - P_{j})
        \nonumber
  \\
  + \bar{\mbold u}_{int} A \lambda_u (\mbold u_{j} - \mbold u_{k})
&  + \Gamma A_{int} \left( \frac{P_{int}}{\rho_{int}} - H_{k, int} \right) A
%\nonumber 
%\\
%& + Q_{wall,k} + Q_{int,k}
\end{align}
\begin{align}
  % liquid volume fraction
  \label{eqn:multi-d-7-eqn-liq-vol}
  \frac{\partial \alpha_{k} A}{\partial t} + A\mbold u_{int} \cdot \grad \alpha_{k}
  &= A \mu_P (P_{k} - P_{j}) - \frac{\Gamma A_{int} A}{\rho_{int}}
\end{align}
\end{subequations}
%
%On the same model, the equations for the vapor phase are:
%%
%\begin{subequations}\label{eq:vap-7-eqn-sect5}
%\begin{align}
%  \label{multi-d-7-equ-vap}
%  % vapor mass conservation
%  \frac{\partial \left( \alpha \rho A\right)_{vap}}{\partial t}
%  + \div \left( \alpha \rho \mbold u \right)_{vap} A
%  =  \Gamma A_{int} A
%\end{align}
%\begin{align}
%  % vapor momentum
%  \frac{\partial \left( \alpha \rho u \right)_{vap} A}{\partial t}
%  + \div \left[ \alpha_{vap} A \left( \rho \mbold u \otimes \mbold u + P\mathbb{I} \right)_{vap} \right]
%  &= P_{int} A \grad \alpha_{vap} + P_{vap} \alpha_{vap} \grad A
%  \\
%  \nonumber
%  &+ A \lambda_u (\mbold u_{liq} - \mbold u_{vap})
%  + \Gamma A_{int} u_{int} A
%\end{align}
%\begin{align}
%  % vapor total energy
%  \frac{\partial \left( \alpha \rho E \right)_{vap} A}{\partial t}
%  + \div \left[ \alpha_{vap} \mbold u_{vap} A \left( \rho E + P \right)_{vap} \right]
%  &= P_{int} \mbold u_{int} A \grad \alpha_{vap} - \bar{P}_{int} A \mu_P (P_{vap} - P_{liq})
%    \nonumber
%  \\
%  + \bar{\mbold u}_{int} A \lambda_u (\mbold u_{liq} - \mbold u_{vap})
%&- \Gamma A_{int} \left( \frac{P_{int}}{\rho_{int}} - H_{vap, int} \right) A
%\nonumber 
%\\
%& + Q_{wall,vap} + Q_{int,vap}
%\end{align}
%\begin{align}
%  % vapor phase volume fraction
%  \label{eqn:multi-d-7-eqn-vap-vol}
%  \frac{\partial \alpha_{vap} A}{\partial t} + A \mbold u_{int} \cdot \grad \alpha_{vap}
%  &= A \mu_P (P_{vap} - P_{liq}) + \frac{\Gamma A_{int} A}{\rho_{int}}
%\end{align}
%\end{subequations}
%
where $\alpha_k$, $\rho_k$, $\mbold u_k$ and $E_k$ denote the volume fraction, the density, the velocity vector and the total specific energy of phase $k$, respectively. The phase pressure $P_k$ is computed from an equation of state. The interfacial pressure and velocity and their corresponding average values are denoted by $P_{int}$, $\mbold u_{int}$, $\bar{P}_{int}$ and $\bar{\mbold u}_{int}$, respectively, and are defined in \eqt{eq:int_variables_def}. 
%
\begin{subequations}
\label{eq:int_variables_def}
\begin{align}
  \label{E-R:83}
  P_{int} &= \bar{P}_{int} + \frac{Z_{k}Z_{j}}{Z_{k}+Z_{j}} \frac{\grad \alpha_{k}}{|| \grad \alpha_{k} ||} \cdot (\mbold u_{j}-\mbold u_{k})
  \\
  \bar{P}_{int} &= \frac{Z_{j}P_{k}+Z_{k}P_{j}}{Z_{k}+Z_{j}}
 \\
  \label{E-R:84}
  \mbold u_{int} &= \bar{\mbold u}_{int} +  \frac{\grad \alpha_{k}}{|| \grad \alpha_{k} ||} \frac{P_{j}-P_{k}}{Z_{k}+Z_{j}}
  \\
  \bar{\mbold u}_{int} &= \frac{Z_{k} \mbold u_{k}+Z_{j}\mbold u_{j}}{Z_{k}+Z_{j}}.
\end{align}
\end{subequations}
%
The interfacial specific total enthalpy of phase $k$, $H_{k}$, is defined as follows: $H_k = h_k + 0.5 || \mbold u ||^2$. Following \cite{SEM}, the pressure and velocity relaxation coefficients, $\mu_P$  and $\lambda_u$ respectively, are function of the acoustic impedance $Z_k = \rho_k c_k$ and the specific interfacial area $A_{int}$ as shown in \eqt{eq:relaxation_coeff}.
%
\begin{subequations}
\label{eq:relaxation_coeff}
\begin{align}
  \label{E-R:85}
  \lambda_u &= \frac{1}{2} \mu_P Z_{k} Z_{j}
  \\
  \label{E-R:86}
  \mu_P &= \frac{A_{int}}{Z_{k}+Z_{j}}
\end{align}
\end{subequations}
%
The specific interfacial area (i.e., the interfacial surface area per unit
volume of two-phase mixture), $A_{int}$, must be specified from some type of
flow regime map or function under the form of a correlation. In \cite{SEM}, $A_{int}$ is chosen to be a function of the liquid volume fraction:
%
\begin{equation}\label{eq:Aint-sect4}
A_{int} = A_{int}^{max} \left[ 6.75 \left(1-\alpha_{k} \right)^2 \alpha_{k} \right],
\end{equation}
% 
where $A_{int}^{max} = 5100$ $m^2 / m^3$. With such definition, the interfacial area is zero in the limits $\alpha_{k} = 0$ and $\alpha_{k} = 1$. Lastly, $\Gamma$ is the net mass transfer rate per unit interfacial area from phase $j$ to phase $k$. Its expression, given in \eqt{eq:mass_transfer}, is obtained by considering a vaporization/condensation process that is dominated by heat diffusion at the interface \cite{SEM, BerryMarco_2014}:
%
\begin{align} \label{eq:mass_transfer}
  \nonumber
  \Gamma = \Gamma_{j}
  &= \frac{h_{T,  k} \left( T_{k} - T_{int} \right) + h_{T,  j} \left( T_{j} - T_{int} \right)}{h_{j,  int} - h_{k,  int}}
  \\
  &= \frac{h_{T,  k} \left( T_{k} - T_{int} \right) + h_{T,  j} \left( T_{j} - T_{int} \right)}{L_v \left( T_{int} \right)} ,
\end{align}
%
where $L_v \left( T_{int} \right) = h_{j,  int} - h_{k,  int}$
represents the latent heat of vaporization.  The interface
temperature is determined by the saturation constraint
$T_{int}=T_{sat}(P)$ with the appropriate pressure $P=\bar{P}_{int}$
determined above. The interfacial heat transfer coefficients for phases $k$ and $j$ are denoted by $h_{T,  k}$ and $h_{T,  j}$, respectively, and computed from correlations \cite{SEM}. 

The set of equations obeyed by phase $j$ are simply obtained by substituting $k$ by $j$ and $j$ by $k$ in \eqt{eq:liq-7-eqn-sect5}, keeping the same definition of the interfacial variables and remembering that $\Gamma_j = - \Gamma_k$. In the case of two-phase flows, the equation for the volume fraction of phase $j$ is simply replaced by the algebraic relation
%
\begin{align}
 \alpha_{j}= 1 - \alpha_{k}, \nonumber
\end{align}
%
which reduces the number of equations from eight to seven and yields the seven-equation two-phase flow model. 

The seven-equation model has interesting properties that are discussed next. A set of seven waves is present in such a model: two acoustic waves and a contact wave for each phase supplanted by a volume fraction wave propagating at the interfacial velocity $\mbold u_{int}$. Considering a domain of dimension $\mathbb{D}$, the corresponding eigenvalues are the following for each phase $k$:
% 
\begin{align}\label{eq:eigenvalues}
&\lambda_1 = \mbold u_{int} \cdot \bar{\mbold n} \nonumber\\
&\lambda_{2,k} = \mbold u_k \cdot \bar{\mbold n} - c_k \nonumber\\
&\lambda_{3,k} = \mbold u_k \cdot \bar{\mbold n} + c_k \\
&\lambda_{d+3,k} = \mbold u_k \cdot \bar{\mbold n} \text{ for } d = 1 \dots \mathbb{D},\nonumber
\end{align}
%
where $\bar{\mbold n}$ is an unit vector pointing to a given direction. The eigenvalues given in \eqt{eq:eigenvalues} are unconditionally real which presents an interesting property for the development of numerical methods since the system is hyperbolic and well-posed. To relax the seven-equation model to
the ill-posed classical six-equation model, only the pressures should be
relaxed toward a single pressure for both phases.  This is
accomplished by specifying the pressure relaxation coefficient to be
very large, i.e., letting it approach infinity.  But if the pressure
relaxation coefficient goes to infinity, so does the velocity
relaxation rate also approach infinity.  This then relaxes the
seven-equation model not to the classical six-equation model but to the
mechanical equilibrium five-equation model of Kapila \cite{Kapila_2001}.  This reduced
five-equation model is also hyperbolic and well-posed. The five-equation
model provides a very useful starting point for constructing
multi-dimensional interface resolving methods which dynamically
captures evolving and spontaneously generated
interfaces~\cite{Saurel_2009}. Thus the seven-equation model
can be relaxed locally to couple seamlessly with such a
multi-dimensional, interface resolving code. Numerically, the mechanical relaxation coefficients $\mu_P$
(pressure) and $\lambda_u$ (velocity) can be relaxed independently to
yield solutions to useful, reduced models.  It
is noted, however, that relaxation of pressure only by making $\mu_P$
large without relaxing velocity will indeed give ill-posed and
unstable numerical solutions, just as the classical six-equation
two-phase model does, with sufficiently fine spatial resolution, as
confirmed in~\cite{SEM,Herrard_2005}. For each phase $k$, an entropy equation can be derived when accounting only for the pressure and velocity relaxation terms (all of the terms proportional to the net mass transfer term $\Gamma$ are removed). The entropy function for a phase $k$ is denoted by $s_k$ and function of the density $\rho_k$ and the internal energy $e_k$. The derivation is detailed in \app{app:sev-equ-model-entropy} and only the final result is recalled here:
%
\begin{align}\label{eq:ent-eqn-7-eqn-model}
(s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} &= \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2 + \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j -\mbold  u_k)^2 \nonumber
\\
& \frac{Z_k}{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)+\frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)\right]^2.
\end{align}
The partial derivative of the entropy function $s_k$ with respect to the internal energy $e_k$, $(s_e)_k$, is shown to be proportional to the inverse of the temperature of phase $k$, alike for the single phase Euler equations \cite{jlg, Marco_dissertation}. The right hand-side of \eqt{eq:ent-eqn-7-eqn-model} is unconditionally positive since all terms are squared and thus, is used to demonstrate the entropy minimum principle and derive the dissipative terms. Furthermore, \eqt{eq:ent-eqn-7-eqn-model} is valid for both phases $\left\{k, j\right\}$ and ensures positivity of the total entropy equation that is obtained by summing over the phases:
%
\begin{equation}\label{eq:tot-ent-res-sct4}
\sum_k (s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} = \sum_k (s_{e})_k^{-1} \alpha_k \rho_k A \left( \partial_t s_k + \mbold u_k \cdot \grad s_k \right) \geq 0  .
\end{equation}
%
Note that when one phase disappears, \eqt{eq:tot-ent-res-sct4} degenerates into the single phase entropy equation \cite{SEM, Marco_dissertation}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A viscous regularization for the multi-D seven-equation two-phase flow model}\label{sec:visc-regu}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{itemize}
%\item explain why we work with the phase entropy equation instead of considering the total entropy residual by summing over the two phases
%\item viscous regularization must be consistent with single-phase flow equation
%\item recall the notion of entropy condition and entropy inequality $\to$ require dissipative terms in order to get a sign
%\item give the system of equations with the dissipative terms
%\item guide the reader through the derivation of the dissipative terms
%\item give the entropy residual with all terms in the right hand-side
%\item make the link with the single-phase flow equations
%\item explain how to derive the dissipative term for the volume fraction equation
%\item emphasizes the fact that the regularization is valid for any EOS with convex entropy
%\item a few words about the parabolic regularization
%\end{itemize}
%
We now propose to derive a viscous regularization for the seven-equation model given in \eqt{eq:liq-7-eqn-sect5} by using the same methodology as for the multi-D Euler equations with/without variable area \cite{jlg, Marco_paper_low_mach}. The method consists in adding perturbation terms to the system of equation under consideration, and re-derive the entropy equation whose sign is known to be positive to ensure uniqueness of the numerical solution \cite{Leveque}. Because of the addition of perturbation terms, the entropy equation is modified and contains extra terms of unknown sign. By carefully choosing a definition for each of the perturbation term, the sign of the entropy equation can be determined and proved positive. For the seven-equation model, derivation of a viscous regularization can be achieved by considering either the phasic entropy equation (\eqt{eq:ent-eqn-7-eqn-model}) or the total entropy equation (\eqt{eq:tot-ent-res-sct4}). In the later case, the entropy minimum principle is verified for the whole system which may not ensure positivity of the entropy equation for each phase. However, positivity of the total entropy equation can be also achieved by assuming that the entropy minimum principle holds for each phase. This stronger requirement will also ensure consistency with the single phase Euler equations when one of the phase disappears in the limits $\alpha_k \to 0$ and $\alpha_k \to 1$. Thus, it is chosen to work with the phasic entropy equations.

For the purpose of this section, the system of equations given in \eqt{eq:sev_equ} is considered which is obtained by simply omitting the mass source terms (terms proportional to $\Gamma$) in \eqt{eq:liq-7-eqn-sect5}.
%
\begin{subequations}\label{eq:sev_equ}
\begin{align}
\partial_t \left( \alpha_k  A\right) + A \mbold u_{int} \cdot \grad \alpha_k = A \mu_P \left( P_k - P_j \right)
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = 0
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k &+ A \lambda_u \left( \mbold u_j - \mbold u_k \right)
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &=\nonumber\\
A P_{int} \mbold u_{int} \cdot \grad \alpha_k - \mu_P \bar{P}_{int} \left( P_k-P_j \right) &+ A \lambda_u \bar{\mbold u}_{int} \cdot \left( \mbold u_j - \mbold u_k \right)
\end{align}
\end{subequations}
%
%where $\rho_k$, $u_k$, $E_k$ and $P_k$ are the density, the velocity, the specific total energy and the pressure of $k^{th}$ phase, respectively. The pressure and velocity relaxation parameters are denoted by $\mu$ and $\lambda$, respectively. The variables with index $_I$ correspond to the interfacial variables and a definition for those can be found in \cite{SEM}. The cross-section $A$ is only function of space: $\partial_t A = 0$.
In order to apply the entropy viscosity method, perturbation terms are added to each equation of \eqt{eq:sev_equ}, which yields:
%
\begin{subequations}\label{eq:sev_equ-with-diss-terms}
\begin{align}\label{eq:sev_equ-with-diss-terms-vf}
\partial_t \left( \alpha_k  A\right) + \mbold u_{int} A \grad \alpha_k = A \mu_P \left( P_k - P_j \right) + \div \mbold l_k
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-cont}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = \div \mbold f_k
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-mom}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k &+ A \lambda_u \left( \mbold u_j - \mbold u_k \right) + \div \mbold g_k
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-ener}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &= \nonumber \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k -
\mu_P \bar{P}_{int} \left( P_k-P_j \right) &+ 
A \lambda_u \bar{\mbold u}_{int} \cdot \left( \mbold u_j - \mbold u_k \right) \nonumber \\
&+ \div \left( \mbold h_k + \mbold u \cdot \mbold g_k \right)
\end{align}
\end{subequations}
%
where $\mbold f_k$, $\mbold g_k$, $\mbold h_k$ and $\mbold l_k$ are the phasic perturbation terms. The next step consists in deriving the entropy equation for the phase $k$, on the same model as what is done in \app{app:sev-equ-model-entropy} for the system of equations (\eqt{eq:sev_equ}) that does not contain the perturbation terms.
%
\begin{enumerate}
\item derive the density and internal energy equations from \eqt{eq:sev_equ-with-diss-terms}.
\item assuming that the phasic entropy, $s_k$, is function of the density, $\rho_k$ and the internal energy, $e_k$, derive the entropy equation by using the chain rule:
\begin{equation}
\label{eq:chain_rule-sct4}
\frac{Ds_k}{Dt} = \left( s_{\rho} \right)_k \frac{D \rho_k}{Dt} + \left( s_{e} \right)_k \frac{D e_k}{Dt} 
\end{equation}
where $\frac{D \cdot}{Dt}$ is the material derivative. The terms $(s_e)_k$ and $(s_{\rho})_k$ denote the partial derivative of the entropy $s_k$ with respect to $e_k$ and $\rho_k$, respectively.
\item isolate the terms of interest and choose an appropriate expression for each of the perturbation terms in order to ensure positivity of the right-hand side.
\end{enumerate}
%
We first derive the density equation for the primitive variable $\rho_k$ by combining \eqt{eq:sev_equ-with-diss-terms-vf} and \eqt{eq:sev_equ-with-diss-terms-cont} to obtain:
%
\begin{equation}\label{eq:rho-7-eqn-model-sect4}
\alpha_k A \left[ \partial_t \rho_k + \left( \mbold u_k - \underline{\underline{\mbold u_{int}}} \right) \cdot \grad \rho_k \right] = \underline{\underline{A \rho_k \mu_P \left( P_k - P_j \right)}} + \div \mbold f_k - \rho_k \div \mbold l_k
\end{equation}
%
In order to derive the internal energy equation, the velocity equation is obtained by subtracting the density equation from the momentum equation:
%
\begin{align}\label{eq:vel-7-eqn-model-sect4}
\alpha_k \rho_k  A \left[ \partial_t \mbold u_k + \mbold u_k \cdot \div \mbold u_k \right]  + \div \left( \alpha_k \rho_k A P_k \mathbb{I} \right) &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k + A \lambda \left( \mbold u_j - \mbold u_k \right) &+ \div \mbold g_k - \mbold u_k \otimes \mbold f_k
\end{align}
%
After multiplying \eqt{eq:vel-7-eqn-model-sect4} by the velocity vector $\mbold u_k$, the resulting kinetic energy equation is subtracted from the total energy equation to obtain the internal energy equation for phase $k$:
%
\begin{align}\label{eq:int-ener-7-eqn-model-sect4}
\alpha_k \rho_k  A \left[ \partial_t \mbold e_k + \mbold u_k \cdot \div \mbold e_k \right]  &+ \alpha_k \rho_k A P_k \grad \mbold u_k =\nonumber\\
&\underline{\underline{P_{int} A \left(\mbold u_{int}-\mbold u_k \right) \cdot \grad \alpha_k}} -  \underline{\underline{\alpha_k P_k \mbold u_k \grad A}} \nonumber \\ 
&\underline{\underline{-\bar{P}_{int} A \mu_P \left(P_k-P_j \right)}} + \underline{\underline{A \lambda_u \left(\mbold u_j-\mbold u_k  \right) \cdot \left(\bar{\mbold u}_{int}- \mbold u_k \right)}}\nonumber \\
&+ \div \mbold h_k + \mbold g_k : \grad \mbold u_k + || \mbold u ||^2_k \mbold f_k
\end{align}
%
The underline terms in \eqt{eq:rho-7-eqn-model-sect4} and \eqt{eq:int-ener-7-eqn-model-sect4} yield the positive terms in the right-hand-side of \eqt{eq:ent-eqn-7-eqn-model} and thus are ignored in the remaining of the derivation for simplicity. The entropy equation is now obtained by combining the density equation (\eqt{eq:rho-7-eqn-model-sect4}) and the internal energy equation (\eqt{eq:int-ener-7-eqn-model-sect4}) through the chain rule given in \eqt{eq:chain_rule-sct4} to yield:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms}
\alpha_k \rho_k A \frac{Ds_k}{Dt} &=  (\rho s_\rho)_k \left[ \div \mbold f_k - \rho_k \div \mbold l_k \right] + \nonumber \\
&\left(s_e\right)_k \left[ \div \mbold h_k + \mbold g_k : \grad \mbold u_k +  \left( || \mbold u ||^2_k - e_k\right) \div \mbold f_k  \right],
\end{align}
%
where it was assumed that the entropy of phase $k$ satisfies the second thermodynamic law: 
%
\begin{align}\label{eq:2nd-therm-laws-sect4}
&T_k \text{d} s_k = \text{d}e_k - P_k\frac{\text{d}\rho_k}{\rho_k^2} \nonumber \\
& \text{which implies } P_k (s_e)_k + \rho_k (s_\rho)_k = 0, \\
& (s_e)_k = T_k^{-1} \text{ and } (s_\rho)_k = - (s_e)_k P_k \frac{\text{d}\rho_k}{\rho_k^2}. \nonumber
\end{align}
% 
\eqt{eq:2nd-therm-laws-sect4} is also used to compute the partial derivative of the entropy with respect to the density, $(s_\rho)_k$, and the internal energy, $(s_e)_k$, if needed.

Following the methodology applied in \cite{jlg, Marco_paper_low_mach}, the right-hand side of \eqt{eq:ent-res-7-eqn-diss-terms} can be further simplified by using the following expression
for the dissipative terms $\mbold f_k$,  $\mbold g_k$ and $\mbold h_k$:
%
\begin{subequations}\label{eq:def-diss-terms-sect4}
\begin{align}
  \mbold f_k &= \tilde{\mbold f}_k + \rho_k \mbold  l_k 
  \\
  \mbold g_k &= \alpha_k \rho_k A \mu_k \mathbb{F}(\mbold u_k) + \mbold f_k \otimes \mbold u_k
  \\
  \mbold h_k &= \tilde{\mbold h}_k - \frac{|| \mbold u||^2 }{2} \mbold f_k + (\rho e)_k \mbold l_k,
\end{align}
\end{subequations}
%
where $\mu_k$ is a positive viscosity coefficient for phase $k$. Note the area function $A$ in the definition of $\mbold g$. Substituting the expression of the dissipative term given in \eqt{eq:def-diss-terms-sect4} into \eqt{eq:ent-res-7-eqn-diss-terms}, it yields:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms2}
&\alpha_k \rho_k A \frac{Ds_k}{Dt} = \nonumber \\
&\underbrace{\left(s_e\right)_k \alpha_k \rho_k A \mu_k \mathbb{F}(\mbold u_k) : \grad \mbold u_k}_{\mathcal{R}_1} +
\underbrace{\left[ \div \tilde{\mbold h}_k  - e_k \div \tilde{\mbold f}_k  \right] + (\rho s_\rho)_k \div \tilde{\mbold f}_k}_{\mathcal{R}_2} + \nonumber \\
&\underbrace{(s_e)_k \div \left( \rho_k e_k \mbold l_k \right) -  (s_e)_k e_k \div \left( \rho_k \mbold l_k \right) + \rho_k (s_\rho)_k \div \left( \rho_k \mbold l_k \right) 
  - \rho_k^2 (s_\rho)_k \div \mbold l_k}_{\mathcal{R}_3}.
\end{align}
%
We now split the right-hand-side of \eqt{eq:ent-res-7-eqn-diss-terms2} into three residuals denoted by $\mathcal{R}_1$, $\mathcal{R}_2$ and $\mathcal{R}_3$ and will study the sign of each of them. Since $(s_e)_k$ is defined as the inverse of the temperature and thus positive, the sign of the first term, $\mathcal{R}_1$, is conditioned by the choice of the function $\mathbb{F}(\mbold u_k)$ so that the product with the tensor $\grad \mbold u_k$ is positive. As in \cite{jlg, Marco_paper_low_mach}, $\mathbb{F}(\mbold u_k)$ is chosen proportional to the symmetric gradient of the velocity vector $\grad^s \mbold u_k$, whom entries are given by $\left( (\grad^s \mbold u)_{i,j} \right)_k = \frac{1}{2} \left( \partial_{x_i} u_i + \partial_{x_j} u_j \right)_k$. 
%Such a choice ensures the associated dissipative terms to be rotationally invariant and also positivity of $\mathcal{R}_1$. An other option would be to simply set $\mathbb{F}(\mbold u_k)$ proportional to $\grad \mbold u_k$ which allows to recover the parabolic regularization \cite{Parabolic} but does not ensure rotational invariance. 
%
After a few lines of algebra, the third term ${\mathcal{R}_3}$ can be recast as a function of the gradient of the entropy as follows:
\begin{align}
 \label{eq:ent-R3-sct4}
  \mathcal{R}_2  =  \rho_k A \mbold l_k \cdot \grad s_k.
\end{align} 
One of the assumptions made in the entropy minimum principle is to that the entropy 
is at a minimum which implies that its gradient is null. Because of this, it follows that
the term $\mathcal{R}_3$ is zero at the minimum and thus, the entropy minimum principle is verified
independently of the definition of the perturbation term $\mbold l_k$ used in the volume fraction
equation \eqt{eq:sev_equ-with-diss-terms-vf}. It will be explained later in this section how to derive a definition for $\mbold l_k$.

We now focus on the term denoted by $\mathcal{R}_2$, that is found identical to the right-hand-side of the single phase entropy equation obtained from the multi-D Euler equations (see \cite{jlg, Marco_paper_low_mach}. Thus, the term $\mathcal{R}_2$ is known to be positive when (i) assuming concavity of the entropy function $s_k$ with respect to the internal energy $e_k$ and the specific volume $1 / \rho_k$ (or convexity of $-s_k$) and (ii) choosing the following definitions for the dissipative terms $\tilde{h}_k$ and $\tilde{f}_k$:
%
\begin{subequations}
\begin{align}
&\tilde{\mbold f}_k = \alpha_k A \kappa_k \grad \rho_k \\
&\tilde{\mbold h}_k = \alpha_k A \kappa_k \grad \left( \rho e \right)_k,
\end{align}
\end{subequations}
%  
where $\kappa_k$ is another positive viscosity coefficient. The entropy equation can now be written in its final form:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms3}
&\alpha_k \rho_k A \frac{Ds_k}{Dt} =  \mbold f_k \cdot \grad s_k + \div \left( \alpha_k \rho_k A \grad s_k \right)  \nonumber\\
&- \alpha_k A \kappa_k \mathbf{Q}_k + (s_e)_k \alpha_k A \rho_k \mu_k \grad^s \mbold u_k : \grad \mbold u_k,
\end{align}
%
where $\mathbf{Q}_k$ is a negative semi-definite quadratic form defined as:
%
\begin{eqnarray}
\mathbf{Q}_k &=& X^t_k \Sigma_k X_k \nonumber \\
\text{with } X_k &=& \begin{bmatrix}
\grad \rho_k \\
\grad e_k 
\end{bmatrix}
\text{and } \Sigma_k = \begin{bmatrix}
       \partial_{\rho_k} (\rho^2_k \partial_{\rho_k} s_k) & \partial_{\rho_k,e_k} s_k  \\[0.3em]
       \partial_{\rho_k,e_k} s_k & \partial_{e_k,e_k} s_k           \\[0.3em]
     \end{bmatrix}. \nonumber 
\end{eqnarray}
%
\eqt{eq:ent-res-7-eqn-diss-terms3} is used to prove the entropy minimum principle: assuming that $s_k$ reaches its minimum value in $\mbold r_{min}(t)$ at each time $t$, the gradient, $\grad s_k$, and Laplacian, $\Delta s_k$,  of the entropy are null and positive at this particular point, respectively. Furthermore, it is recalled that the viscosity coefficients $\mu_k$ and $\kappa_k$ are positive by definition. Then, because the terms in the right-hand-side of \eqt{eq:ent-res-7-eqn-diss-terms3} are proven either positive or null when the entropy reaches a minimum value, the entropy minimum principle holds for each phase $k$, \textbf{independently of the definition of the dissipative term} $\mbold l_k$, such as:
%
\begin{equation}\label{eq:ent-res-7-eqn-diss-terms4}
\alpha_k \rho_k A \partial_t s_k(\mbold r_{min},t)) \geq 0 \Rightarrow \partial_t s_k(\mbold r_{min},t)) \geq 0 \nonumber
\end{equation}
%
\tcb{Do we need to make the above statement a theorem or property?}

It remains to obtain a definition for the
dissipative term $\mbold l_k$ used in the volume fraction equation \eqt{eq:sev_equ-with-diss-terms-vf}. A way to achieve this is to
consider the volume fraction equation, by itself and notice that it is an hyperbolic equation
with eigenvalue $\mbold u_{int}$. An entropy equation can be derived and used to prove the
entropy minimum principle by properly choosing the dissipative term \cite{Leveque}. The objective is to
ensure positivity of the volume fraction and also uniqueness of the weak solution. Following
the work of Guermond et al. in \cite{jlg1, jlg2}, it can be shown that a dissipative term ensuring positivity and
uniqueness of the weak solution for the volume fraction equation, is of the form $\mbold l_k = \beta_k A \grad \alpha_k $, where $\beta_k$
is a positive viscosity coefficient. The dissipative term is proportional to the area $A$ for consistency with the other terms of the volume fraction equation \eqt{eq:sev_equ-with-diss-terms-vf}.

All of the dissipative terms are now defined and recalled here:
%
\begin{subequations}\label{eq:visc-reg-7-equ-sect4}
\begin{align}
  \mbold l_k &= \beta_k A \grad \alpha_k 
\end{align}
\begin{align}
  \mbold f_k &= \alpha_k A \kappa_k \grad \rho_k + \rho_k A \mbold l_k 
\end{align}
\begin{align}
  \mbold g_k &= \alpha_k A \mu_k \rho \grad^s \mbold u_k 
\end{align}
\begin{align}
  \mbold h_k &=  \alpha_k A \kappa_k \grad \left( \rho e \right)_k + \mbold u_k : \mbold g_k - \frac{|| \mbold u_k||^2}{2} \mbold f_k + (\rho e)_k \mbold l_k 
\end{align}
\end{subequations}
%
At this point, some remarks are in order:
\begin{enumerate}
\item {The viscous regularization given in \eqt{eq:visc-reg-7-equ-sect4} for the multi-D seven-equation model, is equivalent to the parabolic regularization \cite{Parabolic} when assuming $\beta_k = \kappa_k = \mu_k$ and $\mathbb{F}(\mbold u_k) = \alpha_k \rho_k \kappa_k \grad \mbold u_k$. However, decoupling between the regularization on the velocity and on the density in the momentum equation is important to make the regularization rotation invariant but also to ensure well-scaled dissipative terms for a wide range of Mach number as was shown in \cite{Marco_paper_low_mach} for the multi-D Euler equations.}
\item {The dissipative term $\mbold l_k$ requires the definition of a new viscosity
    coefficient $\beta_k$. It was shown that this viscosity coefficient is independent of
    the other viscosity coefficients $\mu_k$ and $\kappa_k$. Its definition should
    account for the eigenvalue associated with the void fraction equation $\mbold u_{int}$.}
%    In addition, an entropy residual can be determined by analogy to Burger's
%    equation.}
%    It is noted, however, that the eigenvalue $\mbold u_{int}$ can be discontinuous
%    since its definition involves the sign of the void fraction gradient, which
%    makes the theory more challenging. For simplicity, we ignore this aspect of the
%    theory in this report.\tcr{maybe for a report, but here you should say a bit more}}

\item {The dissipative term $\mbold f_k$ is a function of $\mbold l_k$. Thus, all of the other
    dissipative terms are also functions of $\mbold l_k$.}

\item {The partial derivatives $(s_e)_k$ and $(s_{\rho_k})_k$ can be computed using the
    definition provided in \eqt{eq:2nd-therm-laws-sect4} and are functions of the thermodynamic
    variables: pressure, temperature and density.}

\item {All of the dissipative terms are chosen to be proportional to the void
    fraction $\alpha_k$ and the cross-sectional area $A$, but the one in the volume fraction equation that is only proportional to $A$. For instance, $\alpha_k A \grad \rho_k$ is the
    flux of the dissipative term in the continuity equation through the phasic area, $\alpha_k A$, seen
    by the phase $k$. When one of the phases disappears, the dissipative terms
    must go to zero for consistency. On the other hand, when $\alpha_k$ goes to one,
    the single-phase Euler equations with proper viscous regularization must be recovered. }    
    
\item{Compatibility of the viscous regularization proposed in \eqt{eq:visc-reg-7-equ-sect4} with the generalized entropies identified in Harten et al. \cite{Harten} has not been investigated yet. However, it is believed that the entropy inequalities still holds because of the similarities of the entropy residual for the multi-D seven-equation model with the entropy residual derived in the single phase flow case \cite{jlg}.} 
%A rigorous proof is ongoing work and will be included in the final version.
%\tcr{don't you want to include this in the final version?} \tcb{I do}}
\end{enumerate}
%
At this point in the paper, we have derived a viscous regularization for the multi-D seven-equation two-phase flow model that ensures positivity of the entropy residual, uniqueness of the numerical solution when assuming concavity of the phasic entropy $s_k$, and is consistent with the viscous regularization derived for the multi-D Euler equations \cite{jlg, Marco_paper_low_mach} in the limit $\alpha_k \to 1$. The viscous regularization involves a set of three viscosity coefficients for each phase, $\mu_k$, $\kappa_k$ and $\beta_k$, that are assumed positive. Definition of the viscosity coefficients is now required to complete the numerical stabilization method. Since the focus of this paper is the entropy viscosity method, the viscosity coefficients will be defined function of the entropy residual in \sct{sec:low-Mach}. However, one can also devise a definition for the viscosity coefficients $\mu_k$ and $\kappa_k$ by analogy to Lapidus \cite{Lapidus_paper, Lapidus_book} or some pressure-based methods \cite{PBV_book} used for the single-phase Euler equations. On the other hand, the viscosity coefficient, $\beta_k$, for the volume fraction equation should rely on artificial dissipation stabilization methods used for scalar hyperbolic equations. 
%
\begin{remark}
Through the derivations of the viscous regularization, it was noted that another set of dissipative terms $\mbold f_k$ and $\mbold l_k$ would also ensures positivity of the entropy residual:
%
\begin{subequations}
\begin{align}\label{eq:def-l-k-wrong-sect4}
\mbold l_k =\beta_k T_k \left[ \frac{\rho_k}{P_k+\rho_k e_k} \grad \left( \frac{P_k}{\rho_k e_k} \right) - \frac{1}{P_k} \grad \rho_k \right]
\end{align}
\begin{align}
\mbold f_k = \kappa_k \grad \rho_k +  \frac{\rho^2_k (s_{\rho})_k}{\left( \rho s_{\rho} - e s_e \right)_k} \mbold l_k
\end{align}
\end{subequations}
%
However, the definition of $\mbold l_k$ proposed in \eqt{eq:def-l-k-wrong-sect4} was not considered as valid for the following reasons: positivity of the volume fraction cannot be achieved and the parabolic regularization is not retrieved when assuming equal viscosity coefficients.
\end{remark}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A definition of the viscosity coefficients for all Mach flows}\label{sec:low-Mach}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{itemize}
\item non-dimensionalize the equations but use $P_\infty$ for the pressure instead of $(\rho c^2)_\infty$
\item introduce a new Pechlet number for $\beta$: its behavior should be the same as the Pechlet number for $\kappa$
\item two cases: zero and infinite relaxation coefficients
\item derive the normalization parameters for the isentropic and non-isentropic flows
\item discussion about the 
\end{itemize}
%
When working with artificial dissipative numerical stabilization methods, great care needs to be carried to the definition of the viscosity coefficients that will determine the accuracy of the method. Generally speaking, sufficient artificial viscosity should be added into the shock and discontinuity regions to prevent spurious oscillations from forming, while little dissipation is added when the numerical solution is smooth. Such requirements can be achieved by tracking shocks and discontinuities in the numerical solutions. When dealing with fluid equations, the low-mach asymptotic limit also has to be accounted for in the definition of the viscosity coefficients in order to ensure well-scaled dissipative terms \cite{LowMach1, LowMach2, LowMach3}. Also, because each phase can experience different flow regime (the gas phase is supersonic whereas the liquid phase remains subsonic), it is chosen to work with three distinct viscosity coefficients for each phase. The purpose of this section is to derive a definition for the phasic viscosity coefficients, $\mu_k$, $\kappa_k$ and $\beta_k$, that ensures the correct numerical solution in the low-mach limit, can accurately resolves shocks in transonic and supersonic flows and is also consistent with the definition of the viscosity coefficients devised for the single-phase Euler equations in the limit $\alpha_k \to 1$. As a result, the approach used in \cite{Marco_paper_low_mach} will be applied here in this section. 
%------------------------------------------------------------------------------------------------------
\subsection{Definition of the viscosity coefficients}\label{sec:visc-coeff-sem}
%------------------------------------------------------------------------------------------------------
In the entropy viscosity method, each viscosity coefficient is function of an upper and a lower bound that are referred to as first-order viscosity coefficient and entropy viscosity coefficient (high-order coefficient), respectively, as shown in \eqt{eq:def-visc-sem-sct4}. The first-order viscosity coefficient is denoted by the subscript $max$ and is defined proportional to the largest local eigenvalue so that the stabilization scheme becomes over-dissipative and smooth out all discontinuities. The entropy viscosity coefficient is set proportional to an entropy residual and jumps of quantities to determine, and denoted by the subscript $e$. 
%
\begin{align}\label{eq:def-visc-sem-sct4}
\beta_k( \mbold r, t) = \min \left( \beta_{e,k}( \mbold r, t), \beta_{max,k} ( \mbold r, t) \right), \nonumber \\
\mu_k( \mbold r, t) = \min \left( \mu_{e,k}( \mbold r, t), \mu_{max,k} ( \mbold r, t) \right),  \\
\kappa_k( \mbold r, t) = \min \left( \kappa_{e,k}( \mbold r, t), \kappa_{max,k} ( \mbold r, t) \right) ,\nonumber 
\end{align}
% 
where all of the variables are locally defined. We now define the first-order viscosity coefficients and will focus first on the phasic viscosity coefficients $\kappa_k$ and $\mu_k$ that are untimely linked to the mass, momentum and energy equations. These two viscosity coefficients are involved in dissipative terms that identical to the ones obtained for the single-phase Euler equations \cite{jlg, Marco_paper_low_mach} when seeing the term $\alpha_k A$ as a pseudo cross-section. Thus, it is chosen to define the corresponding first-order viscosity coefficients proportional to the local largest eigenvalue $|| \mbold u_k || + c_k$ as follows:
%
\begin{equation}\label{eq:def-visc-max-sem-sct4}
\kappa_{max,k}( \mbold r, t) = \mu_{max,k}( \mbold r, t) = \frac{h}{2} \left( || \mbold u_k||( \mbold r, t) + c_k( \mbold r, t) \right),
\end{equation}
%
where $h$ is the grid size. It remains to define the first-order viscosity coefficient, $\beta_{max}$, used in the volume fraction equation. Because the volume fraction equation can be treated as a hyperbolic scalar equation with an unique eigenvalue $\mbold u_{int}$, the first-order viscosity coefficient is defined by analogy with Burger's equation \cite{jlg1, jlg2} as follows:
%
%
\begin{equation}\label{eq:def-beta-max-sen-sect4}
\beta_{max,k}( \mbold r, t) = \frac{h}{2} || \mbold u_{int}( \mbold r, t) ||.
\end{equation}
%
After defining the first-order viscosity coefficients for each phase, we focus our attention to the entropy viscosity coefficients denoted by the subscript $e$ in \eqt{eq:def-visc-sem-sct4}. We first choose to investigate the definitions of $\mu_{e,k}$ and $\kappa_{e,k}$. The entropy viscosity coefficients are set proportional to the entropy residual given in \eqt{eq:ent_res}, that is known to be positive and peaked in the shock region. 
%
\begin{equation}\label{eq:ent_res}
\resi_k(\mbold r,t) := \matder{s_k} =  \partial_t s_k + \mbold u_k \cdot \grad s_k
\end{equation}
%
It is also accounted for the jumps of quantities that will be determined further. The objective is to be able to track spatially and temporally any shock and discontinuity forming in the computational domain. In \cite{Marco_paper_low_mach}, it was demonstrated the usefulness of recasting the entropy residual as a function of pressure, velocity, density and speed of sound as shown in \eqt{eq:ent_res-sem-sct4}. The alternative expression of the entropy residual denoted by $\resinew_k(\mbold r,t)$, no longer requires an analytical expression of the entropy $s_k$ and experiences the same variations (in absolute value) as the original definition of the entropy residual (\eqt{eq:ent_res}).
%
\begin{equation}\label{eq:ent_res-sem-sct4}
\resi_k(\mbold r,t)  = \matder{s_k} = \frac{(s_e)_k}{(P_e)_k} \left( \underbrace{\matder{P_k} - c_k^2 \matder{\rho_k} }_{\resinew_k(\mbold r,t)} \right) ,
\end{equation} 
%
Using the new expression of the entropy residual $\resinew_k$, we now propose a definition, given in \eqt{eq:visc_definition-sct4}, for the phasic entropy viscosity coefficients $\mu_{e,k}$ and $\kappa_{e,k}$ that also accounts for jumps, $J_k$, of some function of the pressure and density for generality purpose. The jump helps at tracking contact waves or discontinuities other than shock that are not seen by the entropy residual. Its definition will be detailed in SECTION. A distinct normalization parameter is also introduced for each viscosity coefficient that is used for dimensionality purpose: a quick dimensional study of the dissipative terms shows that the viscosity coefficients are kinematic viscosity ($m^2 \cdot s^{-1}$). Thus, the normalization parameters has units in pressure and its final definition will be determined by a low-Mach asymptotic limit of \eqt{eq:sev_equ-with-diss-terms} in order to ensure well-scaled dissipative terms.
%
\begin{subequations}\label{eq:visc_definition-sct4}
\begin{equation}
\mu_{e,k}(\mbold r,t)    = h^2 \frac{\max\left( | \resinew_k(\mbold r_q,t) |\,, || J_k^\mu || \right)}{\norm_{P,k}^\mu},
\end{equation} 
\text{and} 
\begin{equation}
\kappa_{e,k}(\mbold r,t) = h^2 \frac{\max\left( | \resinew_k(\mbold r_q,t) |\,, || J_k^\kappa || \right)}{\norm_{P,k}^\kappa} \, .
\end{equation}
\end{subequations}
%
It remains to define the entropy viscosity coefficient $\beta_e$. For the purpose of this paragraph, let us consider the scalar volume fraction equation and assume that the interface velocity $\mbold u_{int}$ is given. Because it is a scalar hyperbolic equation, it is proposed to define the entropy viscosity coefficients on the same model as what is done for Burger's equation \cite{jlg1, jlg2}. Thus, the entropy viscosity viscosity coefficient $\beta_e$ is defined as a function of an entropy residual, $R_{k}^\alpha$, derived from the volume fraction equation for phase $k$, and the jump of a function of the volume fraction, $J_k^\alpha$, as shown in \eqt{eq:def-beta-sen-sect4}.
%
\begin{align}\label{eq:def-beta-sen-sect4}
\beta_{e,k}( \mbold r, t) = h^2 \frac{\max\left( | R_{k}^\alpha(\mbold r_q,t) |\,, || J_k^\alpha|| \right)}{\norm_{\alpha, k}^\beta} \,
\end{align}
%
We also introduced a normalization parameter, $\norm_{\alpha,k}^\beta$, whom definition will be further investigated. To derive the entropy residual, $R_{\alpha,k}$, we consider the volume fraction equation for phase $k$ with its viscous regularization and assume the existence of an entropy denoted by $\eta_k(\alpha_k)$ \cite{Leveque}:
%
\begin{equation}\label{eq:vf-sem-sct4}
\partial_t \left(A \alpha_k \right) + A \mbold u_{int} \cdot \grad \alpha_k = \div \left( \beta_k A \grad \alpha_k \right)
\end{equation}
% 
After multiplying by $\frac{\text{d} \eta (\alpha_k)}{\text{d} \alpha_k}$ and using the chain rule, an expression for the entropy equation is obtained:
%
\begin{equation}\label{eq:vf-sem2-sct4}
\underbrace{\partial_t \left(A \eta(\alpha_k) \right) + A \mbold u_{int} \cdot \grad \eta(\alpha_k)}_{R_{k}^\alpha} = \frac{\text{d} \eta (\alpha_k)}{\text{d} \alpha_k} \div \left( \beta_k A \grad \alpha_k \right)
\end{equation}
% 
The entropy residual, $R_{k}^\alpha$, is defined as the left hand side of \eqt{eq:vf-sem2-sct4} and is known to be peaked in the shock region and positive when assuming convexity of the entropy $\eta_k$ with respect to $\alpha_k$ \cite{Leveque}. Such a behavior is identical to the entropy residual $\resinew_k$ defined in \eqt{eq:ent_res-sem-sct4}, and will allow detection of the shock wave when used in the definition of the entropy viscosity coefficient $\beta_{e,k}$.
%Because \eqt{eq:vf-sem2-sct4} is identical to \eqt{eq:weak_sol8_sct1b}, it is concluded that $R_{\alpha,k} \geq 0$ when assuming $\eta$ convex with respect to $\alpha_k$, which justifies the definition of the entropy viscosity viscosity coefficient $\beta_{e,k}$ given in \eqt{eq:def-beta-sen-sect4} based on \eqt{sec:evm_hyp_sc_sct1b}. The entropy function is taken equal to $\eta(\alpha_k) = \frac{\alpha_k^2}{2}$ which is convex.
%
At this point of the paper, the definition of the viscosity coefficients are not finalized: the jumps and normalization parameters still have to be defined. Details regarding the definition of the jump will be given in \sct{sec:solution_tech}. The normalization parameters are derived from a low-Mach asymptotic limit analysis which is the purpose of the next section.
%------------------------------------------------------------------------------------------------------
\subsection{Low-Mach asymptotic limit of the seven-equation model}\label{sec:low-Mach-sem}
%------------------------------------------------------------------------------------------------------
Developing a numerical method for fluid equations require to investigate the low-Mach asymptotic limit. In this particular limit, numerical methods developed for transonic and supersonic flows usually fail due to ill-scaled dissipative terms. A fix is found by performing a low-Mach asymptotic limit to ensure well-scaled dissipative terms \cite{LowMach1, LowMach2, LowMach3}. Then, it is proposed to perform a low-Mach asymptotic limit to derive an expression for the phasic normalization parameters introduced in \sct{sec:visc-coeff-sem}. Two limit $1$-D cases are considered: the relaxation coefficients are set to (i) zero and (ii) to very large values. In the former case, the two phases do not interact and each phase simply flows through a given geometry of pseudo cross-section $\alpha_k A$. In the later case, the infinite relaxation coefficients make the seven-equation two-phase model degenerates into the five-equation model of Kapila by ensuring pressure and velocity equilibrium. For each case (i) and (ii), two limit cases (a) and (b) will be considered to determine appropriate scaling for the entropy 
viscosity coefficients so that the dissipative terms remain well-scaled for two limit cases: 
(a) the isentropic low-Mach limit where the seven-equation model degenerate to an incompressible system of 
equations in the low-Mach limit and 
(b) the non-isentropic limit with formation of shocks. 
In the low-Mach limit, the isentropic limit of the seven-equation model with viscous regularization should yield incompressible 
fluid flow solutions, namely, that the phasic pressure fluctuations are of the 
order $M^2_k$ and that the velocity satisfies the divergence constraint $\div ( \vec{u}_0 )_k = 0$ 
\cite{LowMach1, LowMach2, LowMach3}. For non-isentropic situations, shocks may form for any 
value of Mach number and the minimum entropy principle should still be satisfied so that numerical 
oscillations, if any, be controlled by the entropy viscosity method independently of the value of the Mach number. A total of four different cases will be studied and for each case the scaling of the numerical adimensional numbers will be given along with the definition of the normalization parameters defined in \sct{sec:visc-coeff-sem} for each viscosity coefficients.

The first step in the study of the limit cases (i) and (ii) is to re-write each system of equations in a non-dimensional manner. To do so, the following variables are introduced for each phase $k$:
%
\begin{multline}
\label{eq:norm_param}
\rho_k^*   = \frac{\rho_k}{\rho_{k,\infty}}           ,\
u_k^*      = \frac{u_k}{u_{k,\infty}}                 ,\
P_k^*      = \frac{P_k}{\rho_{k,\infty} c^2_{k,\infty}}   ,\
E_k^*      = \frac{E_k}{c^2_{k,\infty} }              ,\
x^* = \frac{x}{L_\infty}                      ,\\
t_k^* = \frac{t_k}{L_\infty / u_{k,\infty}}           ,\
\mu_k^*    = \frac{\mu_k}{\mu_{k,\infty}}             ,\
\kappa_k^* = \frac{\kappa_k}{\kappa_{k,\infty}}       ,\
P_{int}^*    = \frac{P_{int}}{P_{int,\infty}}             ,\\
u_{int}^* = \frac{u_{int}}{u_{int,\infty}}       ,\
\bar{P}_{int}^*    = \frac{\bar{P}_{int}}{\bar{P}_{int,\infty}}             ,\
\bar{u}_{int}^* = \frac{\bar{u}_{int}}{\bar{u}_{int,\infty}}       ,\
\end{multline}
%
where  the subscript $\infty$ denote the far-field or stagnation quantities and the superscript $*$ stands for the non-dimensional variables. The far-field reference quantities are chosen such that the dimensionless flow quantities are of order 1. The stagnation quantities for the pressure and velocity interfacial variables will be specified for each case. The reference Mach number is given by
%
\begin{equation}
M_{k,\infty} = \frac{u_{k,\infty}}{c_{k,\infty}}.
\end{equation}
%
We start the low-Mach analysis with case (i) and give the system of equations with viscous regularization that is used when assuming zero relaxation coefficients:
% 
\begin{subequations}\label{eq:sev_equ_case_one}
\begin{align}\label{eq:sev_equ-with-diss-terms-cont_one}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = \div \left( \kappa_k \grad \rho_k \right)
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-mom_one}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k + \div \left[ \mu_k \rho_k \grad^s \vec{u} \right. &+ \left.\kappa_k \vec{u}_k \otimes \grad \rho_k \right]
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-ener_one}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &= \nonumber \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k -
&+ \div \left( \mbold h_k + \mbold u \cdot \mbold g_k \right)
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-vf_one}
\partial_t \left( \alpha_k  A\right) + \mbold u_{int} A \grad \alpha_k =  \div \mbold l_k
\end{align}
\end{subequations}
%
Then, the scaled equations for the phase $k$ with viscous regularization are:
% 
\begin{subequations}\label{eq:sev_equ_case_one_scaled}
\begin{align}\label{eq:sev_equ-with-diss-terms-cont_case_one_scaled}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = \frac{1}{\Pe_{k,\infty}}\div \left( \kappa_k \grad \rho_k \right)
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-mom_case_one_scaled}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k &+ \div \mbold g_k
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-ener_case_one_scaled}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &= \nonumber \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k -
&+ \div \left( \mbold h_k + \mbold u \cdot \mbold g_k \right)
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-vf_case_one_scaled}
\partial_t \left( \alpha_k  A\right) + \mbold u_{int} A \grad \alpha_k =  \div \mbold l_k
\end{align}
\end{subequations}
%
%In order to have a complete definition for the viscosity coefficients $\beta_k$, $\mu_k$ and $\kappa_k$, the normalization parameters introduced in the definition of the entropy viscosity coefficients $\beta_{e,k}$, $\mu_{e,k}$ and $\kappa_{e,k}$ have to be determined. In SECTION, the normalization parameters were derived from the non-dimensionalized multi-D Euler equations in order to obtain well-scaled dissipative terms. Thus, it is proposed to follow the same method to derive the three normalization parameters $\norm_{P,k}^\mu$, $\norm_{P,k}^\kappa$ and $\norm_{k}^\beta$ used in the definition of the viscosity coefficients involved in the viscous regularization of the seven-equation model. For simplicity, the Ideal Gas equation of state is considered through the derivations.
%
%For now, the definition of the viscosity coefficients is simply derived by analogy to SECTION. First, we define the far-field or stagnation coefficients for each phase as it is done in \eqt{eq:norm_param} by adding the subscript $k$ to $\infty$. Then, the scaled equations are derived for each phase which leads to the definition of a phasic P\'eclet and Reynolds numbers referred to as $\Pe_k$ and $\Re_k$, respectively, that are tied to the far-field or stagnation quantities of the viscosity coefficients $\mu_{k,\infty}$ and $\kappa_{k,\infty}$ as shown in \eqt{eq:ref_numb_7eq}:
%%  
%\begin{equation}
%\label{eq:ref_numb_7eq}
%\Re_{k,\infty} = \frac{u_{k,\infty} L_\infty}{\mu_{k,\infty}} \text{ and }
%\Pe_{k,\infty} = \frac{u_{k,\infty} L_\infty}{\kappa_{k,\infty}} \, .
%\end{equation}
%%
%Because the viscous regularization derived previously in SECTION requires an extra viscosity coefficient $\beta_k$ for the volume fraction equation, a new P\'eclet number, $\Pe_{k,\infty}^\beta$ is also defined as follows,
%%
%\begin{equation}
%\label{eq:ref_numb_7eq_beta}
%\Pe_{k,\infty}^\beta = \frac{u_{int,\infty} L_\infty}{\beta_{k,\infty}} \,
%\end{equation}
%%
%that will allow us to derive the proper scaling for $\beta_{k,\infty}$. Once the scaled equations are obtained, the scaling of the numerical numbers can be chosen in order to meet the different criteria already listed in SECTION. The scaling of the new P\'eclet number we defined, $\Pe_{k,\infty}^\beta$, is derived from the scaled volume fraction equation that does not contain any term weighted by the reference Mach number $M_\infty$, which yields $\Pe_{k,\infty}^\beta=1$ to have a well-scaled dissipative term. This scaling is the same as for $\Pe_{k,\infty}$ from the continuity equation: the volume fraction and continuity equations have similar behavior since they are both advection-type equations. Thus, based on the reasoning used in SECTION, the following definitions for the viscosity coefficients is proposed in \eqt{eq:final_def_visc_coeff-sem}: 
%%
%\begin{subequations}
%\label{eq:final_def_visc_coeff-sem}
%%
%\begin{equation}
%\mu_k(\mbold r,t)    = \min \Big (\mu_{\max,k}(\mbold r,t), \mu_{e,k} (\mbold r,t)    \Big) \text{  and  }
%\kappa_k(\mbold r,t) = \min \Big (\mu_{\max,k}(\mbold r,t), \kappa_{e,k} (\mbold r,t) \Big ) 
%\end{equation}
%%
%where the first-order viscosity is given by
%\begin{equation}\label{eq:first-order-visc-sct4-sem}
%  \kappa_{\max,k}(\mbold r,t)  = \mu_{\max,k} (\mbold r,t) = \frac{h}{2} \Big ( ||\mbold u_k|| + c_k \Big ) 
%\end{equation}
%%
%and the entropy viscosity coefficients by 
%%
%\begin{equation}
%\kappa_{e,k}(\mbold r,t) = \frac{h^2 \max(\resinew_k, J_k)}{ \rho_k c_k^2 }  \text{  and  }
%\mu_{e,k}(\mbold r,t)    = \frac{h^2 \max(\resinew_k, J_k)}{ \norm_{P,k}^\mu} 
%\end{equation}
%% 
%with the jumps given by
%%
%\begin{equation}
%J_k =  \max \Big ( || \mbold u_k || [[ \grad P_k \cdot \mbold n ]], || \mbold u_k || c_k^2 [[\grad \rho_k \cdot \mbold n]] \Big) 
%\end{equation}
%\end{subequations}
%%
%where $\norm_{P,k}^\kappa$ is computed from \eqt{eq:norm_ent3-7eq}.
%%
%\begin{equation}
%\label{eq:norm_ent3-7eq}
%\norm_P^\mu = (1-\sigma(M)) \rho c^2  + \sigma(M)  \rho ||\mbold{u} ||^2  
%\end{equation}
%%
%%\begin{equation}
%%\label{eq:norm_ent2-sem}
%%\norm_{P,k}^\mu =  \left\{
%%\begin{array}{ll}
%% \rho_k ||\mbold u_k ||^2       & \text{ if } \left| \resinew_k^* \right| \geq M_k \text{ (i.e., non-isentropic flow)} \\
%% \rho_k c_k^2 = \norm_{P,k}^\kappa & \text{ otherwise}
%%\end{array}
%%\right. \,.
%%\end{equation}
%%
%where $M_k$ is the local Mach number for phase $k$. The function $\sigma(M)$ is taken from \eqt{eq:sigma_fct} with the same parameters as for the single-phase flow equations: $a=3$ and $M^{thres} = 0.05$. The jump $J_k$ is a function of the jump of pressure and density gradients across the face with respect to its normal vector $\mbold n$. Then, the largest value over all faces is determined and used in the definition of the viscosity coefficients. Lastly, the viscosity coefficient for the volume fraction equation is given by:
%%
%\begin{equation}\label{eq:first-order-beta-sct4-sem}
%\beta_k(\mbold r,t) = \min \Big (\beta_{\max,k}(\mbold r,t), \beta_{e,k} (\mbold r,t) \Big ) 
%\end{equation}
%%
%where the first-order viscosity is given by
%\begin{equation}\label{eq:first-order-beta-max-sct4-sem}
%\beta_{\max,k} (\mbold r,t) = \frac{h}{2} ||\mbold u_{int}||
%\end{equation}
%%
%and the corresponding entropy viscosity coefficient, $\beta_{e,k}$, by 
%%
%\begin{equation}
%\beta_{e,k}(\mbold r,t) = \frac{h^2 \max(R_{\alpha,k}, J_{\alpha,k})}{|| \alpha_k - \bar{\alpha}_k ||_\infty},
%\end{equation}
%where $\bar{\alpha}_k$ is the average value of the volume fraction over the entire computational domain, and $|| \cdot ||_\infty$ denotes the infinite norm. The definition of the $\beta_{e,k}$ is consistent with the scaling of $\Pe^\beta_{k,\infty} = 1$. The jump is given by:
%%
%\begin{equation}
%J_{\alpha,k} = || \mbold u_{int} || \cdot [[ \grad \alpha_k \cdot \mbold n ]]. 
%\end{equation}
%With the definition of the viscosity coefficients $\mu_k$ and $\kappa_k$ proposed in \eqt{eq:final_def_visc_coeff}, the low-Mach asymptotic limit is ensured for isentropic flow, and transonic flows with shocks will be correctly resolved for each phase $k$. Furthermore, the definition of the viscosity coefficient $\beta_k$ is consistent with the EVM used for the scalar hyperbolic equations and thus should efficiently stabilize shocks forming the in the volume fraction profile. Plus, it is noted that the viscous regularization and the definition of the viscosity coefficients proposed for the seven-equation two-phase flow model degenerates into the EVM used for the single-phase Euler equations. In order to validate the proposed definition of the viscosity coefficients, 1-D numerical simulations are performed in SECTION.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discretizations and Solution Techniques} \label{sec:solution_tech}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In this section, we briefly describe the spatial and temporal discretizations and the solution techniques 
used to solve the system of equations \eqt{eq:sev_equ-with-diss-terms}. For conciseness, we re-write the system of 
equations in the following form:
\begin{equation}
\label{eq:form}
\partial_t \mathbf{U}_k + \div \mathbf{F}_k \left( \mathbf{U}_k \right) = \mathbf{R}_k \left( \mathbf{U}_k \right) + \mathbf{N}_k \left( \mathbf{U}_k \right) + \div \mathbf{D}_k(\mathbf{U}_k) \grad \mathbf{U}_k
\end{equation}
where $\mathbf{U}_k=[(\alpha A )_k, \, (\alpha \rho A)_k,\, (\alpha \rho \mbold{u} A)_k,\, (\alpha \rho E A)_k]^T$ is the solution vector, $\mathbf{F}_k \left( \mathbf{U}_k \right)$ denotes the inviscid flux, $\div D_k (\mathbf{U}_k) \grad \mathbf{U}_k$ is the dissipative flux and $\mathbf{N}_k \left( \mathbf{U}_k \right)$ and $\mathbf{R}_k \left( \mathbf{U}_k \right)$ contain the non-conservative and relaxation terms, respectively. 
\begin{equation}
  \mathbf{F} \equiv
  \begin{bmatrix}
      0     \\
    ( \alpha \rho u A )_k     \\
    \left[ \alpha \left(\rho u^2 + P \right) A \right ]_k  \\
    \left[ \alpha u (\rho E + P) A \right]_k
  \end{bmatrix},
%\end{equation}
%\begin{equation}
  \mathbf{N} \equiv
  \begin{bmatrix}
      - A \mbold{u}_{int} \cdot \grad \alpha_k     \\
    0     \\
    \alpha_k P_k \grad A + P_{int} A \grad \alpha_k  \\
    P_{int} A \mbold{u}_{int} \cdot \grad \alpha_k
  \end{bmatrix} \nonumber
\end{equation}
\begin{equation}
\text{and }
  \mathbf{R} \equiv
  \begin{bmatrix}
      A \mu_P \left( P_k - P_j \right)     \\
    0     \\
    A \lambda_u \left( \mbold u_j - \mbold u_k \right) \\
    - \bar{P}_{int} A \mu_P \left( P_k - P_j \right) + \bar{u}_{int} A \lambda_u \left( \mbold u_j - \mbold u_k \right)
  \end{bmatrix}. \nonumber
\end{equation}
%
%===================================================================================================
\subsection{Spatial and Temporal Discretizations} \label{sec:disc}
%===================================================================================================
The system of equations given in \eqt{eq:form} is discretized using a continuous Galerkin finite element 
method and temporal integrators available through the MOOSE multiphysics framework \cite{MOOSE}.
%---------------------------------------------------------------------------------------------------
\subsubsection{Continuous Finite Elements} 
%---------------------------------------------------------------------------------------------------
In order to apply the continuous finite element method, \eqt{eq:form} is multiplied by a test function 
$\mathbf W(\mbold{r})$, integrated by parts and each integral is decomposed into a sum of integrals over 
each element $K$ of the discrete mesh $\Omega$. The following weak form is obtained:
\begin{multline}\label{eq:cfem}
\sum_K \int_{K} \partial_t \mathbf U \, \mathbf W - \sum_K \int_{K} \mathbf F (\mathbf U) \cdot \grad \mathbf W + \int_{\partial \Omega} \mathbf F (\mathbf U) \cdot \mbold{n} \mathbf W - \sum_K \int_{K} \left( \mathbf N (\mathbf U) + \mathbf R (\mathbf U) \right) \mathbf W  \\
+ \sum_K \int_{K} D(\mathbf U) \grad \mathbf U \cdot \grad \mathbf W 
- \int_{\partial \Omega} D(\mathbf U) \grad \mathbf U \cdot \mbold{n} \, \mathbf W = 0 \,.
\end{multline}
The integrals over the elements $K$ are evaluated using a numerical quadrature. The MOOSE framework 
provides a wide range of test functions and quadrature rules. Linear Lagrange polynomials are employed 
as test functions in the results section. Second-order spatial convergence will be demonstrated for smooth solutions. 

%---------------------------------------------------------------------------------------------------
\subsubsection{Temporal integration} 
%---------------------------------------------------------------------------------------------------
The MOOSE framework offers both first- and second-order explicit and implicit temporal integrators. 
In all of the numerical examples presented in \sct{sec:results}, the temporal derivative  will be 
evaluated using the second-order, backward difference temporal integrator BDF2. By considering three 
consecutive solutions, $\mathbf U^{n-1}$, $\mathbf U^n$ and $\mathbf U^{n+1}$, at times $t^{n-1}$, $t^n$ and $t^{n+1}$, respectively, BDF2 can be expressed as:
\begin{equation}
\label{eq:BDF2}
\int_{K} \partial_t \mathbf U \, \mathbf  W = \int_{K} \left( \omega_0 \mathbf U^{n+1}  + \omega_1 \mathbf U^n + \omega_2 \mathbf U^{n-1} \right) \mathbf W \,,
\end{equation}
%
with
\begin{multline}
\omega_0 =\frac{2\Delta t^{n+1}+\Delta t^n}{\Delta t^{n+1} \left( \Delta t^{n+1}+\Delta t^n \right)} \, , \ 
\omega_1 = -\frac{\Delta t^{n+1}+\Delta t^n}{\Delta t^{n+1} \Delta t^n}  \, , \\
\text{ and } \omega_2 = \frac{\Delta t^{n+1}}{\Delta t^n \left( \Delta t^{n+1} + \Delta t^n \right)} \nonumber
\end{multline}
where $\Delta t^{n} = t^n-t^{n-1}$ and $\Delta t^{n+1} = t^{n+1}-t^{n}$.
%---------------------------------------------------------------------------------------------------
\subsection{Boundary conditions} \label{sec:bc}
%---------------------------------------------------------------------------------------------------
Boundary conditions are implemented by performing a characteristic decomposition to compute the 
appropriate flux at the boundaries. The numerical results presented in \sct{sec:results} were all obtained by using stagnation and static pressure boundary conditions for the inlet and outlet, respectively.
Our implementation of the subsonic boundary conditions is inspired by the method described in \cite{SEM} 
and was adapted for a time implicit solver \cite{Marco_dissertation}. 
\tcb{I will give more details in the future}
%\tcr{say a bit more, give 1-2 sentences to describe how to impose subsonic/supersonic inlet/outlet BCs}. \tcb{Is it enough?}

%For each numerical solution presented in \sct{sec:results}, the type of boundary conditions used 
%will be specified and taken among the following: supersonic inlet, subsonic inlet (stagnation pressure boundary), 
%subsonic outlet, and supersonic outlet. 
%and subsonic inlet \tcr{???} (static pressure boundary). \\
The artificial diffusion coefficient $D(\mathbf  U)$ is set to zero at the boundary of the computational 
domain so that the boundary term 
$\int_{\partial \Omega} D(\mathbf  U) \grad \mathbf  U \cdot \mbold{n} \, \mathbf W$ stemming from the 
integration by parts of the artificial dissipative terms in \eqt{eq:cfem} is ignored.
%---------------------------------------------------------------------------------------------------
\subsection{Solver} \label{sec:solver}
%---------------------------------------------------------------------------------------------------
A Jacobian-free-Newton-Krylov (JFNK) method is used to solve for the solution at the end of each time step. 
An approximate Jacobian matrix of the discretized equations was derived and implemented. Obtaining the 
matrix entries requires that the partial derivatives of pressure with respect to the conservative variables 
be known (this is relatively simple for the stiffened and ideal gas equations of state but may be more 
complex for general equations of state). The contributions of the artificial dissipative terms to the 
Jacobian matrix are approximated by lagging the viscosity coefficients (computing them with the previous solution). 
For instance, this is shown in \eqt{eq:jac_diss_term} for the dissipative terms present in the continuity equation:
\begin{equation}
\label{eq:jac_diss_term}
\frac{\partial}{\partial \mathbf U} \left( \kappa \grad \rho \cdot \grad W \right) \simeq \kappa \div \frac{\partial \rho}{\partial \mathbf U} \grad W ,
\end{equation}  
where $\mathbf  U$ denotes any of the conservative variables and $W$ denotes the component of $\mathbf  W$ associated with the 
continuity equation. In the above, we have neglected $\frac{\partial \kappa}{\partial \mathbf U}$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{$1$-D numerical results}\label{sec:results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{itemize}
\item simple advection problem
\item shock tube with two independent fluids: exact solution and could do convergence test for this particular test
\item shock tube with infinite relaxation coefficients
\item $1$-D nozzle with two independent fluids
\item $1$-D nozzle with infinite relaxation coefficients
\item $1$-D nozzle with infinite relaxation coefficients,  mass and heat transfer
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{mybibfile}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Entropy equation for the multi-D seven equation model without viscous regularization}\label{app:sev-equ-model-entropy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This appendix provides the steps that lead to the derivation of the phasic entropy equation of the seven-equation model \cite{SEM}. For the purpose of this dissertation, two phases are considered and denoted by the indexes $j$ and $k$. In the seven-equation model, each phase obeys to the following set of equations $(\eqt{eq:sev_equ-app})$:
\begin{subequations}
\label{eq:sev_equ-app}
%\left\{
%\begin{array}{llllll}
\begin{align}
\partial_t \left( \alpha_k  A\right) + A \mbold u_{int} \cdot \grad \alpha_k = A \mu \left( P_k - P_j \right) 
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = 0 
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &= \nonumber \\
\alpha_k P_k \grad A &+ P_{int} A \grad \alpha_k + A \lambda \left( \mbold u_j - \mbold u_k \right) 
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &= \nonumber \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k &- \mu \bar{P}_{int} \left( P_k-P_j \right) + \bar{\mbold u}_{int} A \lambda \left( \mbold u_j - \mbold u_k \right)
\end{align}
%    \end{array}
%    \right.
\end{subequations}
where $\rho_k$, $\mbold u_k$, $E_k$ and $P_k$ are the density, the velocity, the specific total energy and the pressure of $k^{th}$ phase, respectively. The pressure and velocity relaxation parameters are denoted by $\mu_P$ and $\lambda_u$, respectively. The variables with index $_{int}$ correspond to the interfacial variables and a definition is given in \eqt{eq:sev_equ2-app}. The cross section $A$ is only function of space: $\partial_t A = 0$. 
\begin{equation}
\label{eq:sev_equ2-app}
\left\{
\begin{array}{lll}
P_{int} = \bar{P}_{int} - \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{Z_k Z_j}{Z_k + Z_j} \left( \mbold u_k-\mbold u_j \right) \\
\bar{P}_{int} = \frac{Z_k P_j + Z_j P_k}{Z_k + Z_j} \\
\mbold u_{int} = \bar{\mbold u}_{int} - \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{P_k - P_j}{Z_k + Z_j} \\
\bar{\mbold u}_{int} = \frac{Z_k \mbold u _k + Z_j \mbold u_j}{Z_k + Z_j}
\end{array}
\right.
\end{equation}
where $Z_k = \rho_k c_k$ and $Z_j = \rho_j c_j$ are the impedance of the phase $k$ and $j$, respectively. The speed of sound is denoted by the variable $c$. The function $sgn(x)$ returns the sign of the variable $x$.\\
The first step consists of rearranging the equations given in \eqt{eq:sev_equ2-app} using the primitive variables $(\alpha_k, \rho_k, \mbold u_k, e_k)$, where $e_k$ is the specific internal energy of $k^{th}$ phase. We introduce the material derivative $\frac{D (\cdot)}{Dt} = \partial_t (\cdot) + \mbold u_k \cdot \grad (\cdot)$ for simplicity. \\
The void fraction is unchanged. The continuity equation is modified as follows:
\begin{equation}
\label{eq:cont1-app}
\alpha_k A \frac{D \rho_k}{Dt} + \rho_k A \mu \left( P_k-P_j \right) + \rho_k A \left( \mbold u_k-\mbold u_j \right) \cdot \grad \alpha_k + \rho_k \alpha_k \div \left( A \mbold u_k \right) = 0
\end{equation}
The momentum and continuity equations are combined to yield the velocity equation:
\begin{equation}
\label{eq:vel1-app}
\alpha_k \rho_k A \frac{D\mbold u_k}{Dt} + \partial_x \left( \alpha_k A P_k \right) = \alpha_k P_k \grad A + P_{int} A \grad \alpha_k + A \lambda_u \left( \mbold u_j-\mbold u_k \right)
\end{equation}
The internal energy is obtained from the total energy and the kinetic equation ($\mbold u_k * $\eqt{eq:vel1-app}):
\begin{align}\label{eq:internal1}
\alpha_k \rho_k A \frac{D e_k}{Dt} + \div\left( \alpha_k \mbold u_k A P_k \right) - \mbold u_k \cdot \grad \left( \alpha_k A P_k \right) &= P_{int} A \left(\mbold u_{int}-\mbold u_k \right) \cdot \grad \alpha_k \nonumber \\
- \alpha_k P_k \mbold u_k \cdot \grad A 
 - \bar{P}_{int} A \mu_P \left(P_k-P_j \right) &+ A \lambda_u \left(\mbold u_j-\mbold u_k  \right) \cdot \left(\bar{\mbold u}_{int}-\mbold u_k \right)
\end{align}
In the next step, we assume the existence of a phase wise entropy $s_k$ function of the density $\rho_k$ and the internal energy $e_k$. Using the chain rule,
\begin{equation}
\frac{Ds_k}{Dt} = (s_\rho)_k \frac{D \rho_k}{Dt} + (s_e)_k \frac{De_k}{Dt},
\end{equation}
along with the internal energy and the continuity equations, the following entropy equation is obtained:
\begin{eqnarray}
\label{eq:ent1}
\alpha_k \rho_k A \frac{Ds_k}{Dt} + \underbrace{A \left( P_k (s_e)_k + \rho_k^2 (s_\rho)_k \right)\mbold u_k \cdot \grad \alpha_k + \alpha_k \left( P_k (s_e)_k + \rho_k^2 (s_\rho)_k \right) \mbold u_k \cdot \grad A}_\textrm{(a)} &= \nonumber\\
(s_e)_k P_{int}A \left[ (\mbold u_{int}-\mbold u_k)\cdot \grad \alpha_k - \bar{P}_{int} A \mu_P (P_k-P_j) + A \lambda_u (\bar{\mbold u}_{int}-\mbold u_k) \cdot (\mbold u_j-\mbold u_k)\right] &- \nonumber\\
\rho^2 (s_\rho)_k \left[ \mu_P A (P_k-P_j) + A(\mbold u_k-\mbold u_{int}) \cdot \grad \alpha_k\right] & 
\end{eqnarray}
where $(s_e)_k$ and $(s_\rho)_k$ denote the partial derivatives of the entropy $s_k$ with respect to the internal energy $e_k$ and the density $\rho_k$, respectively.
The second term, (a), in the left hand side of \eqt{eq:ent1} can be set to zero by assuming the following relation between the partial derivatives of the entropy $s_k$:
\begin{equation}
\label{eq:ent2}
 P_k (s_e)_k + \rho_k^2 (s_\rho)_k = 0 .
\end{equation} 
The above equation is equivalent to the application of the second thermodynamic law when assuming reversibility:
\begin{equation}
T_k ds_k = de_k - \frac{P_k}{\rho_k^2} d \rho_k \text{ with } (s_e)_k = \frac{1}{T_k} \text{ and } (s_\rho)_k = - \frac{P_k}{\rho_k^2} (s_e)_k
\end{equation}
Thus, equation \eqt{eq:ent1} can be rearranged using the relation $(s_\rho)_k = - \frac{P_k}{\rho_k^2} (s_e)_k$:
\begin{eqnarray}
\label{eq:ent3}
((s_e)_k)^{-1} \alpha_k \rho_k \frac{Ds}{Dt} = \underbrace{\left[ P_{int} (\mbold u_{int}-\mbold u_k) + P_k (\mbold u_k-\mbold u_{int}) \right] \cdot \grad \alpha_k}_\textrm{(b)} + \nonumber\\ 
\underbrace{\mu (P_k-P_j)(P_k-\bar{P}_{int})}_\textrm{(c)} + \underbrace{\lambda(\mbold u_j-\mbold u_k)\cdot(\bar{\mbold u}_{int}-\mbold u_k)}_\textrm{(d)}
\end{eqnarray}
The right hand side of equation \eqt{eq:ent3} is split into three terms (b), (c) and (d) that will be treated independently from each other. The terms (c) and (d) are simpler to start with and can be easily recast by using the definitions of $\bar{\mbold u}_{int}$ and $\bar{P}_{int}$ given in equation \eqt{eq:sev_equ2-app}:
\begin{eqnarray}
\label{eq:ent4}
\mu (P_k-P_j)(P_k-\bar{P}_{int}) = \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2\nonumber\\
\lambda(\mbold u_j-\mbold u_k)\cdot(\bar{\mbold u}_{int}-\mbold u_k) = \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j - \mbold u_k)^2 
\end{eqnarray}
By definition, $\mu_P$, $\lambda_u$ and $Z_k$ are all positive. Thus, the above terms are unconditionally positive. \\
It remains to look at the last term (b). Once again, by using the definition of $P_{int}$ and $\mbold u_{int}$, and the following relations:
\begin{eqnarray}
\label{eq:ent4bis}
\mbold u_{int}-\mbold u_k &=& \frac{Z_j}{Z_k+Z_j}(\mbold u_j-\mbold u_k) -  \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{Pk-P_j}{Z_k+Z_j} \nonumber\\
P_{int}-P_k &=& \frac{Z_k}{Z_k+Z_j} (P_j-P_k) - \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{Z_k Z_j}{Z_k+Z_j} (\mbold u_k-\mbold u_j), \nonumber 
\end{eqnarray}
(b) yields:
\begin{eqnarray}
\label{eq:ent5}
\left[ P_{int} (\mbold u_{int}-\mbold u_k) + P_k (\mbold u_k-\mbold u_{int}) \right] \cdot \grad \alpha_k = (P_{int}-P_k)(\mbold u_{int}-\mbold u_k)\cdot \grad \alpha_k=  \nonumber\\ \frac{Z_k}{\left( Z_k+Z_j \right)^2} \grad \alpha_k \cdot \left[ Z_j (\mbold u_j-\mbold u_k)(P_j-P_k)+\frac{\grad \alpha_k}{|| \grad \alpha_k ||} Z_j^2 (\mbold u_j-\mbold u_k)^2 \right. + \nonumber \\ \left. \frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)^2 +  \frac{\grad \alpha_k \cdot \grad \alpha_k}{|| \grad \alpha_k ||^2}(P_k-P_j)Z_j (\mbold u_k-\mbold u_j) \right] 
\end{eqnarray}
The above equation is factorized by $|| \grad \alpha_k ||$ and then recast under a quadratic form when noticing that $\frac{\grad \alpha_k \cdot \grad \alpha_k}{|| \grad \alpha_k ||^2} = 1$, which yields:
\begin{align}
\label{eq:ent6}
\left[ (\mbold u_{int}-\mbold u_k)P_{int} + (\mbold u_k-\mbold u_{int})P_k \right] \grad \alpha_k &=  \nonumber \\
|| \grad \alpha_k || \frac{Z_k }{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)\right.&+\left.\frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)\right]^2
\end{align}
Thus, using results from \eqt{eq:ent3}, \eqt{eq:ent4}, \eqt{eq:ent5} and \eqt{eq:ent6}, the entropy equation obtained in \cite{SEM} holds and is recalled here for convenience:
\begin{align}
(s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} &= \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2 + \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j -\mbold  u_k)^2 \nonumber
\\
& \frac{Z_k}{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)+\frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)\right]^2. \nonumber
\end{align}
\end{appendices}
\end{document}