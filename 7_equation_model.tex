%%
%% This is file `elsarticle-template-num.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% elsarticle.dtx  (with options: `numtemplate')
%% 
%% Copyright 2007, 2008 Elsevier Ltd.
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% -------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01

%\documentclass[preprint,12pt]{elsarticle}
\documentclass[preprint,10pt]{elsarticle}
%\documentclass[final,3p,times]{elsarticle} 

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
\usepackage{float}
\usepackage{color}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[titletoc,title]{appendix}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
%% \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols 
%% The amsthm package provides extended theorem environments
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathrsfs}
% more math
\usepackage{amsfonts}
\usepackage{amstext}
\usepackage{amsbsy}
\usepackage{mathbbol} 
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
\usepackage{lineno}

\journal{Journal of Comp. Phys.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% operators
\renewcommand{\div}{\mbold{\nabla}\! \cdot \!}
\newcommand{\grad}{\mbold{\nabla}}
\newcommand{\divv}[1]{\boldsymbol{\nabla}^{#1}\! \cdot \!}
\newcommand{\gradd}[1]{\mbold{\nabla}^{#1}}
\newcommand{\mbold}[1]{\boldsymbol#1}
% latex shortcuts
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bal}{\begin{align}}
\newcommand{\eali}{\end{align}}
\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\ben}{\begin{enumerate}}
\newcommand{\een}{\end{enumerate}}
\usepackage{amsthm}
\newtheorem*{remark}{Remark}
% DGFEM commands
\newcommand{\jmp}[1]{[\![#1]\!]}                     % jump
\newcommand{\mvl}[1]{\{\!\!\{#1\}\!\!\}}             % mean value
\newcommand{\keff}{\ensuremath{k_{\textit{eff}}}\xspace}
% shortcut for domain notation
\newcommand{\D}{\mathcal{D}}
% vector shortcuts
\newcommand{\vo}{\mbold{\Omega}}
\newcommand{\vr}{\mbold{r}}
\newcommand{\vn}{\mbold{n}}
\newcommand{\vnk}{\mbold{\mathbf{n}}}
\newcommand{\vj}{\mbold{J}}
\newcommand{\eig}[1]{\| #1 \|_2}
%
\newcommand{\EI}{\mathcal{E}_h^i}
\newcommand{\ED}{\mathcal{E}_h^{\partial \D^d}}
\newcommand{\EN}{\mathcal{E}_h^{\partial \D^n}}
\newcommand{\ER}{\mathcal{E}_h^{\partial \D^r}}
\newcommand{\reg}{\textit{reg}}
%
\newcommand{\norm}{\textrm{norm}}
\renewcommand{\Re}{\textrm{Re}}
\newcommand{\Pe}{\textrm{P\'e}}
\renewcommand{\Pr}{\textrm{Pr}}
%
\newcommand{\resi}{R}
%\newcommand{\resinew}{\tilde{D}_e}
\newcommand{\resinew}{\widetilde{\resi}}
\newcommand{\resisource}{\widetilde{\resi}^{source}}
\newcommand{\matder}[1]{\frac{\textrm{D} #1}{\textrm{D} t}}
%
\newcommand{\Gammakj}{\Gamma_{k \to j}}

% extra space
\newcommand{\qq}{\quad\quad}
% common reference commands
\newcommand{\eqt}[1]{Eq.~(\ref{#1})}                     % equation
\newcommand{\fig}[1]{Fig.~\ref{#1}}                      % figure
\newcommand{\tbl}[1]{Table~\ref{#1}}                     % table
\newcommand{\sct}[1]{Section~\ref{#1}}                   % section
\newcommand{\app}[1]{Appendix~\ref{#1}}                   % appendix
%
\newcommand{\ie}{i.e.,\@\xspace}
\newcommand{\eg}{e.g.,\@\xspace}
\newcommand{\psc}[1]{{\sc {#1}}}
\newcommand{\rs}{\psc{R7}\xspace}
%
\newcommand\br{\mathbf{r}}
%\newcommand{\tf}{\varphi}
\newcommand{\tf}{b}
%
\newcommand{\tcr}[1]{\textcolor{red}{#1}}
\newcommand{\tcb}[1]{\textcolor{blue}{#1}}
\newcommand{\mt}[1]{\marginpar{ {\tiny #1}}}
%
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   BEGIN DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%\title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}
%-------------------------
%-------------------------
\title{A Viscous Regularization for the Seven-Equation two-phase flow Model \tcr{feels like we should try to add low-Mach in the title}. \tcb{or all-Mach fluid flows instead of low-Mach flow}}
%-------------------------
%-------------------------
\author{Marc O. Delchini\fnref{label1}}
\ead{delchinm@email.tamu.edu}

\author{Jean C. Ragusa\corref{cor1}\fnref{label1}}
\ead{jean.ragusa@tamu.edu}

\author{Ray A. Berry\fnref{label2}}
\ead{ray.berry@inl.gov}

\address[label1]{Department of Nuclear Engineering, Texas A\&M University, College Station, TX 77843, USA \fnref{label1}}

\address[label2]{Idaho National Laboratory, Idaho Falls, ID 83415, USA \fnref{label2}}

\cortext[cor1]{Corresponding author}
%-------------------------
%-------------------------
%-------------------------
\begin{abstract}
In this paper, a viscous regularization is derived for the seven-equation two-phase flow model. The regularization ensures positivity of the entropy residual, uniqueness of the weak solution % when assuming concavity of the phasic entropy $s_k$, 
is consistent with the viscous regularization for Euler equations when one phase disappears, and does not depend on the spatial discretization scheme chosen. We also show that the viscous regularization is compatible with the generalized Harten entropies.
\end{abstract}
%-------------------------
%-------------------------
\begin{keyword}
  two-phase flow model \sep viscous regularization \sep artificial dissipative method \sep low-Mach regime \sep shocks 
\end{keyword}
%-------------------------
\end{frontmatter}

\linenumbers

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{sec:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{itemize}
%\item a few lines about the need for accurately resolving two-phase flows
%\item background on the different two-phase flow models: 5, 6 and 7-equation two-phase flow models
%\item then, focus on the different types of 7-equation two-phase flow models: they mostly differ because of the closure relaxations used
%\item discuss the different numerical solvers developed for the 7-equation two-phase flow model: HLL, HLLC, and approximated Riemann solvers accounting for the source terms
%\item emphasize the fact that the above numerical solvers only works on discontinuous schemes
%\item then, introduce the entropy viscosity method and details the organization of the paper 
%\end{itemize}
%
Compressible two-phase fluid flows are found in numerous industrial applications. Their numerical solution is an ongoing area of research in modeling and simulation. A variety of two-phase models, with different levels of complexity, has been developed; for instance, the five-equation model of Kapila \cite{Kapila_2001}, the six-equation model \cite{Toumi_1996}, and more recently the Seven-Equation Model  (SEM)\cite{SEM}. These models are all obtained by integrating the one-phase flow balance equations weighed by a characteristic or indicator function for each phase. The resulting system of equations contains non-conservative terms and relaxation terms that describe the interaction between phases, supplemented by an equation for the void fraction. 
%Once a system of equations describing the physics is derived, the next challenging step is to develop a robust and accurate discretization to obtain a numerical solution. 
The systems of two-phase flow equations are usually solved using discontinuous discretization schemes (finite volume and discontinuous Galerkin approaches). By assuming that the system of equations is hyperbolic, a Riemann solver could be used but is often ruled out because of its complexity due to the number of equations involved. Instead, approximate Riemann solvers, a well-established approach for single-phase flows, are employed \cite{Saurel_2001a, Saurel_2001b, Li_2004, Zein_2010, Ambroso_2012}\tcr{add citations pertaining to discretizations of 2-phase},  while ensuring the correct low-Mach asymptotic limit and deriving a consistent discretization scheme for the non-conservative terms \tcr{add the specific papers about low-mach and non-conserv terms here} \cite{Li_2004, Abgrall_2002} \tcb{done}.
%For example, Saurel et al. \cite{Saurel_2001a, Saurel_2001b} employed a HLL-type scheme to solve for the SEM but noted that excessive dissipation was added to the contact discontinuity. A more advanced HLLC-type scheme was developed in \cite{Li_2004} but only for the subsonic case and then extended to supersonic flows in \cite{Zein_2010}. More recently, Ambroso et al. \cite{Ambroso_2012} proposed an approximate Riemann solver accounting for source terms such as gravity and drag forces, but with no interphase mass transfer. Furthermore, careless approximation for the treatment of the non-conservative terms can lead to failure in computing the numerical solution \cite{Abgrall_2002}. 

In this paper, we derive a viscous regularization for the Seven-Equation two-phase flow Model  of \cite{SEM}. The foundation for this work can be traced back to viscous regularizations for single-phase Euler and Navier-Stokes equations, notably \cite{jlg} and the references therein. The proposed viscous regularization for the SEM is consistent with the entropy minimum principle and Harten's generalized entropies. In addition, we ensure that the regularization scales appropriately in the low-Mach regime as such situations are often  encountered in practical applications; the two-phase low-Mach asymptotic study determines conditions that need to be satisfied by the artificial dissipative terms to yield a well-scaled regularization in the low-Mach case \cite{Marco_paper_low_mach}. 

One of the key aspects of the viscous regularization derived here is that it is agnostic of the spatial discretization scheme, unlike approximate Riemann solvers. Therefore, this viscous regularization can be employed to stabilized numerical scheme both continuous and discontinuous discretizations. For examples of prior applications to the single-phase Euler equations, we refer the reader to \cite{jlg, valentin}. 

The remainder of the paper is as follows. In \sct{sec:7-equ-model}, the Seven-equation two-phase flow Model is recalled along with its main properties. The viscous regularization is derived in \sct{sec:visc-regu} and a study of the scaled regularized equations is performed in \sct{sec:low-Mach} with a focus on the low-Mach asymptotic limit. 
Finally, we conclude in \sct{sec:conclusion} where we outline possible leads on the definition of the viscosity coefficients involved in the viscous regularization derived in \sct{sec:visc-regu} and consistent with \sct{sec:low-Mach} \tcr{finish} \tcb{done}.

%. Lastly, the scaled Seven-Equation two-phase flow Model with viscous regularization are derived to give insights on what the scaling of the dissipative terms should be to ensure well-scaled dissipative terms for a wide range of Mach flows.
%
%This methodology was applied to the Seven-Equation two-phase flow Model (SEM) introduced by Berry et al. in \cite{SEM}. This model is known to be unconditionally hyperbolic which is highly desirable when working with approximate Riemann solvers and can treat a wide range of applications. Its particularity comes from the pressure and velocity relaxation terms in the void fraction, momentum and energy equations that can bring the two phases in equilibrium when using large values of the relaxation parameters. In other words, the Seven-Equation two-phase flow Model can degenerate into the six- and five-equation models. Alike for the other two-phase flow models, solving for the Seven-Equation two-phase flow Model requires a numerical solver and significant effort was dedicated to this task for spatially discontinuous schemes. Because each phase is assumed to obey the Euler equations, most of the numerical solvers are adapted from the single-phase approximate Riemann solvers. For example, Saurel et al. \cite{Saurel_2001a, Saurel_2001b} employed a HLL-type scheme to solve for the SEM but noted that excessive dissipation was added to the contact discontinuity. A more advanced HLLC-type scheme was developed in \cite{Li_2004} but only for the subsonic case and then extended to supersonic flows in \cite{Zein_2010}. More recently, Ambroso et al. \cite{Ambroso_2012} proposed an approximate Riemann solver accounting for source terms such as gravity and drag forces, but with no interphase mass transfer.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Seven-Equation two-phase flow Model}\label{sec:7-equ-model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{itemize}
%\item give the equations and detail the different terms
%\item include the relaxation terms, the mass and heat exchange terms
%\item eigenvalues
%\item entropy equation WITHOUT the dissipative terms and five the details of the derivation in the appendix
%\end{itemize}
%
The Seven-Equation two-phase flow Model employed in this paper is obtained by assuming that each phase satisfies the single-phase Euler equations (with phase-exchange terms) and by integrating the latter over a control volume after multiplication by a phasic characteristic function. The detailed derivation can be found in \cite{SEM} and we recall the SEM governing equations for phase $k$ in interaction with phase $j$. In the SEM, each phase obeys the following mass, momentum and energy balance equations, supplemented by a non-conservative equation for the void fraction:
%
\begin{subequations}\label{eq:liq-7-eqn-sect5}
\begin{align}
  % liquid void fraction
  \label{eqn:multi-d-7-eqn-liq-vol}
  \frac{\partial \alpha_{k} A}{\partial t} + A\mbold u_{int} \cdot \grad \alpha_{k}
  &= A \mu_P (P_{k} - P_{j}) - \frac{\Gammakj A_{int} A}{\rho_{int}} \,,
\end{align}
\begin{align}
  % liquid mass conservation
  \label{multi-d-7-equ-liq}
  \frac{\partial \left( \alpha \rho \right)_{k} A}{\partial t}
  + \div \left( \alpha \rho \mbold u A\right)_{k}
  &= - \Gammakj A_{int} A \,,
\end{align}
\begin{multline}
  % liquid momentum
  \frac{\partial \left( \alpha \rho \mbold u \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} A \left( \rho \mbold u \otimes \mbold u + P \mathbb{I} \right)_{k} \right]
  = P_{int} A \grad \alpha_{k} + P_{k} \alpha_{k} \grad A
  \\
  + A \lambda_u (\mbold u_{j} - \mbold u_{k})
  - \Gammakj A_{int} \mbold u_{int} A \,,
\end{multline}
\begin{multline}
  % liquid total energy
  \frac{\partial \left( \alpha \rho E \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} \mbold u_{k} A \left( \rho E + P \right)_{k} \right]
  = P_{int} A \mbold u_{int} \cdot \grad \alpha_{k} - \bar{P}_{int} A \mu_P (P_{k} - P_{j})
  \\
  + A \lambda_u \bar{\mbold u}_{int} \cdot (\mbold u_{j} - \mbold u_{k})
  + \Gammakj A_{int} \left( \frac{P_{int}}{\rho_{int}} - H_{k, int} \right) A  \,,
\end{multline}
\end{subequations}
%
where $\alpha_k$, $\rho_k$, $\mbold u_k$ and $E_k$ denote the void fraction, the density, the velocity vector and the total specific energy of phase $k$, respectively. The phasic pressure $P_k$ is computed from an equation of state. The cross section of the geometry is denoted by $A$ and is only spatially dependent. $A$ is present for completeness of the presentation and is set to 1 for most applications; however, nozzle flow problems can be solved using the one-dimensional version of the equation and setting $A$ to the cross-sectional area of the nozzle. The interfacial pressure and velocity and their corresponding average values are denoted by $P_{int}$, $\mbold u_{int}$, $\bar{P}_{int}$ and $\bar{\mbold u}_{int}$, respectively; they are defined in \eqt{eq:int_variables_def}.
\tcb{I do not know if we should keep the mass, momentum and energy exchange terms in the equations since they are not included in the derivations of the viscous regularization.} 
%
\begin{subequations}
\label{eq:int_variables_def}
\begin{align}
  \label{E-R:83}
  P_{int} &= \bar{P}_{int} + \frac{Z_{k}Z_{j}}{Z_{k}+Z_{j}} \frac{\grad \alpha_{k}}{|| \grad \alpha_{k} ||} \cdot (\mbold u_{j}-\mbold u_{k}) \,,
  \\
  \bar{P}_{int} &= \frac{Z_{j}P_{k}+Z_{k}P_{j}}{Z_{k}+Z_{j}} \,,
 \\
  \label{E-R:84}
  \mbold u_{int} &= \bar{\mbold u}_{int} +  \frac{\grad \alpha_{k}}{|| \grad \alpha_{k} ||} \frac{P_{j}-P_{k}}{Z_{k}+Z_{j}} \,,
  \\
  \bar{\mbold u}_{int} &= \frac{Z_{k} \mbold u_{k}+Z_{j}\mbold u_{j}}{Z_{k}+Z_{j}} \,.
\end{align}
\end{subequations}
%
The interfacial specific total enthalpy of phase $k$, $H_{k,int}$, is defined as $H_{k,int} = h_{k,int} + 0.5 || \mbold u_{int} ||^2$, where $h_{k,int}$ is the phasic specific enthalpy evaluated at the interface conditions $(P_{int} \text{ and } T_{int} = T_{sat}(\bar{P}_{int}))$. Following \cite{SEM}, the pressure and velocity relaxation coefficients, $\mu_P$  and $\lambda_u$ respectively, are function of the acoustic impedance $Z_k = \rho_k c_k$ and the specific interfacial area $A_{int}$ as shown in \eqt{eq:relaxation_coeff}.
%
\begin{subequations}
\label{eq:relaxation_coeff}
\begin{align}
  \label{E-R:86}
  \mu_P &= \frac{A_{int}}{Z_{k}+Z_{j}}       \,,
  \\
  \label{E-R:85}
  \lambda_u &= \frac{1}{2} \mu_P Z_{k} Z_{j} \,.
\end{align}
\end{subequations}
%
The specific interfacial area (i.e., the interfacial surface area per unit
volume of a two-phase mixture), $A_{int}$, is typically dependent upon flow regime conditions and can be provided as a correlation. In \cite{SEM}, $A_{int}$ is chosen to be a function of the liquid void fraction:
%
\begin{equation}\label{eq:Aint-sect4}
A_{int} = A_{int}^{max} \left[ 6.75 \left(1-\alpha_{liq} \right)^2 \alpha_{liq} \right],
\end{equation}
% 
with $A_{int}^{max} = 5100$ $m^2 / m^3$. With this definition, the interfacial area is zero in the limits $\alpha_{k} = 0$ and $\alpha_{k} = 1$. Lastly, $\Gammakj$ is the net mass transfer rate per unit interfacial area from phase $k$ to phase $j$ \tcr{not the opposite?} \tcb{done}. Its expression, given in \eqt{eq:mass_transfer}, is obtained by considering a vaporization/condensation process that is dominated by heat diffusion at the interface \cite{SEM, BerryMarco_2014}:
%
\begin{align} \label{eq:mass_transfer}
  \Gammakj = \frac{h_{T,  k} \left( T_{k} - T_{int} \right) + h_{T,  j} \left( T_{j} - T_{int} \right)}{L_v \left( T_{int} \right)} ,
\end{align}
%
where $L_v \left( T_{int} \right) = h_{j,  int} - h_{k,  int}$
represents the latent heat of vaporization.  The interface
temperature is determined by the saturation constraint
$T_{int}=T_{sat}(P)$ with the appropriate pressure $P=\bar{P}_{int}$
defined previously. The interfacial heat transfer coefficients for phases $k$ and $j$ are denoted by $h_{T,  k}$ and $h_{T,  j}$, respectively, and are computed from correlations \cite{SEM}. 

The set of equations satisfied by phase $j$ are simply obtained by substituting $k$ by $j$ and $j$ by $k$ in \eqt{eq:liq-7-eqn-sect5}, keeping the same definition of the interfacial variables and noting that $\Gammakj = - \Gamma_{jk}$. The equation for the void fraction of phase $j$ is simply replaced by the algebraic relation
%
\begin{align}
 \alpha_{j}= 1 - \alpha_{k}, \nonumber
\end{align}
%
which reduces the number of partial differential equations from eight to seven and yields the Seven-Equation two-phase flow Model. 

Some properties of the Seven-Equation two-phase flow Model are discussed next. A set of $5+2\mathbb{D}$ (with $\mathbb{D}$ the geometry dimension) waves is present in the model: two acoustic waves per phase, one contact wave per phase per domain dimension, and one void fraction wave propagating at the interfacial velocity $\mbold u_{int}$. These waves (eigenvalues of the Jacobian for the inviscid flux terms) and as follows for each phase $k$:
% 
\begin{align}\label{eq:eigenvalues}
&\lambda_{1,k} = \mbold u_k \cdot \bar{\mbold n} - c_k \nonumber\\
&\lambda_{2,k} = \mbold u_k \cdot \bar{\mbold n} + c_k \nonumber\\
&\lambda_{2+d,k} = \mbold u_k \cdot \bar{\mbold n} \text{ for } d = 1 \dots \mathbb{D} \\
&\lambda_{3+\mathbb{D}} = \mbold u_{int} \cdot \bar{\mbold n} \nonumber \,,
\end{align}
%
where $\bar{\mbold n}$ is an unit vector pointing to a given direction. The eigenvalues given in \eqt{eq:eigenvalues} are unconditionally real (as long as the equation of state yields a real-valued sound speed). Having real eigenvalues is an extremely valuable property for the development of numerical methods since it ensures that the system of equations is hyperbolic and well-posed. 

One may relax the Seven-Equation two-phase flow Model to
the ill-posed classical six-equation model, where a single pressure 
is used for both phases; this is
accomplished by letting the pressure relaxation coefficient $\mu_P$ become
very large, i.e., by letting it approach infinity.  Note that as the pressure
relaxation coefficient increases, so does the velocity
relaxation coefficient $\lambda_u$; see \eqt{eq:relaxation_coeff}. 
However, the six-equation model only relaxes the pressure parameter of the SEM and results
in an ill-posed system of equations that can present unstable numerical solutions
with sufficiently fine spatial resolution \cite{SEM,Herrard_2005}. 
%
If one lets both the pressure and the velocity relaxation parameters tend to infinity, this further relaxes the
Seven-Equation two-phase flow Model to the hyperbolic and well-posed 
mechanical equilibrium five-equation model of Kapila \cite{Kapila_2001}.  
%The five-equation
%model provides a very useful starting point for constructing
%multi-dimensional interface resolving methods which dynamically
%captures evolving and spontaneously generated
%interfaces~\cite{Saurel_2009}. Thus the Seven-Equation two-phase flow Model
%can be relaxed locally to couple seamlessly with such a
%multi-dimensional, interface resolving code. 
%Numerically, the relaxation coefficients $\mu_P$
%(pressure) and $\lambda_u$ (velocity) may be relaxed independently to
%yield solutions to useful, reduced models.  However, It
%is noted that relaxation of pressure only by making $\mu_P$
%large without relaxing velocity will indeed give ill-posed and
%unstable numerical solutions, just as the classical six-equation
%two-phase model does, with sufficiently fine spatial resolution, as
%confirmed in~\cite{SEM,Herrard_2005}. 

Next, we consider the SEM model with pressure and velocity relaxation but omit phase exchange terms ($\Gammakj=0$):
\begin{subequations}\label{eq:liq-7-eqn-sect5_no_exchange}
\begin{align}
  % liquid void fraction
  \label{eqn:multi-d-7-eqn-liq-vol_no_exchange}
  \frac{\partial \alpha_{k} A}{\partial t} + A\mbold u_{int} \cdot \grad \alpha_{k}
  &= A \mu_P (P_{k} - P_{j}) \,,
\end{align}
\begin{align}
  % liquid mass conservation
  \label{multi-d-7-equ-liq_no_exchange}
  \frac{\partial \left( \alpha \rho \right)_{k} A}{\partial t}
  + \div \left( \alpha \rho \mbold u A\right)_{k}
  &= 0 \,,
\end{align}
\begin{multline}
  % liquid momentum
  \frac{\partial \left( \alpha \rho \mbold u \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} A \left( \rho \mbold u \otimes \mbold u + P \mathbb{I} \right)_{k} \right]
  = P_{int} A \grad \alpha_{k} \\ + P_{k} \alpha_{k} \grad A
  + A \lambda_u (\mbold u_{j} - \mbold u_{k})\,,
\end{multline}
\begin{multline}
  % liquid total energy
  \frac{\partial \left( \alpha \rho E \right)_{k} A}{\partial t}
  + \div \left[ \alpha_{k} \mbold u_{k} A \left( \rho E + P \right)_{k} \right]
  = P_{int} A \mbold u_{int} \cdot \grad \alpha_{k} \\ - \bar{P}_{int} A \mu_P (P_{k} - P_{j})
  + A \lambda_u \bar{\mbold u}_{int} \cdot (\mbold u_{j} - \mbold u_{k}) \,.
\end{multline}
\end{subequations}
%
An entropy equation can be derived for each phase $k$ of system \eqt{eq:liq-7-eqn-sect5_no_exchange}
%
and the sign of the entropy material derivative can be proved positive. The entropy function for a phase $k$ is denoted by $s_k$ and a function of density $\rho_k$ and internal energy $e_k$. The full derivation is given in \app{app:sev-equ-model-entropy} and only the final result is recalled here:
%
\begin{align}\label{eq:ent-eqn-7-eqn-model}
(s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} &= \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2 + \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j -\mbold  u_k)^2 \nonumber
\\
& \frac{Z_k}{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)+\frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)\right]^2 \ ,
\end{align}
where $\frac{D(\cdot) }{Dt} = \partial_t (\cdot) + \mbold u \cdot \grad (\cdot)$ is the material derivative.
The partial derivative of the entropy function $s_k$ with respect to the internal energy $e_k$, $(s_e)_k$, is shown to be proportional to the inverse of the temperature of phase $k$, as in the case of the single phase Euler equations \cite{jlg, Marco_dissertation}. The right-hand side of \eqt{eq:ent-eqn-7-eqn-model} is unconditionally positive since all terms are squared and thus, is used to demonstrate the entropy minimum principle. Furthermore, \eqt{eq:ent-eqn-7-eqn-model} is valid for both phases $\left\{k, j\right\}$ and ensures positivity of the total entropy equation that is obtained by summation over the phases:
%
\begin{equation}\label{eq:tot-ent-res-sct4}
\sum_k (s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} = \sum_k (s_{e})_k^{-1} \alpha_k \rho_k A \left( \partial_t s_k + \mbold u_k \cdot \grad s_k \right) \geq 0  .
\end{equation}
%
Note that when one phase disappears, \eqt{eq:tot-ent-res-sct4} degenerates to the single-phase entropy equation obtained from Euler equations \cite{SEM, Marco_dissertation}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A viscous regularization for the Seven-Equation two-phase flow Model}\label{sec:visc-regu}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
We now propose to derive a viscous regularization for the Seven-Equation two-phase flow Model given in \eqt{eq:liq-7-eqn-sect5} by using the same methodology as for the multi-dimensional Euler equations with/without variable area \cite{jlg, Marco_paper_low_mach}. The method consists in adding dissipative terms to the system of equation under consideration, and re-derive the entropy equation whose sign is known to be positive to ensure uniqueness of the numerical solution \cite{Leveque}. Because of the addition of dissipation terms, the entropy equation is modified and contains extra terms of yet unknown sign. By carefully choosing a definition for each of the dissipation term, the sign of the entropy equation can be determined and proved positive. For the Seven-Equation two-phase flow Model, derivation of a viscous regularization can be achieved by considering either the phasic entropy equation (\eqt{eq:ent-eqn-7-eqn-model}) or the total entropy equation (\eqt{eq:tot-ent-res-sct4}). In the later case, the entropy minimum principle is verified for the whole system which may not ensure positivity of the entropy equation for each phase. However, positivity of the total entropy equation can be also achieved by assuming that the entropy minimum principle holds for each phase. This stronger requirement will also ensure consistency with the single phase Euler equations when one of the phase disappears in the limit $\alpha_k \to 0$. Thus, it is chosen to work with the phasic entropy equations given in \eqt{eq:ent-eqn-7-eqn-model}.

For the purpose of this section, the system of equations given in \eqt{eq:sev_equ} is considered, which is obtained by simply omitting the mass source terms (terms proportional to $\Gammakj$) in \eqt{eq:liq-7-eqn-sect5}.
%
\begin{subequations}\label{eq:sev_equ}
\begin{align}
\partial_t \left( \alpha_k  A\right) + A \mbold u_{int} \cdot \grad \alpha_k = A \mu_P \left( P_k - P_j \right)
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = 0
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k &+ A \lambda_u \left( \mbold u_j - \mbold u_k \right)
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &=\nonumber\\
A P_{int} \mbold u_{int} \cdot \grad \alpha_k - \mu_P \bar{P}_{int} A \left( P_k-P_j \right) &+ A \lambda_u \bar{\mbold u}_{int} \cdot \left( \mbold u_j - \mbold u_k \right)
\end{align}
\end{subequations}
%
%where $\rho_k$, $u_k$, $E_k$ and $P_k$ are the density, the velocity, the specific total energy and the pressure of $k^{th}$ phase, respectively. The pressure and velocity relaxation parameters are denoted by $\mu$ and $\lambda$, respectively. The variables with index $_I$ correspond to the interfacial variables and a definition for those can be found in \cite{SEM}. The cross-section $A$ is only function of space: $\partial_t A = 0$.
In order to apply the entropy viscosity method, dissipation terms are added to each equation yielding:
%
\begin{subequations}\label{eq:sev_equ-with-diss-terms}
\begin{align}\label{eq:sev_equ-with-diss-terms-vf}
\partial_t \left( \alpha_k  A\right) + A \mbold u_{int} \cdot \grad \alpha_k = A_{int} A \mu_P \left( P_k - P_j \right) + \div \mbold l_k
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-cont}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = \div \mbold f_k
\end{align}
\begin{multline}\label{eq:sev_equ-with-diss-terms-mom}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] =\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k + A \lambda_u \left( \mbold u_j - \mbold u_k \right) + \div \mathbb{g}_k
\end{multline}
\begin{multline}\label{eq:sev_equ-with-diss-terms-ener}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] = \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k -
\mu_P A  \bar{P}_{int} \left( P_k-P_j \right) + \\
A \lambda_u \bar{\mbold u}_{int} \cdot \left( \mbold u_j - \mbold u_k \right)
+ \div \left( \mbold h_k + \mbold u \cdot \mathbb{g}_k \right)
\end{multline}
\end{subequations}
%
where $\mbold f_k$, $\mathbb{g}_k$, $\mbold h_k$ and $\mbold l_k$ are phasic viscous terms to be determined. The next step consists in deriving the entropy equation for the phase $k$, on the same model as what was done in \app{app:sev-equ-model-entropy} but with dissipative terms now present. The steps are as follows:
%
\begin{enumerate}
\item derive the phasic density and internal energy equations from \eqt{eq:sev_equ-with-diss-terms}.
\item assuming that the phasic entropy, $s_k$, is a function of density, $\rho_k$ and internal energy, $e_k$, derive the entropy equation by using the chain rule:
\begin{equation}
\label{eq:chain_rule-sct4}
\frac{Ds_k}{Dt} = \left( s_{\rho} \right)_k \frac{D \rho_k}{Dt} + \left( s_{e} \right)_k \frac{D e_k}{Dt} 
\end{equation}
The terms $(s_e)_k$ and $(s_{\rho})_k$ denote the partial derivative of the entropy $s_k$ with respect to $e_k$ and $\rho_k$, respectively.
\item isolate the terms of interest and choose an appropriate expression for each of the dissipation terms in order to ensure positivity of the new entropy residual.
\end{enumerate}
%
We first derive the phasic density equation for the primitive variable $\rho_k$ by combining \eqt{eq:sev_equ-with-diss-terms-vf} and \eqt{eq:sev_equ-with-diss-terms-cont} to obtain:
%
\begin{equation}\label{eq:rho-7-eqn-model-sect4}
\alpha_k A \left[ \partial_t \rho_k + \left( \mbold u_k - \underline{\underline{\mbold u_{int}}} \right) \cdot \grad \rho_k \right] = \underline{\underline{A \rho_k \mu_P \left( P_k - P_j \right)}} + \div \mbold f_k - \rho_k \div \mbold l_k
\end{equation}
%
In order to derive the phasic internal energy equation, the phasic velocity equation is obtained by subtracting the phasic density equation from the phasic momentum equation:
%
\begin{align}\label{eq:vel-7-eqn-model-sect4}
\alpha_k \rho_k  A \left[ \partial_t \mbold u_k + \mbold u_k \cdot \div \mbold u_k \right]  + \div \left( \alpha_k \rho_k A P_k \mathbb{I} \right) &=\nonumber\\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k + A \lambda \left( \mbold u_j - \mbold u_k \right) &+ \div \mathbb{g}_k - \mbold u_k \otimes \mbold f_k
\end{align}
%
After multiplying \eqt{eq:vel-7-eqn-model-sect4} by the phasic velocity vector $\mbold u_k$, the resulting phasic kinetic energy equation is subtracted from the phasic total energy equation to obtain the internal energy equation for phase $k$:
%
\begin{multline}\label{eq:int-ener-7-eqn-model-sect4}
\alpha_k \rho_k  A \left[ \partial_t \mbold e_k + \mbold u_k \cdot \div \mbold e_k \right]  + \alpha_k \rho_k A P_k \grad \mbold u_k = \\
\underline{\underline{P_{int} A \left(\mbold u_{int}-\mbold u_k \right) \cdot \grad \alpha_k}} -  \underline{\underline{\alpha_k P_k \mbold u_k \cdot \grad A}} \\ 
\underline{\underline{-\bar{P}_{int} A \mu_P \left(P_k-P_j \right)}} + \underline{\underline{A \lambda_u \left(\mbold u_j-\mbold u_k  \right) \cdot \left(\bar{\mbold u}_{int}- \mbold u_k \right)}}\\
+ \div \mbold h_k + \mathbb{g}_k : \grad \mbold u_k + || \mbold u ||^2_k \mbold f_k
\end{multline}
%
The underline terms in \eqt{eq:rho-7-eqn-model-sect4} and \eqt{eq:int-ener-7-eqn-model-sect4} yield the positive terms in the right-hand-side of \eqt{eq:ent-eqn-7-eqn-model} and thus are ignored in the remainder of this derivation for brevity. The phasic entropy equation is now obtained by combining the phasic density equation (\eqt{eq:rho-7-eqn-model-sect4}) and the phasic internal energy equation (\eqt{eq:int-ener-7-eqn-model-sect4}) through the chain rule given in \eqt{eq:chain_rule-sct4} to yield:
%
\begin{multline}\label{eq:ent-res-7-eqn-diss-terms}
\alpha_k \rho_k A \frac{Ds_k}{Dt} =  (\rho s_\rho)_k \left[ \div \mbold f_k - \rho_k \div \mbold l_k \right] + \\
\left(s_e\right)_k \left[ \div \mbold h_k + \mathbb{g}_k : \grad \mbold u_k +  \left( || \mbold u ||^2_k - e_k\right) \div \mbold f_k  \right],
\end{multline}
%
where it was assumed that the entropy of phase $k$ satisfies the second thermodynamic law: 
%
\begin{subequations}
\begin{align}\label{eq:2nd-therm-laws-sect4}
T_k \text{d} s_k = \text{d}e_k - P_k\frac{\text{d}\rho_k}{\rho_k^2} \ ,
\end{align}
\text{which implies } 
\begin{align}
&P_k (s_e)_k + \rho_k (s_\rho)_k = 0, \\
&(s_e)_k = T_k^{-1} \text{ and } (s_\rho)_k = - (s_e)_k P_k \frac{\text{d}\rho_k}{\rho_k^2}. \nonumber
\end{align}
\end{subequations}
% 
%\eqt{eq:2nd-therm-laws-sect4} is also used to compute the partial derivative of the entropy with respect to the density, $(s_\rho)_k$, and the internal energy, $(s_e)_k$, if needed.

Following the methodology applied in \cite{jlg, Marco_paper_low_mach}, the right-hand side of \eqt{eq:ent-res-7-eqn-diss-terms} can be further simplified by using the following expression
for the dissipative terms $\mbold f_k$,  $\mathbb{g}_k$ and $\mbold h_k$:
%
\begin{subequations}\label{eq:def-diss-terms-sect4}
\begin{align}
  \mbold f_k &= \tilde{\mbold f}_k + \rho_k \mbold  l_k 
  \\
  \mathbb{g}_k &= \alpha_k \rho_k A \mu_k \mathbb{F}(\mbold u_k) + \mbold f_k \otimes \mbold u_k
  \\
  \mbold h_k &= \tilde{\mbold h}_k - \frac{|| \mbold u_k||^2 }{2} \mbold f_k + (\rho e)_k \mbold l_k,
\end{align}
\end{subequations}
%
where $\mu_k$ is a positive viscosity coefficient for phase $k$. Note the area function $A$ in the definition of $\mathbb{g}_k$. Substituting the expression of the dissipative terms given in \eqt{eq:def-diss-terms-sect4} into \eqt{eq:ent-res-7-eqn-diss-terms} yields:
%
\begin{multline}\label{eq:ent-res-7-eqn-diss-terms2}
\alpha_k \rho_k A \frac{Ds_k}{Dt} = \underbrace{\div \left[ (s_e)_k\tilde{\mbold h}_k + \Big( e_k( s_e)_k - \rho_k (s_\rho)_k \Big) \tilde{\mbold f}_k \right]}_{{\mathcal{R}_0}} \\
\underbrace{ \left(s_e\right)_k \alpha_k \rho_k A \mu_k \mathbb{F}(\mbold u_k) : \grad \mbold u_k}_{\mathcal{R}_1} 
\underbrace{-\tilde{\mbold h}_k \cdot \grad (s_e)_k  - \tilde{\mbold f}_k \cdot \grad \left[ \right( e s_e \left)_k - (\rho s_\rho)_k \right]}_{\mathcal{R}_2} + \\
\underbrace{(s_e)_k \div \left( \rho_k e_k \mbold l_k \right) -  (s_e)_k e_k \div \left( \rho_k \mbold l_k \right) + \rho_k (s_\rho)_k \div \left( \rho_k \mbold l_k \right) 
  - \rho_k^2 (s_\rho)_k \div \mbold l_k}_{\mathcal{R}_3}.
\end{multline}
%
We now split the right-hand-side of \eqt{eq:ent-res-7-eqn-diss-terms2} into three residuals denoted by $\mathcal{R}_1$, $\mathcal{R}_2$ and $\mathcal{R}_3$ and we study the sign of each of them. Since $(s_e)_k$ is defined as the inverse of the temperature and thus is positive, the sign of the first term, $\mathcal{R}_1$, is conditioned by the choice of the function $\mathbb{F}(\mbold u_k)$ so that the product with the tensor $\grad \mbold u_k$ is positive. As in \cite{jlg, Marco_paper_low_mach}, $\mathbb{F}(\mbold u_k)$ is chosen proportional to the symmetric gradient of the velocity vector $\grad^s \mbold u_k$, whom entries are given by $\left( (\grad^s \mbold u)_{i,j} \right)_k = \frac{1}{2} \left( \partial_{x_i} u_i + \partial_{x_j} u_j \right)_k$. With such a choice, the viscous regularization is also rotationally invariant.
%Such a choice ensures the associated dissipative terms to be rotationally invariant and also positivity of $\mathcal{R}_1$. An other option would be to simply set $\mathbb{F}(\mbold u_k)$ proportional to $\grad \mbold u_k$ which allows to recover the parabolic regularization \cite{Parabolic} but does not ensure rotational invariance. 
%
After a few lines of algebra, the third term ${\mathcal{R}_3}$ can be recast as a function of the gradient of the entropy as follows:
\begin{align}
 \label{eq:ent-R3-sct4}
  \mathcal{R}_3  =  \rho_k A \mbold l_k \cdot \grad s_k.
\end{align} 
One of the assumptions made in the entropy minimum principle is to that the entropy 
is at a minimum which implies that its gradient is null. Because of this, it follows that
the term $\mathcal{R}_3$ is zero at the minimum and thus, the entropy minimum principle is verified
independently of the definition of the dissipation term $\mbold l_k$ used in the void fraction
equation \eqt{eq:sev_equ-with-diss-terms-vf}. It will be explained later in this section how to obtain a definition for $\mbold l_k$.

We now focus on the term denoted by $\mathcal{R}_2$, which is identical to the right-hand-side of the single phase entropy equation for Euler equations (see \cite{jlg, Marco_paper_low_mach}). Thus, the term $\mathcal{R}_2$ is known to be positive when (i) assumes concavity of the entropy function $s_k$ with respect to the internal energy $e_k$ and the specific volume $1 / \rho_k$ (or convexity of $-s_k$) and (ii) chooses the following definitions for the dissipative terms $\tilde{h}_k$ and $\tilde{f}_k$:
%
\begin{subequations}
\begin{align}\label{eq:def_visc}
&\tilde{\mbold f}_k = \alpha_k A \kappa_k \grad \rho_k \\
&\tilde{\mbold h}_k = \alpha_k A \kappa_k \grad \left( \rho e \right)_k,
\end{align}
\end{subequations}
%  
where $\kappa_k$ is another positive viscosity coefficient. In addition, using \eqt{eq:def_visc}, the term $\mathcal{R}_0$ can be recast as a function of the phasic entropy as follows: 
%
\begin{equation}
\mathcal{R}_0 = \div \left( \alpha_k A \kappa_k \rho_k \grad s_k \right)
\end{equation}
%
The entropy equation can now be written in its final form:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms3}
&\alpha_k \rho_k A \frac{Ds_k}{Dt} =  \mbold f_k \cdot \grad s_k + \div \left( \alpha_k A \rho_k \kappa_k  \grad s_k \right)  \nonumber\\
&- \alpha_k \rho_k A \kappa_k \mathbf{Q}_k + (s_e)_k \alpha_k A \rho_k \mu_k \grad^s \mbold u_k : \grad \mbold u_k,
\end{align}
%
where $\mathbf{Q}_k$ is a negative semi-definite quadratic form under the assumption of $s_k$ being concave with respect to $e_k$ and $1/ \rho_k$, and defined as:
%
\begin{eqnarray}
\mathbf{Q}_k &=& X^t_k \Sigma_k X_k \nonumber \\
\text{with } X_k &=& \begin{bmatrix}
\grad \rho_k \\
\grad e_k 
\end{bmatrix}
\text{and } \Sigma_k = \begin{bmatrix}
       \rho_k^{-2} \partial_{\rho_k} (\rho^2_k \partial_{\rho_k} s_k) & \partial_{\rho_k,e_k} s_k  \\[0.3em]
       \partial_{\rho_k,e_k} s_k & \partial_{e_k,e_k} s_k           \\[0.3em]
     \end{bmatrix}. \nonumber 
\end{eqnarray}
%
\eqt{eq:ent-res-7-eqn-diss-terms3} is used to prove the entropy minimum principle: assuming that $s_k$ reaches its minimum value in $\mbold r_{min}(t)$ at each time $t$, the gradient, $\grad s_k$, and Laplacian, $\Delta s_k$,  of the entropy are null and positive at this particular point, respectively. Furthermore, it is recalled that the viscosity coefficients $\mu_k$ and $\kappa_k$ are positive by definition. Then, because the terms in the right-hand-side of \eqt{eq:ent-res-7-eqn-diss-terms3} are proven either positive or null when the entropy reaches a minimum value, the entropy minimum principle holds for each phase $k$, \textbf{independently of the definition of the dissipative term} $\mbold l_k$, such as:
%
\begin{equation}\label{eq:ent-res-7-eqn-diss-terms4}
\alpha_k \rho_k A \partial_t s_k(\mbold r_{min},t)) \geq 0 \Rightarrow \partial_t s_k(\mbold r_{min},t)) \geq 0 \nonumber
\end{equation}
%
\tcb{Do we need to make the above statement a theorem or property?}

It remains to obtain a definition for the
dissipative term $\mbold l_k$ used in the void fraction equation \eqt{eq:sev_equ-with-diss-terms-vf}. A way to achieve this is to
consider the void fraction equation, by itself and notice that it is an hyperbolic equation
with eigenvalue $\mbold u_{int}$. An entropy equation can be derived and used to prove the
entropy minimum principle by properly choosing the dissipative term. The objective is to
ensure positivity of the void fraction and also uniqueness of the weak solution. Following
the work of Guermond et al. in \cite{jlg1, jlg2}, it can be shown that a dissipative term ensuring positivity and
uniqueness of the weak solution for the void fraction equation, is of the form $\mbold l_k = \beta_k A \grad \alpha_k $, where $\beta_k$
is a positive viscosity coefficient. The dissipative term is proportional to the area $A$ for consistency with the other terms of the void fraction equation \eqt{eq:sev_equ-with-diss-terms-vf}.

All of the dissipative terms are now defined and recalled here:
%
\begin{subequations}\label{eq:visc-reg-7-equ-sect4}
\begin{align}
  \mbold l_k &= \beta_k A \grad \alpha_k 
\end{align}
\begin{align}
  \mbold f_k &= \alpha_k A \kappa_k \grad \rho_k + \rho_k A \mbold l_k 
\end{align}
\begin{align}
\mathbb{g}_k &= \alpha_k A \mu_k \rho \grad^s \mbold u_k 
\end{align}
\begin{align}
  \mbold h_k &=  \alpha_k A \kappa_k \grad \left( \rho e \right)_k + \mbold u_k : \mathbb{g}_k - \frac{|| \mbold u_k||^2}{2} \mbold f_k + (\rho e)_k \mbold l_k 
\end{align}
\end{subequations}
%
At this point, some remarks are in order:
\begin{enumerate}
%\item {The viscous regularization given in \eqt{eq:visc-reg-7-equ-sect4} for the multi-dimensional Seven-Equation two-phase flow Model, is equivalent to the parabolic regularization \cite{Parabolic} when assuming $\beta_k = \kappa_k = \mu_k$ and $\mathbb{F}(\mbold u_k) = \alpha_k \rho_k \kappa_k \grad \mbold u_k$, but is no longer rotation invariant. However, decoupling between the regularization on the velocity and on the density in the momentum equation is important to make the regularization rotation invariant but also to ensure well-scaled dissipative terms for a wide range of Mach number as was shown in \cite{Marco_paper_low_mach} for the multi-dimensional Euler equations.}
\item {The dissipative term $\mbold l_k$ requires the definition of a new viscosity
    coefficient $\beta_k$. It was shown that this viscosity coefficient is independent of
    the other viscosity coefficients $\mu_k$ and $\kappa_k$. Its definition should
    account for the eigenvalue $\mbold u_{int}$ and  the entropy equation associated with the void fraction equation.}
%    In addition, an entropy residual can be determined by analogy to Burger's
%    equation.}
%    It is noted, however, that the eigenvalue $\mbold u_{int}$ can be discontinuous
%    since its definition involves the sign of the void fraction gradient, which
%    makes the theory more challenging. For simplicity, we ignore this aspect of the
%    theory in this report.\tcr{maybe for a report, but here you should say a bit more}}

\item {The dissipative term $\mbold f_k$ is a function of $\mbold l_k$. Thus, all of the other
    dissipative terms are also functions of $\mbold l_k$.}

\item {The partial derivatives $(s_e)_k$ and $(s_{\rho_k})_k$ can be computed using the
    definition provided in \eqt{eq:2nd-therm-laws-sect4} and are functions of the phasic thermodynamic
    variables: pressure, temperature and density.}

\item {All of the dissipative terms are chosen to be proportional to the void
    fraction $\alpha_k$ and the cross-sectional area $A$, except the one in the void fraction equation that is only proportional to $A$. For instance, $\alpha_k A \grad \rho_k$ is the
    flux of the dissipative term in the continuity equation through the pseudo-area, $\alpha_k A$, seen
    by the phase $k$. When one of the phases disappears, the dissipative terms
    must go to zero for consistency. On the other hand, when $\alpha_k$ goes to one,
    the single-phase Euler equations with variable area and with proper viscous regularization must be recovered. }    

\item{By choosing $\beta_k = \mu_k = \kappa_k$ and $\mathbb{F}(\mbold u_k) = \grad \mbold u_k$, the dissipative terms collapse as follows: 
\begin{subequations}\label{eq:sev_equ-parab}
\begin{align}\label{eq:sev_equ-parab-vf}
\partial_t \left( \alpha_k  A\right) + A \mbold u_{int} \cdot \grad \alpha_k = A \mu_P \left( P_k - P_j \right) + \div \left[ A \kappa_x \grad \alpha_k \right]
\end{align}
\begin{align}\label{eq:sev_equ-parab-cont}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = \div \left[ A \kappa_k \grad \left( \alpha \rho \right)_k \right]
\end{align}
\begin{multline}\label{eq:sev_equ-parab-mom}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] = \\
\alpha_k P_k \grad A + P_{int} A \grad \alpha_k + \div \left[ A \kappa_k \grad \left( \alpha \rho \mbold u  \right)_k \right] 
\end{multline}
\begin{multline}\label{eq:sev_equ-parab-ener}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] = \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k -
\mu_P \bar{P}_{int} \left( P_k-P_j \right) + 
A \lambda_u \bar{\mbold u}_{int} \cdot \left( \mbold u_j - \mbold u_k \right)  \\
+ \div \left[A \kappa_k \grad \left( \alpha \rho E \right)_k \right] \ ,
\end{multline}
\end{subequations}
to yield a viscous regularization that is analogous to the parabolic regularization for Euler equations \cite{Parabolic}. Note that by choosing $\mathbb{F}(\mbold u_k) = \grad \mbold u_k$, the above viscous regularization is no longer rotationally invariant.
}
    
\item{Compatibility of the viscous regularization proposed in \eqt{eq:visc-reg-7-equ-sect4} with the generalized entropies identified in Harten et al. \cite{Harten} is demonstrated in \app{app:harden}. } 

\tcb{ \item{We could add a paragraph explaining that the above viscous regularization can also be used for the five-equation model of Kapila with some very light modifications.} }
\end{enumerate}
%
At this point in the paper, we have derived a viscous regularization for the Seven-Equation two-phase flow Model that ensures positivity of the entropy residual, uniqueness of the numerical solution when assuming concavity of the phasic entropy $s_k$, and is consistent with the viscous regularization derived for the multi-dimensional Euler equations \cite{jlg, Marco_paper_low_mach} in the limit $\alpha_k \to 1$. The viscous regularization involves a set of three viscosity coefficients for each phase, $\mu_k$, $\kappa_k$ and $\beta_k$, that are assumed positive. Definition of the viscosity coefficients should be devised from the scaled SEM in order to ensure well-scaled dissipative terms for a wide range of Mach numbers (subsonic, transonic and supersonic flows).
%
\begin{remark}
Through the derivations of the viscous regularization, it was noted that another set of dissipative terms $\mbold f_k$ and $\mbold l_k$ would also ensures positivity of the entropy residual:
%
\begin{subequations}
\begin{align}\label{eq:def-l-k-wrong-sect4}
\mbold l_k =\beta_k T_k \left[ \frac{\rho_k}{P_k+\rho_k e_k} \grad \left( \frac{P_k}{\rho_k e_k} \right) - \frac{1}{P_k} \grad \rho_k \right]
\end{align}
\begin{align}
\mbold f_k = \kappa_k \grad \rho_k +  \frac{\rho^2_k (s_{\rho})_k}{\left( \rho s_{\rho} - e s_e \right)_k} \mbold l_k
\end{align}
\end{subequations}
%
However, the definition of $\mbold l_k$ proposed in \eqt{eq:def-l-k-wrong-sect4} was not considered as valid for the following reasons: positivity of the void fraction cannot be achieved and the parabolic regularization is not retrieved when assuming equal viscosity coefficients.
\end{remark}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{An all-speed formulation of the Entropy Viscosity Method}\label{sec:low-Mach}
\section{The scaled Seven-Equation two-phase flow Model with viscous regularization}\label{sec:low-Mach}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{itemize}
%\item non-dimensionalize the equations but use $P_\infty$ for the pressure instead of $(\rho c^2)_\infty$
%\item introduce a new Pechlet number for $\beta$: its behavior should be the same as the Pechlet number for $\kappa$
%\item two cases: zero and infinite relaxation coefficients
%\item derive the normalization parameters for the isentropic and non-isentropic flows
%\item discussion about the 
%\end{itemize}
%
When working with artificial dissipative numerical stabilization methods, great care needs to be carried to the definition of the viscosity coefficients that will determine the accuracy of the method. Generally speaking, sufficient artificial viscosity should be added into the shock and discontinuity regions to prevent spurious oscillations from forming, while little dissipation is added when the numerical solution is smooth to ensure high-order accuracy. In addition, the low-Mach asymptotic limit also has to be accounted for in the definition of the viscosity coefficients in order to recover the incompressible asymptotic equations \cite{LowMach1, LowMach2, LowMach3}. The purpose of this section is to derive the scaled SEM and investigate the scaling of the dissipative terms to ensure well-scaled dissipative terms for all-Mach flows (subsonic, transonic and supersonic flows). First, the scaled SEM are derived and then, two limit cases (a) and (b) will be considered to determine appropriate scaling for the entropy 
viscosity coefficients so that the dissipative terms remain well-scaled for: 
(a) the isentropic low-Mach limit where the Seven-Equation two-phase flow Model degenerate to an incompressible system of 
equations in the low-Mach limit and (b) the non-isentropic limit with formation of shocks. Finally, for each case the scaling of the numerical adimensional numbers will be given. Also, because each phase can experience different flow regime e.g., supersonic gas and subsonic liquid, it is chosen to work with three distinct viscosity coefficients for each phase. The study is performed on the multi-dimensional version of the Seven-Equation two-phase flow Model with the Stiffened Gas Equation of State (SGEOS) given in \eqt{eq:SGEOS_bis}.
%
\begin{equation}\label{eq:SGEOS_bis}
P_k = \left( \gamma_k-1 \right) \rho_k e_k - \gamma_k P_{k,\infty}
\end{equation}
%
%how to define the phasic viscosity coefficients, $\mu_k$ and $\kappa_k$ by analogy to some numerical methods used for the single-phase Euler equations i.e. Lapidus \cite{Lapidus_paper, Lapidus_book} or pressure-based method \cite{PBV_book}. On the other hand, the viscosity coefficient, $\beta_k$, for the void fraction equation should rely on artificial dissipation stabilization methods used for scalar hyperbolic equations. We also apply the approach used in \cite{Marco_paper_low_mach} to devise a definition of the viscosity coefficients that ensures the correct numerical solution in the low-Mach limit, can accurately resolves shocks in transonic and supersonic flows and is also consistent with the definition of the viscosity coefficients devised for the single-phase Euler equations in the limit $\alpha_k \to 1$. 
%As a result, the approach used in \cite{Marco_paper_low_mach} will be applied here in this section. 
%
%Since the focus of this paper is the entropy viscosity method, the viscosity coefficients will be defined function of entropy residuals in \sct{sec:low-Mach}. However, one can also devise a definition for the viscosity coefficients $\mu_k$ and $\kappa_k$ by analogy to Lapidus \cite{Lapidus_paper, Lapidus_book} or some pressure-based methods \cite{PBV_book} used for the single-phase Euler equations. On the other hand, the viscosity coefficient, $\beta_k$, for the void fraction equation should rely on artificial dissipation stabilization methods used for scalar hyperbolic equations. These aspects are also investigated in \sct{sec:low-Mach}.
%
%------------------------------------------------------------------------------------------------------
\subsection{Derivation of the scaled Seven-Equation two-phase flow Model}\label{sec:scaled-SEM}
%------------------------------------------------------------------------------------------------------
%Developing a numerical method for fluid equations require to investigate the low-Mach asymptotic limit. In this particular limit, numerical methods developed for transonic and supersonic flows usually fail due to ill-scaled dissipative terms. A fix can be found by performing a low-Mach asymptotic limit to ensure well-scaled dissipative terms \cite{LowMach1, LowMach2, LowMach3}. Then, it is proposed to perform a low-Mach asymptotic limit to derive a definition for the phasic normalization parameters introduced in \sct{sec:visc-coeff-sem}. 
We consider the case where the relaxation coefficients are set to zero:  
%Two limit $1$-D cases are considered: the relaxation coefficients are set (i) to very large values and (ii) to zero. In the later case, 
the two phases do not interact and the Seven-Equation two-phase flow Model degenerates into two sets of Euler equations with a pseudo cross-section $\alpha_k A$. 
%In the former case, the infinite relaxation coefficients make the seven-equation two-phase model degenerates into the five-equation model of Kapila by ensuring pressure and velocity equilibrium. 
%Two limit cases (a) and (b) will be considered to determine appropriate scaling for the entropy 
%viscosity coefficients so that the dissipative terms remain well-scaled for: 
%(a) the isentropic low-Mach limit where the Seven-Equation two-phase flow Model degenerate to an incompressible system of 
%equations in the low-Mach limit and (b) the non-isentropic limit with formation of shocks. 
%In the low-Mach limit, the isentropic limit of the Seven-Equation two-phase flow Model with viscous regularization should yield incompressible 
%fluid flow solutions (the Seven-Equation two-phase flow Model was derived by assuming that each phase obeys the multi-dimensional Euler equations), namely, that the phasic pressure fluctuations are of the 
%order $M^2_k$ and that the velocity satisfies the divergence constraint $\div ( \vec{u} A)_k = 0$ 
%\cite{LowMach1, LowMach2, LowMach3}. For non-isentropic situations, shocks may form for any 
%value of Mach number (a step initial pressure will always yield a shock wave) and the minimum entropy principle should still be satisfied so that numerical 
%oscillations, if any, be controlled by the entropy viscosity method independently of the value of the Mach number.
%%
%\begin{equation}\label{eq:SGEOS_bis}
%P_k = \left( \gamma_k-1 \right) \rho_k e_k - \gamma_k P_{k,\infty}
%\end{equation}
%
The first step in the study of the two limit cases (a) and (b) is to re-write each system of equations in a non-dimensional manner. To do so, the following variables are introduced for each phase $k$:
%
\begin{multline}
\label{eq:norm_param}
\rho_k^*   = \frac{\rho_k}{\rho_{k,\infty}}           ,\
u_k^*      = \frac{\mbold u_k}{u_{k,\infty}}                 ,\
P_k^*      = \frac{P_k}{\rho_{k,\infty} c^2_{k,\infty}}   ,\
E_k^*      = \frac{E_k}{c^2_{k,\infty} }              ,\
x^* = \frac{x}{L_\infty}                      ,\\
t_k^* = \frac{t_k}{L_\infty / u_{k,\infty}}           ,\
\mu_k^*    = \frac{\mu_k}{\mu_{k,\infty}}             ,\
\kappa_k^* = \frac{\kappa_k}{\kappa_{k,\infty}}       ,\
P_{int}^*    = \frac{P_{int}}{P_{int,\infty}}             ,\\
u_{int}^* = \frac{\mbold u_{int}}{u_{int,\infty}}       ,\
\bar{P}_{int}^*    = \frac{\bar{P}_{int}}{\bar{P}_{int,\infty}}             ,\
\bar{u}_{int}^* = \frac{\bar{u}_{int}}{\bar{u}_{int,\infty}}       ,\
\end{multline}
%
where  the subscript $\infty$ denote the far-field or stagnation quantities and the superscript $*$ stands for the non-dimensional variables. The far-field reference quantities are chosen such that the dimensionless flow quantities are of order 1. The stagnation quantities for the pressure and velocity interfacial variables will be specified for each case. The reference phasic Mach number is given by
%
\begin{equation}
M_{k,\infty} = \frac{u_{k,\infty}}{c_{k,\infty}}.
\end{equation}
%
Because we consider that phases do not interact with each other, it is assumed that the interfacial pressure and velocity scale as the phasic pressure and velocity, respectively: $P_{int,\infty} = \rho_{k,\infty} c^2_{k,\infty}$ and $u_{int,\infty} = u_{k,\infty}$. Under these assumptions, the interfacial pressure and velocity are simply replaced by $P_k$ and $\mbold u_k$ in the equations. Then, the system of equations with viscous regularization becomes:
% 
\begin{subequations}\label{eq:sev_equ_case_one}
\begin{align}\label{eq:sev_equ-with-diss-terms-vf_one}
\partial_t \left( \alpha_k  A\right) + A \mbold u_k \cdot \div \alpha_k =  \div \left( A \beta_k \grad \alpha_k \right)
\end{align}
\begin{align}\label{eq:sev_equ-with-diss-terms-cont_one}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = \div \left( A \alpha_k \kappa_k \grad \rho_k \right)  + \div \left( A \beta_k \rho_k \grad \alpha_k \right)
\end{align}
\begin{multline}\label{eq:sev_equ-with-diss-terms-mom_one}
\partial_t \left( \alpha_k \rho_k u_k A \right) + \div \left[ \alpha_k A \left( \rho_k  \mbold u_k \otimes \mbold u_k + P_k \right) \right] =\\
\alpha_k P_k \grad A + P_k A \grad \alpha_k + \div \left(A \mu_k \alpha_k  \rho_k \grad^s \mbold u_k \right) + \\
\div \left(A \kappa_k \alpha_k \mbold u_k \otimes \grad \rho_k \right) + \div \left( A \beta_k \rho_k \mbold u_k \otimes \grad \alpha_k \right)
\end{multline}
\begin{multline}\label{eq:sev_equ-with-diss-terms-ener_one}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] = \\
P_k A \mbold u_k\cdot \grad \alpha_k + \div \left( A \kappa_k \alpha_k \grad \left( \rho_k e_k \right) \right) +
\div \left( A \kappa_k \alpha_k \frac{||\mbold u_k||^2}{2} \grad \rho_k \right) + \\ \div \left( A \mu_k \alpha_k \rho_k \mbold u_k : \grad^s \mbold u_k\right) +
\div \left(A \beta_k \rho_k e_k \grad \alpha_k\right)
\end{multline}
\end{subequations}
%
Then using the scaling introduced in \eqt{eq:norm_param}, the scaled equations for the phase $k$ with viscous regularization are:
%\tcb{The following set of equations is very painful to read. I guess we can improve the format but I cannot think of a better way of presenting the scaled equations, unless we include all of this in an appendix (I am not for it)}
% 
\begin{subequations}\label{eq:sev_equ_case_one_scaled}
\begin{align}\label{eq:sev_equ-with-diss-terms-vf_case_one_scaled}
\partial_{t^*} \left( \alpha_k  A\right)^* + A^* \mbold u_k^* \cdot \grad^* \alpha_k^* =  \frac{1}{\Pe_{k,\infty}^\beta} \div^* \left( A \beta_k \grad^* \alpha_k \right)^*
\end{align}
\begin{multline}\label{eq:sev_equ-with-diss-terms-cont_case_one_scaled}
\partial_{t^*} \left( \alpha_k \rho_k A \right)^* + \div^* \left( \alpha_k \rho_k \mbold u_k A \right)^* = \\ \frac{1}{\Pe^\kappa_{k,\infty}}\div^* \left(A \kappa_k \grad^* \rho_k \right)^* +
\frac{1}{\Pe_{k,\infty}^\beta} \div^* \left( A \beta_k \rho_k \grad^* \alpha_k \right)^*
\end{multline}
\begin{multline}\label{eq:sev_equ-with-diss-terms-mom_case_one_scaled}
\partial_{t^*} \left( \alpha_k \rho_k u_k A \right)^* + \div^* \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k\right)\right]^* + \frac{A \alpha_k^*}{M^2_{k,\infty}}\grad^* P_k^* = \\
\frac{1}{M^2_{k,\infty}} \alpha_k^* P^*_k \grad^* A^* + \frac{1}{M^2_{k,\infty}} P_k^* A^* \grad^* \alpha_k^* +
\frac{1}{\Re_{k,\infty}}\div^* \left( A \alpha_k \mu_k \rho_k \grad^s \mbold u_k \right)^* \\ + \frac{1}{\Pe_{k,\infty}^\kappa} \div^*\left( A \alpha_k \kappa_k  \mbold u_k \otimes \grad^* \rho_k \right)^* + 
\frac{1}{\Pe_{k,\infty}^\beta} \div^* \left( A \beta_k \rho_k \mbold u_k \otimes \grad \alpha_k \right)^*
\end{multline}
\begin{multline}\label{eq:sev_equ-with-diss-terms-ener_case_one_scaled}
\alpha_k^* A^* \left[ \partial_t \left(  \rho_k E_k \right) + \mbold u_k \cdot \grad^* \left( \rho_k E_k \right) \right]^*+  \alpha_k \div^* \left(A \mbold u_k P_k \right) + \rho_k^* E_k^* \alpha_k^* \div^* \left( \mbold u A \right)_k^* = \\
\frac{1}{\Pe_{k,\infty}^\kappa} \div^* \left( A \alpha_k \kappa_k \grad \left( \rho_k e_k \right) \right)^* + \frac{M^2_{k,\infty}}{\Pe_{k,\infty}^\kappa} \div^* \left( A\alpha_k \kappa_k \frac{||\mbold u_k||^2}{2} \grad \rho \right)^* + \\
\frac{M^2_{k,\infty}}{\Re_{k,\infty}} \div^* \left( A \alpha_k \mu_k \rho_k \mbold u_k : \grad^s \mbold u_k\right)^* + 
\frac{1}{\Pe_{k,\infty}^\beta } \grad \left( \rho_k e_k \right)^* \cdot \left(A \beta_k \grad \alpha_k \right)^* \\ - \frac{M_{k,\infty}^2}{\Pe_{k,\infty}^\beta} \rho_k \frac{|| \mbold u_k^2 ||}{2} \div \left( \beta_k A \grad \alpha_k \right)
\end{multline}
\end{subequations}
%
where the phasic numerical Reynolds ($\Re_{k,\infty})$ and P\'eclet ($\Pe_{k,\infty}^\kappa$ and $\Pe_{k,\infty}^\beta$) numbers are defined as:
%
\begin{equation}
\label{eq:ref_numb}
\Re_{k,\infty} = \frac{u_{k,\infty} L_\infty}{\mu_{k,\infty}} \ ,
\Pe_{k,\infty}^\kappa = \frac{u_{k,\infty} L_\infty}{\kappa_{k,\infty}} \text{ and }
\Pe_{k,\infty}^\beta = \frac{u_{k,\infty} L_\infty}{\beta_{k,\infty}} \ .
\end{equation}
%
Note that the phasic energy equation was recast under a non-conservative form by using the void fraction equation (\eqt{eq:sev_equ-with-diss-terms-vf_case_one_scaled}) to facilitate the derivations when trying to recover the divergence constraint onto the velocity in the low-Mach asymptotic regime.
The numerical Reynolds and P\'eclet numbers defined in \eqt{eq:ref_numb} are related to the phasic entropy 
viscosity coefficients $\mu_{k,\infty}$, $\kappa_{k,\infty}$ and $\beta_{k,\infty}$. Thus, once a scaling (in powers of $M_{k,\infty}$) 
is obtained for $\Re_{k,\infty}$, $\Pe_{k,\infty}^\kappa$ and $\Pe_{k,\infty}^\beta$ in the two limit cases (a) and (b), it will impose a condition onto the definition of the phasic viscosity coefficients $\mu_k$, $\kappa_k$ and $\beta_k$. For brevity, the superscripts $^*$ are omitted in the remainder of this section.  
%------------------------------------------------------------------------------------------------------
\subsection{Scaling of $\Re_{k,\infty}$, $\Pe_{k,\infty}^\kappa$ and $\Pe_{k,\infty}^\beta$ in the low-Mach asymptotic regime (case (a))}\label{sec:low-Mach-sem}
%------------------------------------------------------------------------------------------------------
In the low-Mach isentropic limit, the Seven-Equation two-phase flow Model 
converges to an incompressible system of equations, that is characterized for each phase with pressure fluctuations of order $M^2_{k,\infty}$ and the divergent constraint on the velocity: $\div \left(A \mbold u_k \right) = 0$. When adding dissipative 
terms, as is the case with the entropy viscosity method, the main properties of the low-Mach asymptotic limit must be preserved.
We begin by expanding each variable in powers of the Mach number. As an example, the expansion for the pressure is given by:
%
\begin{equation}
\label{eq:expansion}
P_k(\mbold r, t) = P_{k,0}(\mbold r, t) + P_{k,1}(\mbold r, t) M_{k,\infty} + P_{k,2}(\mbold r, t) M_{k,\infty}^2 + \dots 
\end{equation}
%
By studying the resulting momentum equations for various powers of $M_\infty$, it is observed that the 
leading- and first-order pressure terms, $P_{k,0}$ and $P_{k,1}$, are spatially constant if and only 
if $\Re_{k,\infty} = \Pe_{k,\infty}^\kappa = \Pe_{k,\infty}^\beta = 1$. In this case, we have
%
\begin{subequations}\label{eq:asympt_equ1}
at order $M_{k,\infty}^{-2}$:
\begin{equation}
\label{eq:asympt_equ1_cont}
\grad P_{k,0} = 0
\end{equation}
%
and at order $M_{k,\infty}^{-1}$
\begin{equation}
\label{eq:asympt_equ1_mom}
\grad P_{k,1} = 0 \, .
\end{equation}
\end{subequations}
%
From \eqt{eq:asympt_equ1} we infer that the leading- and first-order pressure terms are spatially independent which ensures pressure fluctuations of order Mach number square, as expected in the low-Mach asymptotic limit.
Using the scaling $\Re_{k,\infty} = \Pe_{k,\infty}^\kappa = \Pe_{k,\infty}^\beta = 1$, the second-order momentum equations and the leading-order expressions for the void fraction, continuity and energy equations are:
\begin{subequations}
\label{eq:asympt_equ2}
%
\begin{equation}\label{eq:asympt_equ2_vf}
\partial_t \left( A \alpha_k \right)_0  + \mbold u_{k,0} \cdot \grad \alpha_{k,0} = \div \left( A \beta_k \grad \alpha_k \right)_0
\end{equation}
%
\begin{equation}
\label{eq:asympt_equ2_cont}
 \partial_t \left( A \alpha_k \rho_k\right)_0 + \div ( A \alpha_k \rho_k \mbold u_k )_0 = \div (A \alpha_k \kappa_k \grad \rho_k )_0 + \div \left( A \beta_k \grad \alpha_k \right)_0
\end{equation}
%
\begin{multline}
\label{eq:asympt_equ2_mom}
\partial_t (\alpha_k A \rho_k \mbold u_k)_0 + \div ( A \alpha_k\rho_k \mbold u_k \otimes \mbold u_k)_0 +A \alpha_k \grad P_{k,2} = \\
\div \left[A \alpha_k \left( \mu_k \rho_k \grad^s \mbold u_k + \kappa_k \mbold u_k \otimes \grad \rho_k \right) \right]_0 + \div \left( A \beta_k \rho \mbold u \grad \alpha_k \right)_0
\end{multline}
%
\begin{multline}
\label{eq:asympt_equ2_ener}
\alpha_{k,0} A \left[ \partial_t( \rho_k E_k) + \mbold u_k  \cdot \grad \left(\rho_k E_k\right) \right]_0 + \alpha_{k,0} \div \ \left[ A \mbold u_k P_k \right]_0 + \\ \alpha_{k,0} \rho_{k,0} E_{k,0} \div \ \left( \mbold u_k A \right)_0 = 
 \div \left[A \alpha_k \kappa_k \grad\left(\rho_k e_k\right) \right] \\ + A \beta_{k,0} \grad \left( \rho_k e_k \right)_0 \cdot \grad \alpha_{k,0}
\end{multline}
%
\end{subequations}
%
where the notation $(fg)_0$ means that we only keep the 0$^{\text{th}}$-order terms in the product $fg$. The set of equations given in \eqt{eq:asympt_equ2} are similar to the multi-dimensional single-phase Euler equations with variable area when seeing $A \alpha_k$ as a pseudo-area \cite{Marco_paper_low_mach}. The leading-order of the Stiffened Gas Equation of State (\eqt{eq:SGEOS_bis}) is given by 
%
\begin{equation}
\label{eq:leading_order_sgeos}
 P_{k,0} = (\gamma_k - 1) \rho_{k,0} E_{k,0} - \gamma P_{k,\infty}  = (\gamma_k - 1) \rho_0 e_{k,0} - \gamma_k P_{k,\infty} \,.
\end{equation}
% 
Using \eqt{eq:leading_order_sgeos}, the energy equation can be recast as a function of the leading-order pressure, $P_0$, as follows:
%
\begin{multline}\label{eq:asympt_equ3_ener}
A \alpha_{k,0} \left[ \partial_t \left( P_k \right) + (\gamma_k-1)\mbold u_k \cdot \grad  P_k \right]_0 + \\ (\gamma_k-1) \alpha_{k,0} \div \left[ A \mbold u_k P_k \right]_0 +
\alpha_{k,0} \left( P_{k,0} + \gamma_k P_{k\infty} \right) \div \left( \mbold u_k A\right)_0 = \\
\left[ \div(A \alpha_k \kappa_k \grad(P_k))_0 + A \beta_{k,0} \grad P_{k,0} \cdot \grad \alpha_{k,)} \right]  \,.
\end{multline}
%
From \eqt{eq:asympt_equ1_cont}, we infer that $P_0$ is spatially constant. Thus, \eqt{eq:asympt_equ3_ener} becomes
%
\begin{equation}\label{eq:div_free_energy}
\frac{A}{\gamma\left( P_{k,0} + P_{k,\infty} \right)} \frac{d P_0}{dt} = - \div \left( \mbold u_k A \right)_0 
\end{equation}
%
and, at steady state, we have
%
\begin{equation}
% \gamma P_0 \div  \vec{u}_0 = 0 \Rightarrow \div  \vec{u}_0 = 0.
\div \left( \mbold u_k A \right)_0  = 0 \, .
\end{equation}
%
That is, the leading-order of the product of velocity and cross section is divergence-free which corresponds to what is obtained when dealing with the multi-dimensional Euler equations with variable area. Note that when assuming a constant cross section $A$, the usual divergence constraint, $\div \mbold u_{k,0}$ is recovered. Also, \eqt{eq:div_free_energy} is slightly modified due to the use of the Stiffened Gas Equation of State in the asymptotic limit. However, the Ideal Gas Equation of State degenerates from the Stiffened Gas Equation of State by simply setting $P_{k,\infty}=0$ which yields the usual leading-order single-phase energy equation with constant cross section:
%
\begin{equation}
\frac{1}{\gamma P_{k,0}} \frac{d P_0}{dt} = - \div\mbold u_{k,0} 
\end{equation}
%
The same reasoning can be applied to the leading-order 
of the continuity equation (\eqt{eq:asympt_equ2_cont}) to show that the material derivative of the density variable is stabilized by well-scaled dissipative terms:
\begin{multline}
\left. \matder{\alpha_k \rho_k}\right|_0 := \partial_t \left( \alpha_k \rho\right)_0 + \mbold u_{k,0} \cdot \div \left( \alpha_k \rho_k \right)_0 =\\
\frac{1}{A}  \div \left[ \alpha_k A \kappa_k \grad \rho + A \beta_k \rho_k \grad \alpha_k \right]_0 \, .
\end{multline}
%
Therefore, we conclude that by setting the Reynolds and P\'eclet numbers to one, the incompressible fluid 
results are retrieved in the low-Mach limit when employing the compressible Seven-Equation two-phase flow Model with viscous regularization and without relaxation terms.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Scaling of $\Re_{k,\infty}$, $\Pe_{k,\infty}^\kappa$ and $\Pe_{k,\infty}^\beta$ for non-isentropic flows (case (b))}\label{eq:non_isent_flows}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Next, we consider the non-isentropic case. Recall that even subsonic flows can present shocks (for instance, 
a step initial condition in the pressure will trigger shock formation, independently of the Mach number). 
The non-dimensional form of the Seven-Equation two-phase flow Model given in \eqt{eq:sev_equ_case_one_scaled} provides some insight on the 
dominant terms as a function of the Mach number. This is particular obvious in the momentum equation, \eqt{eq:sev_equ-with-diss-terms-mom_case_one_scaled}, 
where the gradient of pressure is scaled by $1/M_{k,\infty}^2$. In the non-isentropic case, we no longer 
have $\frac{\grad P_k}{M_{k,\infty}^2}=\grad P_{k,2}$ and therefore the pressure gradient term may need to be stabilized by 
some dissipative terms of the same scaling so as to prevent spurious oscillations from forming. 
By inspecting the dissipative terms presents in the momentum equation, having a dissipative term that 
scales as $1/M_{k,\infty}^2$ leads to a total of eight different options. Only three of them are investigated for brevity (note that the five other options can be ruled out by following the same reasoning as what is done next):
%
\begin{align}
&(i) \ \Re_{k,\infty} = 1 \ , \Pe_{k,\infty}^\kappa = M_{k,\infty}^2 \text{ and } \Pe_{k,\infty}^\beta = 1 \ , \nonumber \\
&(ii) \ \Re_{k,\infty} = 1 \ , \Pe_{k,\infty}^\kappa = 1 \text{ and } \Pe_{k,\infty}^\beta = M_{k,\infty}^2 \text{ or } \nonumber \\
&(iii) \ \Re_{k,\infty} = M_{k,\infty}^2 \ , \Pe_{k,\infty}^\kappa = 1 \text{ and } \Pe_{k,\infty}^\beta = 1 \ . \nonumber
\end{align}
%
Any of these choices will also affect the stabilization of the void fraction, continuity and energy equations. 
For instance, using P\'eclet numbers equal to $M_{k,\infty}^2$ may effectively stabilize the void fraction and continuity 
equations in the shock region but this may also add an excessive amount of dissipation for subsonic 
flows at the location of the contact wave. Such a behavior may not be suitable for accuracy purpose, 
making options (i) and (ii) inappropriate. The same reasoning, left to the reader, can be carried out 
for the energy equation (\eqt{eq:sev_equ-with-diss-terms-ener_case_one_scaled}) and results in the same conclusion. The remaining 
choice, option (iii), has the proper scaling: in this case, only the dissipation terms involving 
$\gradd{s,*} \mbold u_k^*$ scale as $1/M_{k,\infty}^2$ since $\Re_{k,\infty} = M_{k,\infty}^2$, leaving the 
regularization of the void fraction and continuity equations unaffected because $\Pe_{k,\infty}^\beta = \Pe_{k,\infty}^\kappa =1$.
\tcb{I feel we need another short section to explain how the two above limit cases ca be merge into one}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{An all-speed formulation of the viscosity coefficients}\label{eq:visc-formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%The study of the above limit cases yields two different possible scalings for the phasic Reynolds number: 
%$\Re_{k,\infty} = 1$ in the low-Mach limit and $\Re_{k,\infty}  = M_{k,\infty}^2$ for non-isentropic flows, 
%whereas the phasic numerical P\'eclet numbers ($\Pe_{k,\infty}^\kappa$ and $\Pe_{k,\infty}^\beta$) always scales as one. In order to have a stabilization method 
%valid for a wide range of Mach numbers, from very low-Mach to supersonic flows, these two scalings should 
%be combined in a unique definition. 
%
%We begin with the  normalization parameter $\norm_{P,k}^\kappa$. Using the 
%definition of the viscosity coefficients given in \eqt{eq:visc_definition-sct4} and the scaling of 
%\eqt{eq:norm_param}, it can be shown that:
%%
%\begin{equation}
%\label{eq:norm_relation}
%\kappa_{k,\infty} = \frac{ \rho_{k,\infty} c_{k,\infty}^2 u_{k,\infty} L_{k,\infty} }{ \norm_{k,P,\infty}^{\kappa} } \, ,
%\end{equation}
%%
%where $\norm_{k,P,\infty}$ is the reference far-field quantity for the normalization parameter $\norm_{k,P}$. 
%Substituting \eqt{eq:norm_relation} into \eqt{eq:ref_numb} and recalling that the phasic numerical P\'eclet 
%number scales as unity, we obtain:
%%
%\begin{equation}
%\label{eq:norm_relation_bis}
%\norm_{k,P,\infty}^{\kappa} = \Pe_{k,\infty} \rho_{k,\infty} c_{k,\infty}^2 = \rho_{k,\infty} c_{k,\infty}^2 \, .
%\end{equation}
%%
%\eqt{eq:norm_relation_bis} provides a proper normalization factor to define the $\kappa_k$ viscosity coefficient.
%%
%The derivation for $\norm_{k,P}^\mu$ is similar and yields
%\begin{align}
%\label{eq:norm_ent2}
%&\norm_{k,P,\infty}^\mu = \Re_{k,\infty} \rho_{k,\infty} c_{k,\infty}^2 =  \nonumber \\ 
%& \ \ \ \ \ \ \ \ \ \left\{
%\begin{array}{ll}
% \rho_{k,\infty} ||u_{k,\infty} ||^2       & \text{ for non-isentropic flows} \\
% \rho_{k,\infty} c_{k,\infty}^2 & \text{ for low-Mach flows}
%\end{array}
%\right. \,.
%\end{align}
%A smooth function to transition between these two states is as follows: % the shifted sigmoid function
%\begin{equation}
%% \sigma(M) = \frac{1}{1+\exp\big(-(M-M^\text{thresh})\big)} \,,
% \sigma(M_k) = \frac{\tanh\big(a_k(M_k-M_k^\text{thresh})\big) + | \tanh\big(a_k(M_k-M_k^\text{thresh})\big) | }{2} \,,
%\end{equation}
%where $M_k^\text{thresh}$ is a phasic threshold Mach number value beyond which the flow is no longer 
%considered  to be low-Mach (we use $M_k^\text{thresh}=0.05$), $M_k$ is the local Mach number, 
%and the scalar $a_k$ determines how rapidly the transition from  
%$\norm_{k,P,\infty}^\mu= \rho_k c_k^2$ to $\norm_{k,P}^\mu=\rho_k \| \mbold u_k \|^2$ occurs in the vicinity of $M_k^\text{thresh}$ (we use $a_k = 3$). 
%It is easy to verify that
%\begin{equation}
%\label{eq:norm_ent3}
%\norm_{k,P}^\mu = (1-\sigma(M_k)) \rho_k c_k^2  + \sigma(M_k)  \rho_k ||\mbold u_k ||^2  
%\end{equation}
%satisfies \eqt{eq:norm_ent2}.
%
%It remains to determine the normalization parameter, $\norm_{\alpha,k}^\beta$, for the viscosity coefficient $\beta_k$, by using the scaling of the P\'eclet number $\Pe_{k,\infty}^\beta$ derived from the low-Mach asymptotic limit. Following the same reasoning as above, it yields:
%%
%\begin{equation}
%\label{eq:norm_relation_beta}
%\norm_{k,\alpha,\infty}^\beta = 1 \ ,
%\end{equation}
%%
%where $\norm_{k,\alpha,\infty}$ is the reference far-field quantity for the normalization parameter $\norm_{\alpha,k}$ used in the definition of the viscosity coefficient $\beta_k$ (\eqt{eq:def-beta-sen-sect4}). The normalization parameter scales as one. Then, it is chosen to use the same scaling as for Burger's equation \cite{jlg2} e.g.
%%
%\begin{equation}
%\label{eq:norm_relation_beta2}
%\norm_{k,\alpha}^\beta =  || \eta (\alpha_k) - \bar{\eta}(\alpha_k) ||_\infty\ ,
%\end{equation}
%%
%where $\bar{\eta}$ is the average value of the entropy $\eta$ over the entire computational domain.
%
%At this point of the paper, we have derived a viscous regularization for the Seven-Equation two-phase flow Model consistent with the entropy minimum principle, and defined viscosity coefficients for all-Mach flows. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We derived a viscous regularization for the well-posed Seven-Equation two-phase flow Model that ensures positivity of the entropy residual, uniqueness of the numerical solution when assuming concavity of the phasic entropy $s_k$, is consistent with the viscous regularization derived for the multi-dimensional Euler equations in the limit $\alpha_k \to 1$ and does not depend on the scheme discretization. It was also shown that the viscous regularization is compatible with the generalized Harten entropies that were initially derived for Euler equations. The viscous regularization involves a set of three positive viscosity coefficients for each phase, $\beta_k$, $\mu_k$ and $\kappa_k$ that are defined from the scaled SEM to ensure well-scaled dissipative terms. We introduced three numerical non-dimensionalized numbers for each phase, $\Re_k$, $\Pe_k^\mu$ and $\Pe_k^\kappa$ and devised their scaling in two cases: the low-Mach asymptotic limit and for non-isentropic flows. In the later case, it was demonstrated that the incompressible system of equations is recovered when assuming that all of the non-dimensionalized numbers scale as one. The study of the former case showed that the scaling of the P\'eclet numbers remain the same whereas the scaling of the Reynolds number $\Re_k$ has to be modified and set to $M_k^2$ to ensure well-scaled dissipative terms in the phasic momentum equations. Because the numerical non-dimensionalized numbers are related to the scaling of the phasic viscosity coefficients, the above scaling should be used either to assess the accuracy of the viscosity coefficient definitions or derive definition for the viscosity coefficients. 

Deriving a definition for the phasic viscosity coefficients should rely on existing numerical methods for scalar and system of hyperbolic equations. For instance, it is known that artificial dissipative methods are used to solve for Euler equations: Lapidus \cite{Lapidus_paper, Lapidus_book}, pressure-based \cite{PBV_book} and entropy-based \cite{jlg1, valentin} numerical methods. Once a definition for the viscosity coefficients is derived and found consistent with the scaling of the numerical non-dimensionalized numbers, the numerical methods can be tested by solving two-phase shock tubes using various discretization methods. Note that the viscous regularization proposed in this paper is discretization agnostic. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{mybibfile}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Entropy equation for the multi-dimensional seven equation model without viscous regularization}\label{app:sev-equ-model-entropy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This appendix provides the steps that lead to the derivation of the phasic entropy equation of the Seven-Equation two-phase flow Model \cite{SEM}. For the purpose of this appendix, two phases are considered and denoted by the indexes $j$ and $k$. In the Seven-Equation two-phase flow Model, each phase obeys to the following set of equations $(\eqt{eq:sev_equ-app})$:
\begin{subequations}
\label{eq:sev_equ-app}
%\left\{
%\begin{array}{llllll}
\begin{align}
\partial_t \left( \alpha_k  A\right) + A \mbold u_{int} \cdot \grad \alpha_k = A \mu_P \left( P_k - P_j \right) 
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k A \right) + \div \left( \alpha_k \rho_k \mbold u_k A \right) = 0 
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k \mbold u_k A \right) + \div \left[ \alpha_k A \left( \rho_k \mbold u_k \otimes \mbold u_k + P_k \mathbb{I} \right) \right] &= \nonumber \\
\alpha_k P_k \grad A &+ P_{int} A \grad \alpha_k + A \lambda_u \left( \mbold u_j - \mbold u_k \right) 
\end{align}
\begin{align}
\partial_t \left( \alpha_k \rho_k E_k A \right) + \div \left[ \alpha_k A \mbold u_k \left( \rho_k E_k + P_k \right) \right] &= \nonumber \\
P_{int} A \mbold u_{int} \cdot \grad \alpha_k &- \mu_P \bar{P}_{int} \left( P_k-P_j \right) + \bar{\mbold u}_{int} A \lambda_u \left( \mbold u_j - \mbold u_k \right)
\end{align}
%    \end{array}
%    \right.
\end{subequations}
where $\rho_k$, $\mbold u_k$, $E_k$ and $P_k$ are the density, the velocity, the specific total energy and the pressure of  phase $k$, respectively. The pressure and velocity relaxation parameters are denoted by $\mu_P$ and $\lambda_u$, respectively. The variables with subscript $_{int}$ correspond to the interfacial variables and a definition is given in \eqt{eq:sev_equ2-app}. The cross section $A$ is only function of space: $\partial_t A = 0$. 
\begin{equation}
\label{eq:sev_equ2-app}
\left\{
\begin{array}{lll}
P_{int} = \bar{P}_{int} - \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{Z_k Z_j}{Z_k + Z_j} \left( \mbold u_k-\mbold u_j \right) \\
\bar{P}_{int} = \frac{Z_k P_j + Z_j P_k}{Z_k + Z_j} \\
\mbold u_{int} = \bar{\mbold u}_{int} - \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{P_k - P_j}{Z_k + Z_j} \\
\bar{\mbold u}_{int} = \frac{Z_k \mbold u _k + Z_j \mbold u_j}{Z_k + Z_j}
\end{array}
\right.
\end{equation}
where $Z_k = \rho_k c_k$ and $Z_j = \rho_j c_j$ are the impedance of phases $k$ and $j$, respectively. The speed of sound is denoted by the symbol $c$. The function $sgn(x)$ returns the sign of the variable $x$.\\
The first step consists of rearranging the equations given in \eqt{eq:sev_equ2-app} using the primitive variables $(\alpha_k, \rho_k, \mbold u_k, e_k)$, where $e_k$ is the specific internal energy of $k^{th}$ phase. We introduce the material derivative $\frac{D (\cdot)}{Dt} = \partial_t (\cdot) + \mbold u_k \cdot \grad (\cdot)$ for simplicity. \\
The continuity equation is modified as follows:
\begin{equation}
\label{eq:cont1-app}
\alpha_k A \frac{D \rho_k}{Dt} + \rho_k A \mu_P \left( P_k-P_j \right) + \rho_k A \left( \mbold u_k-\mbold u_{int} \right) \cdot \grad \alpha_k + \rho_k \alpha_k \div \left( A \mbold u_k \right) = 0
\end{equation}
The momentum and continuity equations are combined to yield the velocity equation:
\begin{equation}
\label{eq:vel1-app}
\alpha_k \rho_k A \frac{D\mbold u_k}{Dt} + \grad \left( \alpha_k A P_k \right) = \alpha_k P_k \grad A + P_{int} A \grad \alpha_k + A \lambda_u \left( \mbold u_j-\mbold u_k \right)
\end{equation}
The internal energy is obtained by subtracting the total energy from the kinetic equation defined as $\mbold u_k \cdot $\eqt{eq:vel1-app}:
\begin{align}\label{eq:internal1}
\alpha_k \rho_k A \frac{D e_k}{Dt} + \div\left( \alpha_k \mbold u_k A P_k \right) - \mbold u_k \cdot \grad \left( \alpha_k A P_k \right) &= P_{int} A \left(\mbold u_{int}-\mbold u_k \right) \cdot \grad \alpha_k \nonumber \\
- \alpha_k P_k \mbold u_k \cdot \grad A 
 - \bar{P}_{int} A \mu_P \left(P_k-P_j \right) &+ A \lambda_u \left(\mbold u_j-\mbold u_k  \right) \cdot \left(\bar{\mbold u}_{int}-\mbold u_k \right)
\end{align}
In the next step, we assume the existence of a phase wise entropy $s_k$ function of density $\rho_k$ and internal energy $e_k$. Using the chain rule,
\begin{equation}
\frac{Ds_k}{Dt} = (s_\rho)_k \frac{D \rho_k}{Dt} + (s_e)_k \frac{De_k}{Dt},
\end{equation}
along with the internal energy (\eqt{eq:internal1}) and the continuity equations (\eqt{eq:cont1-app}), the following entropy equation is obtained:
\begin{eqnarray}
\label{eq:ent1}
\alpha_k \rho_k A \frac{Ds_k}{Dt} + \underbrace{A \left( P_k (s_e)_k + \rho_k^2 (s_\rho)_k \right)\mbold u_k \cdot \grad \alpha_k + \alpha_k \left( P_k (s_e)_k + \rho_k^2 (s_\rho)_k \right) \mbold u_k \cdot \grad A}_\textrm{(a)} &= \nonumber\\
(s_e)_k P_{int}A \left[ (\mbold u_{int}-\mbold u_k)\cdot \grad \alpha_k - \bar{P}_{int} A \mu_P (P_k-P_j) + A \lambda_u (\bar{\mbold u}_{int}-\mbold u_k) \cdot (\mbold u_j-\mbold u_k)\right] &- \nonumber\\
\rho^2 (s_\rho)_k \left[ \mu_P A (P_k-P_j) + A(\mbold u_k-\mbold u_{int}) \cdot \grad \alpha_k\right] & 
\end{eqnarray}
where $(s_e)_k$ and $(s_\rho)_k$ denote the partial derivatives of the entropy $s_k$ with respect to the internal energy $e_k$ and the density $\rho_k$, respectively.
The second term, (a), in the left hand side of \eqt{eq:ent1} can be set to zero by assuming the following relation between the partial derivatives of the entropy $s_k$:
\begin{equation}
\label{eq:ent2}
 P_k (s_e)_k + \rho_k^2 (s_\rho)_k = 0 .
\end{equation} 
The above equation is equivalent to the application of the second thermodynamic law when assuming reversibility:
\begin{equation}
T_k ds_k = de_k - \frac{P_k}{\rho_k^2} d \rho_k \text{ with } (s_e)_k = \frac{1}{T_k} \text{ and } (s_\rho)_k = - \frac{P_k}{\rho_k^2} (s_e)_k
\end{equation}
Thus, equation \eqt{eq:ent1} can be rearranged using the relation $(s_\rho)_k = - \frac{P_k}{\rho_k^2} (s_e)_k$:
\begin{eqnarray}
\label{eq:ent3}
((s_e)_k)^{-1} \alpha_k \rho_k \frac{Ds}{Dt} = \underbrace{\left[ P_{int} (\mbold u_{int}-\mbold u_k) + P_k (\mbold u_k-\mbold u_{int}) \right] \cdot \grad \alpha_k}_\textrm{(b)} + \nonumber\\ 
\underbrace{\mu_P (P_k-P_j)(P_k-\bar{P}_{int})}_\textrm{(c)} + \underbrace{\lambda_u(\mbold u_j-\mbold u_k)\cdot(\bar{\mbold u}_{int}-\mbold u_k)}_\textrm{(d)}
\end{eqnarray}
The right hand side of equation \eqt{eq:ent3} is split into three terms (b), (c) and (d) that will be dealt with separately. The terms (c) and (d) can be easily recast by using the definitions of $\bar{\mbold u}_{int}$ and $\bar{P}_{int}$ given in equation \eqt{eq:sev_equ2-app}:
\begin{eqnarray}
\label{eq:ent4}
\mu_P (P_k-P_j)(P_k-\bar{P}_{int}) = \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2\nonumber\\
\lambda_u(\mbold u_j-\mbold u_k)\cdot(\bar{\mbold u}_{int}-\mbold u_k) = \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j - \mbold u_k)^2 
\end{eqnarray}
By definition, $\mu_P$, $\lambda_u$ and $Z_k$ are all positive. Thus, the above terms (c) and (d) are unconditionally positive. \\
It remains to look at the last term (b). Once again, by using the definition of $P_{int}$ and $\mbold u_{int}$, and the following relations:
\begin{eqnarray}
\label{eq:ent4bis}
\mbold u_{int}-\mbold u_k &=& \frac{Z_j}{Z_k+Z_j}(\mbold u_j-\mbold u_k) -  \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{Pk-P_j}{Z_k+Z_j} \nonumber\\
P_{int}-P_k &=& \frac{Z_k}{Z_k+Z_j} (P_j-P_k) - \frac{\grad \alpha_k}{|| \grad \alpha_k ||} \frac{Z_k Z_j}{Z_k+Z_j} (\mbold u_k-\mbold u_j), \nonumber 
\end{eqnarray}
term (b) becomes:
\begin{eqnarray}
\label{eq:ent5}
\left[ P_{int} (\mbold u_{int}-\mbold u_k) + P_k (\mbold u_k-\mbold u_{int}) \right] \cdot \grad \alpha_k = (P_{int}-P_k)(\mbold u_{int}-\mbold u_k)\cdot \grad \alpha_k=  \nonumber\\ \frac{Z_k}{\left( Z_k+Z_j \right)^2} \grad \alpha_k \cdot \left[ Z_j (\mbold u_j-\mbold u_k)(P_j-P_k)+\frac{\grad \alpha_k}{|| \grad \alpha_k ||} Z_j^2 (\mbold u_j-\mbold u_k)^2 \right. + \nonumber \\ \left. \frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)^2 +  \frac{\grad \alpha_k \cdot \grad \alpha_k}{|| \grad \alpha_k ||^2}(P_k-P_j)Z_j (\mbold u_k-\mbold u_j) \right] 
\end{eqnarray}
The above equation is factorized by $|| \grad \alpha_k ||$ and then recast under a quadratic form using $\frac{\grad \alpha_k \cdot \grad \alpha_k}{|| \grad \alpha_k ||^2} = 1$. This yields:
\begin{align}
\label{eq:ent6}
\left[ (\mbold u_{int}-\mbold u_k)P_{int} + (\mbold u_k-\mbold u_{int})P_k \right] \grad \alpha_k &=  \nonumber \\
|| \grad \alpha_k || \frac{Z_k }{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)\right.&+\left.\frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)\right]^2
\end{align}
Thus, using \eqt{eq:ent3}, \eqt{eq:ent4}, \eqt{eq:ent5} and \eqt{eq:ent6}, the entropy equation obtained in \cite{SEM} holds and is recalled here for convenience:
\begin{align}
(s_{e})_k^{-1} \alpha_k \rho_k A \frac{Ds_k}{Dt} &= \mu_P \frac{Z_k}{Z_k+Z_j} (P_j - P_k)^2 + \lambda_u \frac{Z_j}{Z_k+Z_j} (\mbold u_j -\mbold  u_k)^2 \nonumber
\\
& \frac{Z_k}{\left( Z_k+Z_j \right)^2} \left[ Z_j (\mbold u_j-\mbold u_k)+\frac{\grad \alpha_k}{|| \grad \alpha_k ||}(P_k-P_j)\right]^2. \nonumber
\end{align}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Compatibility of the viscous regularization for the seven-equation two-phase model with the generalized Harten entropies}\label{app:harden}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We investigate in this appendix whether the viscous regularization of the seven-equation two-phase model derived in \sct{sec:visc-regu} is compatible with some or all generalized entropy identified in Harten et al. \cite{Harten}. Considering the single-phase Euler equations, Harten et al. \cite{Harten} demonstrated that a function $\rho \mathscr{H}(s)$ is called a generalized entropy and strictly concave if $\mathscr{H}$ is twice differential and
%
\begin{equation}\label{eq:generalized_ent}
\mathscr{H}' (s)  \geq 0, \ \ \ \ \mathscr{H}'(s)c_p^{-1} - \mathscr{H}'' \geq 0, \ \forall \left( \rho, e \right) \in \mathbb{R}_+^2 \ ,
\end{equation}
%
where $c_p \left( \rho, e \right) = T \partial_T s \left( \rho, e \right)$ is the specific heat at constant pressure ($T$ is a function of $e$ and $\rho$ through the equation of state). Because the seven-equation two-phase model was initially derived by assuming that each phase obeys the single-phase Euler equation, we want to investigate whether the above property still holds when considering the Seven-Equation two-phase flow Model with viscous regularization. To do so, we consider a phasic generalized entropy, $\mathscr{H}_k(s_k)$ and a phasic specific heat at constant pressure, $c_{p,k} \left( \rho_k, e_k \right) = T_k \partial_{T_k} s_k \left( \rho_k, T_k \right)$ characterized by \eqt{eq:generalized_ent}. The objective is to find an entropy inequality verified by $\rho_k \mathscr{H}_k(s_k)$.

We start from the entropy inequality verified by $s_k$,
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms-app}
&\alpha_k \rho_k A \frac{Ds_k}{Dt} =  \mbold f_k \cdot \grad s_k + \div \left( \alpha_k A \rho_k \kappa_k  \grad s_k \right)  \nonumber\\
&- \alpha_k \rho_k A \kappa_k \mathbf{Q}_k + (s_e)_k \alpha_k A \rho_k \mu_k \grad^s \mbold u_k : \grad \mbold u_k.
\end{align}
%
%Recalling the definition of $f_k = \alpha_k A \kappa_k \grad \rho_k + A \rho_k \beta_k \grad \alpha_k $, 
\eqt{eq:ent-res-7-eqn-diss-terms-app} is multiplied by $\mathscr{H}_k'(s_k)$ to yield:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms-app2}
\alpha_k \rho_k A \frac{D\mathscr{H}_k(s_k)}{Dt} &= \div \left( \alpha_k A \rho_k \kappa_k \grad \mathscr{H}_k (s_k) \right) - \mathscr{H}_k''(s_k) \alpha_k A \kappa_k \rho_k || \grad s_k ||^2 + \nonumber\\
&\mathscr{H}_k'(s_k) \mbold f_k \cdot \grad s_k - \mathscr{H}_k'(s_k)\alpha_k \rho_k A \kappa_k \mathbf{Q}_k + \nonumber \\
& \mathscr{H}_k'(s_k)(s_e)_k \alpha_k A \rho_k \mu_k \grad^s \mbold u_k : \grad \mbold u_k.
\end{align}
%
Let us now multiply the continuity equation of phase $k$ by $\mathscr{H}_k (s_k)$ and add the result to the above equation to obtain:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms-app3}
\partial_t \left( \alpha_k \rho_k A \mathscr{H}_k(s_k)\right) + \div \left( \alpha_k \rho_k \mbold u_k A \mathscr{H}_k(s_k) \right)  &- \nonumber\\
\div \left[ \alpha_k A \rho_k \kappa_k \grad \mathscr{H}_k (s_k) + \alpha_k A \kappa_k \mathscr{H}_k (s_k) \grad \rho_k  \right. & \left. + A \kappa_k \rho_k \mathscr{H}_k (s_k) \grad \alpha_k\right] = \nonumber \\
 \underbrace{-\mathscr{H}_k''(s_k) \alpha_k A \kappa_k \rho_k || \grad s_k ||^2  - \mathscr{H}_k'(s_k) \alpha_k A \kappa_k \rho_k  \mathbf{Q}_k}_{\mathbb{T}_0} &+\nonumber \\
\underbrace{ \mathscr{H}_k'(s_k)(s_e)_k  \alpha_k A \rho_k \mu_k \grad^s \mbold u_k : \grad \mbold u_k}_{\mathbb{T}_1} & .
\end{align}
%
As in \sct{sec:visc-regu}, the left-hand side of \eqt{eq:ent-res-7-eqn-diss-terms-app3} is split into two residuals denoted by $\mathbb{T}_0$ and $\mathbb{T}_1$ in order to study the sign of each of them. We start by studying the sign of $\mathbb{T}_1$ that is positive since it is assumed that $ \mathscr{H}_k'(s_k) \geq 0$. We now investigate the sign of $\mathbb{T}_0$. Using \eqt{eq:generalized_ent}, it is obtained:
%
\begin{equation}\label{eq:new_quad_form}
- \mathbb{T}_0 \leq \mathscr{H}_k'(s_k) \alpha_k A \kappa_k \rho_k \left( c_{p,k}^{-1} ||\grad s_k||^2 +  \mathbf{Q}_k\right) \ .
\end{equation}
%
The right-hand side of \eqt{eq:new_quad_form} is a quadratic form that was already defined in Appendix 5 of \cite{jlg} and recast under the matricial form $X^t_k \mathbb{S} X_k$ where $\mathbb{S}$ is a $2 \times 2$ matrix and the vector $X_k$ is defined in \sct{sec:visc-regu}. In \cite{jlg}, the matrix $\mathbb{S}$ is proved to be negative semi-definite which allows us to conclude that $-\mathbb{T}_0$ is of the same sign using \eqt{eq:new_quad_form}. Then, knowing the sign of the two residuals $\mathbb{T}_0$ and $\mathbb{T}_1$, we conclude that:
%
\begin{align}\label{eq:ent-res-7-eqn-diss-terms-app4}
\partial_t \left( \alpha_k \rho_k A \mathscr{H}_k(s_k)\right) + \div \left( \alpha_k \rho_k \mbold u_k A \mathscr{H}_k(s_k) \right)  &- \nonumber\\
\div \left[ \alpha_k A \rho_k \kappa_k \grad \mathscr{H}_k (s_k) + \alpha_k A \kappa_k \mathscr{H}_k (s_k) \grad \rho_k  \right. & \left. + A \kappa_k \rho_k \mathscr{H}_k (s_k) \grad \alpha_k\right] \geq 0 \ ,\nonumber 
\end{align}
%
which allows us to conclude that an entropy inequality is satisfied for all generalized entropies $\rho_k \mathscr{H}_k (s_k)$ when using the viscous regularization derived in \sct{sec:visc-regu} for the seven-equation two-phase model. Note that the above inequality holds for the total entropy of the system when summing over the phases.
\end{appendices}
\end{document}